<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://ruihan.org/leetcode/array/notes/ rel=canonical><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.5"><title>Array - RUIHAN.ORG</title><link rel=stylesheet href=../../../assets/stylesheets/main.15aa0b43.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.75751829.min.css><meta name=theme-color content=#000000><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=black> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#array class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://ruihan.org title=RUIHAN.ORG class="md-header-nav__button md-logo" aria-label=RUIHAN.ORG> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> RUIHAN.ORG </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Array </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../books/ class=md-tabs__link> Books </a> </li> <li class=md-tabs__item> <a href=../../../courses/ class=md-tabs__link> Courses </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Leetcode </a> </li> <li class=md-tabs__item> <a href=../../../research/ class=md-tabs__link> Research </a> </li> <li class=md-tabs__item> <a href=../../../seedlabs/ class=md-tabs__link> SEED Labs </a> </li> <li class=md-tabs__item> <a href=../../../system-design/ class=md-tabs__link> System Design </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://ruihan.org title=RUIHAN.ORG class="md-nav__button md-logo" aria-label=RUIHAN.ORG> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> RUIHAN.ORG </label> <div class=md-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Books <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Books data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"></span> Books </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../books/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../books/accelerated-cpp/notes/ class=md-nav__link> Accelerated C++ </a> </li> <li class=md-nav__item> <a href=../../../books/mining-massive-datasets/notes/ class=md-nav__link> Mining Massive Datasets </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Courses <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Courses data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"></span> Courses </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../courses/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../courses/machine-learning-coursera/notes/ class=md-nav__link> Machine Learning (Coursera) </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/lec-notes/ class=md-nav__link> CS224N Lecture Notes </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/write-up/ class=md-nav__link> CS224N Write-up </a> </li> <li class=md-nav__item> <a href=../../../courses/coursera-dl4-cnn/notes/ class=md-nav__link> Convolutional Neural Networks </a> </li> <li class=md-nav__item> <a href=../../../courses/mining-massive-datasets/notes/ class=md-nav__link> Mining Massive Data Sets </a> </li> <li class=md-nav__item> <a href=../../../courses/6.431-probability/notes/ class=md-nav__link> 6.431 Probability </a> </li> <li class=md-nav__item> <a href=../../../courses/learning-from-data/notes.md class=md-nav__link> Learning From Data </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-system-design/notes/ class=md-nav__link> Nine Chapter System Design </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-dynamic-prog/notes/ class=md-nav__link> Nine Chapter Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../../courses/func-prog-in-scala/notes/ class=md-nav__link> Functional Programming Principles in Scala </a> </li> <li class=md-nav__item> <a href=../../../courses/applied-scrum-for-agile/notes/ class=md-nav__link> Applied Scrum for Agile Project Management </a> </li> <li class=md-nav__item> <a href=../../../courses/concurrent-prog-java/notes/ class=md-nav__link> Concurrent Programming in Java </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Leetcode <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Leetcode data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"></span> Leetcode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Array <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Array </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#category-1-removecontains-duplidate class=md-nav__link> Category 1 Remove/Contains Duplidate </a> <nav class=md-nav aria-label="Category 1 Remove/Contains Duplidate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#contains-duplicate class=md-nav__link> Contains Duplicate </a> </li> <li class=md-nav__item> <a href=#contains-duplicate-ii class=md-nav__link> Contains Duplicate II </a> </li> <li class=md-nav__item> <a href=#contains-duplicate-iii class=md-nav__link> Contains Duplicate III </a> </li> <li class=md-nav__item> <a href=#find-the-duplicate-number class=md-nav__link> Find the Duplicate Number </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-array class=md-nav__link> Remove Duplicates from Sorted Array </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-array-ii class=md-nav__link> Remove Duplicates from Sorted Array II </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-list-ii class=md-nav__link> Remove Duplicates from Sorted List II </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-list class=md-nav__link> Remove Duplicates from Sorted List </a> </li> <li class=md-nav__item> <a href=#move-zeroes class=md-nav__link> Move Zeroes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-2-matrix-problems class=md-nav__link> Category 2 Matrix problems </a> <nav class=md-nav aria-label="Category 2 Matrix problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spiral-matrix class=md-nav__link> Spiral Matrix </a> </li> <li class=md-nav__item> <a href=#spiral-matrix-ii class=md-nav__link> Spiral Matrix II </a> </li> <li class=md-nav__item> <a href=#search-a-2d-matrix class=md-nav__link> Search a 2D Matrix </a> </li> <li class=md-nav__item> <a href=#search-a-2d-matrix-ii class=md-nav__link> Search a 2D Matrix II </a> </li> <li class=md-nav__item> <a href=#rotate-image class=md-nav__link> Rotate Image </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-mutable class=md-nav__link> Range Sum Query 2D - Mutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-immutable class=md-nav__link> Range Sum Query 2D - Immutable </a> </li> <li class=md-nav__item> <a href=#maximal-square class=md-nav__link> Maximal Square </a> </li> <li class=md-nav__item> <a href=#maximal-rectangle class=md-nav__link> Maximal Rectangle </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-3-subarray-problems class=md-nav__link> Category 3 Subarray problems </a> <nav class=md-nav aria-label="Category 3 Subarray problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#type-of-subarray-problem class=md-nav__link> Type of subarray problem </a> </li> <li class=md-nav__item> <a href=#two-types-of-prefix-sum class=md-nav__link> Two types of prefix sum </a> </li> <li class=md-nav__item> <a href=#using-prefix-sum-with-map class=md-nav__link> Using prefix sum with map </a> </li> <li class=md-nav__item> <a href=#maximum-subarray class=md-nav__link> Maximum Subarray </a> </li> <li class=md-nav__item> <a href=#maximum-subarray-ii class=md-nav__link> Maximum Subarray II* </a> </li> <li class=md-nav__item> <a href=#maximum-subarray-iii class=md-nav__link> Maximum Subarray III* </a> </li> <li class=md-nav__item> <a href=#maximum-subarray-difference class=md-nav__link> Maximum Subarray Difference* </a> </li> <li class=md-nav__item> <a href=#maximum-product-subarray class=md-nav__link> Maximum Product Subarray </a> </li> <li class=md-nav__item> <a href=#subarray-product-less-than-k class=md-nav__link> Subarray Product Less Than K </a> </li> <li class=md-nav__item> <a href=#subarray-sum class=md-nav__link> Subarray Sum* </a> </li> <li class=md-nav__item> <a href=#minimum-size-subarray-sum class=md-nav__link> Minimum Size Subarray Sum </a> </li> <li class=md-nav__item> <a href=#maximum-size-subarray-sum-equals-k class=md-nav__link> Maximum Size Subarray Sum Equals k </a> </li> <li class=md-nav__item> <a href=#subarray-sum-equals-k class=md-nav__link> Subarray Sum Equals K </a> </li> <li class=md-nav__item> <a href=#subarray-sums-divisible-by-k class=md-nav__link> Subarray Sums Divisible by K </a> </li> <li class=md-nav__item> <a href=#max-sum-of-subarry-no-larger-than-k class=md-nav__link> Max Sum of Subarry No Larger Than K* </a> </li> <li class=md-nav__item> <a href=#max-sum-of-rectangle-no-larger-than-k class=md-nav__link> Max Sum of Rectangle No Larger Than K </a> </li> <li class=md-nav__item> <a href=#maximum-sum-rectangular-submatrix-in-matrix class=md-nav__link> Maximum Sum Rectangular Submatrix in Matrix* </a> </li> <li class=md-nav__item> <a href=#subarray-sum-closest class=md-nav__link> Subarray Sum Closest* </a> </li> <li class=md-nav__item> <a href=#shortest-unsorted-continuous-subarray-count-inversions class=md-nav__link> Shortest Unsorted Continuous Subarray (Count inversions) </a> </li> <li class=md-nav__item> <a href=#count-inversion-course-assignment class=md-nav__link> Count Inversion (course assignment) </a> </li> <li class=md-nav__item> <a href=#count-of-smaller-numbers-after-self class=md-nav__link> Count of Smaller Numbers After Self </a> </li> <li class=md-nav__item> <a href=#continuous-subarray-sum class=md-nav__link> Continuous Subarray Sum </a> </li> <li class=md-nav__item> <a href=#contiguous-array class=md-nav__link> Contiguous Array </a> </li> <li class=md-nav__item> <a href=#split-array-with-equal-sum class=md-nav__link> Split Array with Equal Sum </a> </li> <li class=md-nav__item> <a href=#410-split-array-largest-sum class=md-nav__link> 410. Split Array Largest Sum </a> </li> <li class=md-nav__item> <a href=#copy-books-lintcode class=md-nav__link> Copy books (lintcode) </a> </li> <li class=md-nav__item> <a href=#maximum-average-subarray-i class=md-nav__link> Maximum Average Subarray I </a> </li> <li class=md-nav__item> <a href=#maximum-average-subarray-ii class=md-nav__link> Maximum Average Subarray II </a> </li> <li class=md-nav__item> <a href=#range-sum-query-immutable class=md-nav__link> Range Sum Query - Immutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-mutable class=md-nav__link> Range Sum Query - Mutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-immutable_1 class=md-nav__link> Range Sum Query 2D - Immutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-mutable_1 class=md-nav__link> Range Sum Query 2D - Mutable </a> </li> <li class=md-nav__item> <a href=#count-of-range-sum class=md-nav__link> Count of Range Sum </a> </li> <li class=md-nav__item> <a href=#maximum-sum-of-two-non-overlapping-subarrays class=md-nav__link> Maximum Sum of Two Non-Overlapping Subarrays </a> </li> <li class=md-nav__item> <a href=#maximum-sum-of-3-non-overlapping-subarrays class=md-nav__link> Maximum Sum of 3 Non-Overlapping Subarrays </a> </li> <li class=md-nav__item> <a href=#longest-substring-without-repeating-characters class=md-nav__link> Longest Substring Without Repeating Characters </a> </li> <li class=md-nav__item> <a href=#longest-substring-with-at-most-two-distinct-characters class=md-nav__link> Longest Substring with At Most Two Distinct Characters </a> </li> <li class=md-nav__item> <a href=#longest-substring-with-at-most-k-distinct-characters class=md-nav__link> Longest Substring with At Most K Distinct Characters </a> </li> <li class=md-nav__item> <a href=#subarrays-with-k-different-integers class=md-nav__link> Subarrays with K Different Integers </a> </li> <li class=md-nav__item> <a href=#number-of-substrings-containing-all-three-characters class=md-nav__link> Number of Substrings Containing All Three Characters </a> </li> <li class=md-nav__item> <a href=#count-number-of-nice-subarrays class=md-nav__link> Count Number of Nice Subarrays </a> </li> <li class=md-nav__item> <a href=#replace-the-substring-for-balanced-string class=md-nav__link> Replace the Substring for Balanced String </a> </li> <li class=md-nav__item> <a href=#binary-subarrays-with-sum class=md-nav__link> Binary Subarrays With Sum </a> </li> <li class=md-nav__item> <a href=#fruit-into-baskets class=md-nav__link> Fruit Into Baskets </a> </li> <li class=md-nav__item> <a href=#shortest-subarray-with-sum-at-least-k class=md-nav__link> Shortest Subarray with Sum at Least K </a> </li> <li class=md-nav__item> <a href=#minimum-size-subarray-sum_1 class=md-nav__link> Minimum Size Subarray Sum </a> </li> <li class=md-nav__item> <a href=#substring-with-concatenation-of-all-words class=md-nav__link> Substring with Concatenation of All Words </a> </li> <li class=md-nav__item> <a href=#max-consecutive-ones-ii class=md-nav__link> Max Consecutive Ones II </a> </li> <li class=md-nav__item> <a href=#max-consecutive-ones-iii class=md-nav__link> Max Consecutive Ones III </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-4-k-sum-problems class=md-nav__link> Category 4 K Sum problems </a> <nav class=md-nav aria-label="Category 4 K Sum problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#two-sum class=md-nav__link> Two Sum </a> </li> <li class=md-nav__item> <a href=#two-sum-ii-input-array-is-sorted class=md-nav__link> Two Sum II - Input array is sorted </a> </li> <li class=md-nav__item> <a href=#two-sum-iii-data-structure-design class=md-nav__link> Two Sum III - Data structure design </a> </li> <li class=md-nav__item> <a href=#two-sum-iv-input-is-a-bst class=md-nav__link> Two Sum IV - Input is a BST </a> </li> <li class=md-nav__item> <a href=#3sum class=md-nav__link> 3Sum </a> </li> <li class=md-nav__item> <a href=#3sum-closest class=md-nav__link> 3Sum Closest </a> </li> <li class=md-nav__item> <a href=#3sum-smaller class=md-nav__link> 3Sum Smaller </a> </li> <li class=md-nav__item> <a href=#4sum class=md-nav__link> 4Sum </a> </li> <li class=md-nav__item> <a href=#4sum-ii class=md-nav__link> 4Sum II </a> </li> <li class=md-nav__item> <a href=#k-sum class=md-nav__link> K Sum </a> </li> <li class=md-nav__item> <a href=#target-sum class=md-nav__link> Target Sum </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cagegory-5-2d-arry-matrix-grid-problems class=md-nav__link> Cagegory 5 2D arry (matrix, grid) problems </a> <nav class=md-nav aria-label="Cagegory 5 2D arry (matrix, grid) problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#perfect-rectangle class=md-nav__link> Perfect Rectangle </a> </li> <li class=md-nav__item> <a href=#trapping-rain-water class=md-nav__link> Trapping Rain Water </a> </li> <li class=md-nav__item> <a href=#trapping-rain-water-ii class=md-nav__link> Trapping Rain Water II </a> </li> <li class=md-nav__item> <a href=#container-with-most-water class=md-nav__link> Container With Most Water </a> </li> <li class=md-nav__item> <a href=#largest-rectangle-in-histogram class=md-nav__link> Largest Rectangle in Histogram </a> </li> <li class=md-nav__item> <a href=#maximal-rectangle_1 class=md-nav__link> Maximal Rectangle </a> </li> <li class=md-nav__item> <a href=#maximal-square_1 class=md-nav__link> Maximal Square </a> </li> <li class=md-nav__item> <a href=#the-skyline-problem class=md-nav__link> The Skyline Problem </a> </li> <li class=md-nav__item> <a href=#smallest-rectangle-enclosing-black-pixels class=md-nav__link> Smallest Rectangle Enclosing Black Pixels </a> </li> <li class=md-nav__item> <a href=#rectangle-area class=md-nav__link> Rectangle Area </a> </li> <li class=md-nav__item> <a href=#max-sum-of-rectangle-no-larger-than-k_1 class=md-nav__link> Max Sum of Rectangle No Larger Than K </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-6-stock-buying-problems class=md-nav__link> Category 6 stock buying problems </a> <nav class=md-nav aria-label="Category 6 stock buying problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#121-best-time-to-buy-and-sell-stock class=md-nav__link> 121. Best Time to Buy and Sell Stock </a> </li> <li class=md-nav__item> <a href=#122-best-time-to-buy-and-sell-stock-ii class=md-nav__link> 122. Best Time to Buy and Sell Stock II </a> </li> <li class=md-nav__item> <a href=#123-best-time-to-buy-and-sell-stock-iii class=md-nav__link> 123. Best Time to Buy and Sell Stock III </a> </li> <li class=md-nav__item> <a href=#188-best-time-to-buy-and-sell-stock-iv class=md-nav__link> 188. Best Time to Buy and Sell Stock IV </a> </li> <li class=md-nav__item> <a href=#309-best-time-to-buy-and-sell-stock-with-cooldown class=md-nav__link> 309. Best Time to Buy and Sell Stock with Cooldown </a> </li> <li class=md-nav__item> <a href=#714-best-time-to-buy-and-sell-stock-with-transaction-fee class=md-nav__link> 714. Best Time to Buy and Sell Stock with Transaction Fee </a> </li> <li class=md-nav__item> <a href=#determine-the-buy-data-and-sell-data-of-maximum-profit-dd-139 class=md-nav__link> Determine the buy data and sell data of maximum profit (DD 139) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../backtracking/notes/ class=md-nav__link> Backtracking </a> </li> <li class=md-nav__item> <a href=../../binary-search/notes/ class=md-nav__link> Binary Search </a> </li> <li class=md-nav__item> <a href=../../breadth-first-search/notes/ class=md-nav__link> Breadth-First Search (BFS) </a> </li> <li class=md-nav__item> <a href=../../depth-first-search/notes/ class=md-nav__link> Depth-First Search (DFS) </a> </li> <li class=md-nav__item> <a href=../../dynamic-programming/notes/ class=md-nav__link> Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../graph/notes/ class=md-nav__link> Graph </a> </li> <li class=md-nav__item> <a href=../../heap/notes/ class=md-nav__link> Heap </a> </li> <li class=md-nav__item> <a href=../../interval/notes/ class=md-nav__link> Interval </a> </li> <li class=md-nav__item> <a href=../../linked-list/notes/ class=md-nav__link> Linked List </a> </li> <li class=md-nav__item> <a href=../../math/notes/ class=md-nav__link> Math </a> </li> <li class=md-nav__item> <a href=../../stack/notes/ class=md-nav__link> Stack </a> </li> <li class=md-nav__item> <a href=../../string/notes/ class=md-nav__link> String </a> </li> <li class=md-nav__item> <a href=../../tree/notes/ class=md-nav__link> Tree </a> </li> <li class=md-nav__item> <a href=../../trie/notes/ class=md-nav__link> Trie </a> </li> <li class=md-nav__item> <a href=../../union-find/notes/ class=md-nav__link> Union Find </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Research <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Research data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"></span> Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../research/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../research/paper-reading/notes/ class=md-nav__link> Paper Reading </a> </li> <li class=md-nav__item> <a href=../../../research/coalition-game/notes/ class=md-nav__link> Coalition Game </a> </li> <li class=md-nav__item> <a href=../../../research/contextual-bandit/notes/ class=md-nav__link> Contextual Multi-Armed Bandit </a> </li> <li class=md-nav__item> <a href=../../../research/tfidf-score/notes/ class=md-nav__link> TF-IDF for Information Retrieval </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> SEED Labs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SEED Labs" data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"></span> SEED Labs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../seedlabs/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/applied-crypto/notes/ class=md-nav__link> Applied Cryptograph Notes </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/public-key-cryptography-and-pki/notes/ class=md-nav__link> Public Key Cryptography and PKI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> System Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="System Design" data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"></span> System Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../system-design/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../system-design/browser/notes.md class=md-nav__link> How Browser Works </a> </li> <li class=md-nav__item> <a href=../../../system-design/concurrency/notes/ class=md-nav__link> Concurrency and Synchronization </a> </li> <li class=md-nav__item> <a href=../../../system-design/concepts/notes/ class=md-nav__link> Distributed System Concepts </a> </li> <li class=md-nav__item> <a href=../../../system-design/patterns/notes/ class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/tinyurl/notes/ class=md-nav__link> How to Design TinyUrl </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/twitter/notes/ class=md-nav__link> How to Design Twitter </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/ticketmaster/notes/ class=md-nav__link> How to Design Ticketmaster </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#category-1-removecontains-duplidate class=md-nav__link> Category 1 Remove/Contains Duplidate </a> <nav class=md-nav aria-label="Category 1 Remove/Contains Duplidate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#contains-duplicate class=md-nav__link> Contains Duplicate </a> </li> <li class=md-nav__item> <a href=#contains-duplicate-ii class=md-nav__link> Contains Duplicate II </a> </li> <li class=md-nav__item> <a href=#contains-duplicate-iii class=md-nav__link> Contains Duplicate III </a> </li> <li class=md-nav__item> <a href=#find-the-duplicate-number class=md-nav__link> Find the Duplicate Number </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-array class=md-nav__link> Remove Duplicates from Sorted Array </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-array-ii class=md-nav__link> Remove Duplicates from Sorted Array II </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-list-ii class=md-nav__link> Remove Duplicates from Sorted List II </a> </li> <li class=md-nav__item> <a href=#remove-duplicates-from-sorted-list class=md-nav__link> Remove Duplicates from Sorted List </a> </li> <li class=md-nav__item> <a href=#move-zeroes class=md-nav__link> Move Zeroes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-2-matrix-problems class=md-nav__link> Category 2 Matrix problems </a> <nav class=md-nav aria-label="Category 2 Matrix problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spiral-matrix class=md-nav__link> Spiral Matrix </a> </li> <li class=md-nav__item> <a href=#spiral-matrix-ii class=md-nav__link> Spiral Matrix II </a> </li> <li class=md-nav__item> <a href=#search-a-2d-matrix class=md-nav__link> Search a 2D Matrix </a> </li> <li class=md-nav__item> <a href=#search-a-2d-matrix-ii class=md-nav__link> Search a 2D Matrix II </a> </li> <li class=md-nav__item> <a href=#rotate-image class=md-nav__link> Rotate Image </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-mutable class=md-nav__link> Range Sum Query 2D - Mutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-immutable class=md-nav__link> Range Sum Query 2D - Immutable </a> </li> <li class=md-nav__item> <a href=#maximal-square class=md-nav__link> Maximal Square </a> </li> <li class=md-nav__item> <a href=#maximal-rectangle class=md-nav__link> Maximal Rectangle </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-3-subarray-problems class=md-nav__link> Category 3 Subarray problems </a> <nav class=md-nav aria-label="Category 3 Subarray problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#type-of-subarray-problem class=md-nav__link> Type of subarray problem </a> </li> <li class=md-nav__item> <a href=#two-types-of-prefix-sum class=md-nav__link> Two types of prefix sum </a> </li> <li class=md-nav__item> <a href=#using-prefix-sum-with-map class=md-nav__link> Using prefix sum with map </a> </li> <li class=md-nav__item> <a href=#maximum-subarray class=md-nav__link> Maximum Subarray </a> </li> <li class=md-nav__item> <a href=#maximum-subarray-ii class=md-nav__link> Maximum Subarray II* </a> </li> <li class=md-nav__item> <a href=#maximum-subarray-iii class=md-nav__link> Maximum Subarray III* </a> </li> <li class=md-nav__item> <a href=#maximum-subarray-difference class=md-nav__link> Maximum Subarray Difference* </a> </li> <li class=md-nav__item> <a href=#maximum-product-subarray class=md-nav__link> Maximum Product Subarray </a> </li> <li class=md-nav__item> <a href=#subarray-product-less-than-k class=md-nav__link> Subarray Product Less Than K </a> </li> <li class=md-nav__item> <a href=#subarray-sum class=md-nav__link> Subarray Sum* </a> </li> <li class=md-nav__item> <a href=#minimum-size-subarray-sum class=md-nav__link> Minimum Size Subarray Sum </a> </li> <li class=md-nav__item> <a href=#maximum-size-subarray-sum-equals-k class=md-nav__link> Maximum Size Subarray Sum Equals k </a> </li> <li class=md-nav__item> <a href=#subarray-sum-equals-k class=md-nav__link> Subarray Sum Equals K </a> </li> <li class=md-nav__item> <a href=#subarray-sums-divisible-by-k class=md-nav__link> Subarray Sums Divisible by K </a> </li> <li class=md-nav__item> <a href=#max-sum-of-subarry-no-larger-than-k class=md-nav__link> Max Sum of Subarry No Larger Than K* </a> </li> <li class=md-nav__item> <a href=#max-sum-of-rectangle-no-larger-than-k class=md-nav__link> Max Sum of Rectangle No Larger Than K </a> </li> <li class=md-nav__item> <a href=#maximum-sum-rectangular-submatrix-in-matrix class=md-nav__link> Maximum Sum Rectangular Submatrix in Matrix* </a> </li> <li class=md-nav__item> <a href=#subarray-sum-closest class=md-nav__link> Subarray Sum Closest* </a> </li> <li class=md-nav__item> <a href=#shortest-unsorted-continuous-subarray-count-inversions class=md-nav__link> Shortest Unsorted Continuous Subarray (Count inversions) </a> </li> <li class=md-nav__item> <a href=#count-inversion-course-assignment class=md-nav__link> Count Inversion (course assignment) </a> </li> <li class=md-nav__item> <a href=#count-of-smaller-numbers-after-self class=md-nav__link> Count of Smaller Numbers After Self </a> </li> <li class=md-nav__item> <a href=#continuous-subarray-sum class=md-nav__link> Continuous Subarray Sum </a> </li> <li class=md-nav__item> <a href=#contiguous-array class=md-nav__link> Contiguous Array </a> </li> <li class=md-nav__item> <a href=#split-array-with-equal-sum class=md-nav__link> Split Array with Equal Sum </a> </li> <li class=md-nav__item> <a href=#410-split-array-largest-sum class=md-nav__link> 410. Split Array Largest Sum </a> </li> <li class=md-nav__item> <a href=#copy-books-lintcode class=md-nav__link> Copy books (lintcode) </a> </li> <li class=md-nav__item> <a href=#maximum-average-subarray-i class=md-nav__link> Maximum Average Subarray I </a> </li> <li class=md-nav__item> <a href=#maximum-average-subarray-ii class=md-nav__link> Maximum Average Subarray II </a> </li> <li class=md-nav__item> <a href=#range-sum-query-immutable class=md-nav__link> Range Sum Query - Immutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-mutable class=md-nav__link> Range Sum Query - Mutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-immutable_1 class=md-nav__link> Range Sum Query 2D - Immutable </a> </li> <li class=md-nav__item> <a href=#range-sum-query-2d-mutable_1 class=md-nav__link> Range Sum Query 2D - Mutable </a> </li> <li class=md-nav__item> <a href=#count-of-range-sum class=md-nav__link> Count of Range Sum </a> </li> <li class=md-nav__item> <a href=#maximum-sum-of-two-non-overlapping-subarrays class=md-nav__link> Maximum Sum of Two Non-Overlapping Subarrays </a> </li> <li class=md-nav__item> <a href=#maximum-sum-of-3-non-overlapping-subarrays class=md-nav__link> Maximum Sum of 3 Non-Overlapping Subarrays </a> </li> <li class=md-nav__item> <a href=#longest-substring-without-repeating-characters class=md-nav__link> Longest Substring Without Repeating Characters </a> </li> <li class=md-nav__item> <a href=#longest-substring-with-at-most-two-distinct-characters class=md-nav__link> Longest Substring with At Most Two Distinct Characters </a> </li> <li class=md-nav__item> <a href=#longest-substring-with-at-most-k-distinct-characters class=md-nav__link> Longest Substring with At Most K Distinct Characters </a> </li> <li class=md-nav__item> <a href=#subarrays-with-k-different-integers class=md-nav__link> Subarrays with K Different Integers </a> </li> <li class=md-nav__item> <a href=#number-of-substrings-containing-all-three-characters class=md-nav__link> Number of Substrings Containing All Three Characters </a> </li> <li class=md-nav__item> <a href=#count-number-of-nice-subarrays class=md-nav__link> Count Number of Nice Subarrays </a> </li> <li class=md-nav__item> <a href=#replace-the-substring-for-balanced-string class=md-nav__link> Replace the Substring for Balanced String </a> </li> <li class=md-nav__item> <a href=#binary-subarrays-with-sum class=md-nav__link> Binary Subarrays With Sum </a> </li> <li class=md-nav__item> <a href=#fruit-into-baskets class=md-nav__link> Fruit Into Baskets </a> </li> <li class=md-nav__item> <a href=#shortest-subarray-with-sum-at-least-k class=md-nav__link> Shortest Subarray with Sum at Least K </a> </li> <li class=md-nav__item> <a href=#minimum-size-subarray-sum_1 class=md-nav__link> Minimum Size Subarray Sum </a> </li> <li class=md-nav__item> <a href=#substring-with-concatenation-of-all-words class=md-nav__link> Substring with Concatenation of All Words </a> </li> <li class=md-nav__item> <a href=#max-consecutive-ones-ii class=md-nav__link> Max Consecutive Ones II </a> </li> <li class=md-nav__item> <a href=#max-consecutive-ones-iii class=md-nav__link> Max Consecutive Ones III </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-4-k-sum-problems class=md-nav__link> Category 4 K Sum problems </a> <nav class=md-nav aria-label="Category 4 K Sum problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#two-sum class=md-nav__link> Two Sum </a> </li> <li class=md-nav__item> <a href=#two-sum-ii-input-array-is-sorted class=md-nav__link> Two Sum II - Input array is sorted </a> </li> <li class=md-nav__item> <a href=#two-sum-iii-data-structure-design class=md-nav__link> Two Sum III - Data structure design </a> </li> <li class=md-nav__item> <a href=#two-sum-iv-input-is-a-bst class=md-nav__link> Two Sum IV - Input is a BST </a> </li> <li class=md-nav__item> <a href=#3sum class=md-nav__link> 3Sum </a> </li> <li class=md-nav__item> <a href=#3sum-closest class=md-nav__link> 3Sum Closest </a> </li> <li class=md-nav__item> <a href=#3sum-smaller class=md-nav__link> 3Sum Smaller </a> </li> <li class=md-nav__item> <a href=#4sum class=md-nav__link> 4Sum </a> </li> <li class=md-nav__item> <a href=#4sum-ii class=md-nav__link> 4Sum II </a> </li> <li class=md-nav__item> <a href=#k-sum class=md-nav__link> K Sum </a> </li> <li class=md-nav__item> <a href=#target-sum class=md-nav__link> Target Sum </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cagegory-5-2d-arry-matrix-grid-problems class=md-nav__link> Cagegory 5 2D arry (matrix, grid) problems </a> <nav class=md-nav aria-label="Cagegory 5 2D arry (matrix, grid) problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#perfect-rectangle class=md-nav__link> Perfect Rectangle </a> </li> <li class=md-nav__item> <a href=#trapping-rain-water class=md-nav__link> Trapping Rain Water </a> </li> <li class=md-nav__item> <a href=#trapping-rain-water-ii class=md-nav__link> Trapping Rain Water II </a> </li> <li class=md-nav__item> <a href=#container-with-most-water class=md-nav__link> Container With Most Water </a> </li> <li class=md-nav__item> <a href=#largest-rectangle-in-histogram class=md-nav__link> Largest Rectangle in Histogram </a> </li> <li class=md-nav__item> <a href=#maximal-rectangle_1 class=md-nav__link> Maximal Rectangle </a> </li> <li class=md-nav__item> <a href=#maximal-square_1 class=md-nav__link> Maximal Square </a> </li> <li class=md-nav__item> <a href=#the-skyline-problem class=md-nav__link> The Skyline Problem </a> </li> <li class=md-nav__item> <a href=#smallest-rectangle-enclosing-black-pixels class=md-nav__link> Smallest Rectangle Enclosing Black Pixels </a> </li> <li class=md-nav__item> <a href=#rectangle-area class=md-nav__link> Rectangle Area </a> </li> <li class=md-nav__item> <a href=#max-sum-of-rectangle-no-larger-than-k_1 class=md-nav__link> Max Sum of Rectangle No Larger Than K </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#category-6-stock-buying-problems class=md-nav__link> Category 6 stock buying problems </a> <nav class=md-nav aria-label="Category 6 stock buying problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#121-best-time-to-buy-and-sell-stock class=md-nav__link> 121. Best Time to Buy and Sell Stock </a> </li> <li class=md-nav__item> <a href=#122-best-time-to-buy-and-sell-stock-ii class=md-nav__link> 122. Best Time to Buy and Sell Stock II </a> </li> <li class=md-nav__item> <a href=#123-best-time-to-buy-and-sell-stock-iii class=md-nav__link> 123. Best Time to Buy and Sell Stock III </a> </li> <li class=md-nav__item> <a href=#188-best-time-to-buy-and-sell-stock-iv class=md-nav__link> 188. Best Time to Buy and Sell Stock IV </a> </li> <li class=md-nav__item> <a href=#309-best-time-to-buy-and-sell-stock-with-cooldown class=md-nav__link> 309. Best Time to Buy and Sell Stock with Cooldown </a> </li> <li class=md-nav__item> <a href=#714-best-time-to-buy-and-sell-stock-with-transaction-fee class=md-nav__link> 714. Best Time to Buy and Sell Stock with Transaction Fee </a> </li> <li class=md-nav__item> <a href=#determine-the-buy-data-and-sell-data-of-maximum-profit-dd-139 class=md-nav__link> Determine the buy data and sell data of maximum profit (DD 139) </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=array>Array<a class=headerlink href=#array title="Permanent link">&para;</a></h1> <h2 id=category-1-removecontains-duplidate>Category 1 Remove/Contains Duplidate<a class=headerlink href=#category-1-removecontains-duplidate title="Permanent link">&para;</a></h2> <h3 id=contains-duplicate>Contains Duplicate<a class=headerlink href=#contains-duplicate title="Permanent link">&para;</a></h3> <h3 id=contains-duplicate-ii>Contains Duplicate II<a class=headerlink href=#contains-duplicate-ii title="Permanent link">&para;</a></h3> <h3 id=contains-duplicate-iii>Contains Duplicate III<a class=headerlink href=#contains-duplicate-iii title="Permanent link">&para;</a></h3> <h3 id=find-the-duplicate-number>Find the Duplicate Number<a class=headerlink href=#find-the-duplicate-number title="Permanent link">&para;</a></h3> <h3 id=remove-duplicates-from-sorted-array>Remove Duplicates from Sorted Array<a class=headerlink href=#remove-duplicates-from-sorted-array title="Permanent link">&para;</a></h3> <h3 id=remove-duplicates-from-sorted-array-ii>Remove Duplicates from Sorted Array II<a class=headerlink href=#remove-duplicates-from-sorted-array-ii title="Permanent link">&para;</a></h3> <h3 id=remove-duplicates-from-sorted-list-ii>Remove Duplicates from Sorted List II<a class=headerlink href=#remove-duplicates-from-sorted-list-ii title="Permanent link">&para;</a></h3> <h3 id=remove-duplicates-from-sorted-list>Remove Duplicates from Sorted List<a class=headerlink href=#remove-duplicates-from-sorted-list title="Permanent link">&para;</a></h3> <h3 id=move-zeroes>Move Zeroes<a class=headerlink href=#move-zeroes title="Permanent link">&para;</a></h3> <h2 id=category-2-matrix-problems>Category 2 Matrix problems<a class=headerlink href=#category-2-matrix-problems title="Permanent link">&para;</a></h2> <h3 id=spiral-matrix>Spiral Matrix<a class=headerlink href=#spiral-matrix title="Permanent link">&para;</a></h3> <h3 id=spiral-matrix-ii>Spiral Matrix II<a class=headerlink href=#spiral-matrix-ii title="Permanent link">&para;</a></h3> <h3 id=search-a-2d-matrix>Search a 2D Matrix<a class=headerlink href=#search-a-2d-matrix title="Permanent link">&para;</a></h3> <h3 id=search-a-2d-matrix-ii>Search a 2D Matrix II<a class=headerlink href=#search-a-2d-matrix-ii title="Permanent link">&para;</a></h3> <h3 id=rotate-image>Rotate Image<a class=headerlink href=#rotate-image title="Permanent link">&para;</a></h3> <h3 id=range-sum-query-2d-mutable><a href=#range-sum-query-2d-mutable>Range Sum Query 2D - Mutable</a><a class=headerlink href=#range-sum-query-2d-mutable title="Permanent link">&para;</a></h3> <h3 id=range-sum-query-2d-immutable><a href=#range-sum-query-2d-immutable>Range Sum Query 2D - Immutable</a><a class=headerlink href=#range-sum-query-2d-immutable title="Permanent link">&para;</a></h3> <h3 id=maximal-square>Maximal Square<a class=headerlink href=#maximal-square title="Permanent link">&para;</a></h3> <h3 id=maximal-rectangle>Maximal Rectangle<a class=headerlink href=#maximal-rectangle title="Permanent link">&para;</a></h3> <h2 id=category-3-subarray-problems>Category 3 Subarray problems<a class=headerlink href=#category-3-subarray-problems title="Permanent link">&para;</a></h2> <h3 id=type-of-subarray-problem>Type of subarray problem<a class=headerlink href=#type-of-subarray-problem title="Permanent link">&para;</a></h3> <ul> <li>Find a subarray that fulfills a certain property, i.e maximum size subarray, <a href=#longest-substring-with-at-most-two-distinct-characters>Longest Substring with At Most Two Distinct Characters</a><ol> <li>Use map or two pointer to solve the problem.</li> </ol> </li> <li>Split into subarrays that fulfill certain properties, i.e. sum greater than k.</li> </ul> <div class="admonition note"> <p class=admonition-title>Fixed length subarray indexing</p> <p>To correctly index an array in solving subarray problems are critical. Here is some tips: 1. To iterate through a subarray of certain size, alwasy using the <strong>"one-of-the-end"</strong> pattern. Namely, the iteration index <code>i</code> point to the <strong>"one-off-the-end"</strong> of the subarray. The subarray of size K before the index is started at index <code>i - k</code>. 2. The above convention is especially useful in subarray problems given constrains, such as "the subarray size greater than <code>k</code>", "maximum sum of non-overlapping subarray", etc. 3. Example problems - <a href=#maximum-average-subarray-ii>Maximum Average Subarray II</a> - <a href=#maximum-sum-of-two-non-overlapping-subarrays>Maximum Sum of Two Non-Overlapping Subarrays</a></p> </div> <h3 id=two-types-of-prefix-sum>Two types of prefix sum<a class=headerlink href=#two-types-of-prefix-sum title="Permanent link">&para;</a></h3> <p>There are two ways to calculate the prefix sum array. Take which ever conveniece for your when solving a problem.</p> <p><strong>Option 1:</strong> <code>sums.resize(n, 0);</code></p> <div class=highlight><pre><span></span><code>nums: [1, 2, 3,  4,  5,  6,  7,  8,  9]
             i               j
sums: [1, 3, 6, 10, 15, 21, 28, 36, 45]
</code></pre></div> <p>In this case, each element <code>sums[i]</code> in sums represent the cumulative sum for indexes <code>[0, ..., i]</code>. In other words, <code>sum[i]</code> represent cumulative sum up to element <code>i</code> inclusive. When you want to get the range sum <code>rangeSum(i, j)</code>, you can get it in the following way:</p> <div class=highlight><pre><span></span><code><span class=n>rangeSum</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=c1>// i &gt; 0</span>
<span class=n>rangeSum</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>               <span class=c1>// i == 0</span>
</code></pre></div> <p>work with this option is a little complex, to get the <code>rangeSum(i, j)</code>:</p> <div class=highlight><pre><span></span><code><span class=n>rangeSum</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=c1>// i &gt;= 0</span>
</code></pre></div> <p><strong>Option 2:</strong> <code>sums.resize(n + 1, 0);</code></p> <p>In this case, each element <code>sums[i]</code> in sums represent the prefix sum of the first <code>i</code> elements in original array nums. When you want to get the range sum by <code>rangeSum(i, j)</code>, you can get it in the following way:</p> <div class=highlight><pre><span></span><code><span class=n>rangeSum</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=c1>// i &gt;= 0</span>
</code></pre></div> <h3 id=using-prefix-sum-with-map>Using prefix sum with map<a class=headerlink href=#using-prefix-sum-with-map title="Permanent link">&para;</a></h3> <p>One of the core trick in solving the following subarray problems is to build a map from prefix sum to array index for efficient lookup. For example, problems with keywaords "maximum size equal to K", "differ by K", or "differ by multiple of k" are solved using this trick. There are two hints.</p> <div class="admonition hint"> <p class=admonition-title>Hint</p> <p>When a map is used, it need to be initialized using <code>&lt;0, -1&gt;</code>. It is useful for handling some of the corner cases such as <code>[-1, 1], -1</code> in the problem <a href=./#maximum-size-subarray-sum-equals-k>Maximum Size Subarray Sum Equals k</a>.</p> </div> <div class="admonition hint"> <p class=admonition-title>Hint</p> <p>It is usually easier to work with these problem when adding dummy element at the beginning of the array. For example: using <code>sums[i]</code> to represent the sum of first <code>i</code> element of array <code>nums</code>.</p> </div> <h3 id=maximum-subarray>Maximum Subarray<a class=headerlink href=#maximum-subarray title="Permanent link">&para;</a></h3> <p>Kadane's solution</p> <p>This is a DP solution, it reduced the <code>f</code> array to two variables. Making the problem <span><span class=MathJax_Preview>O(1)</span><script type=math/tex>O(1)</script></span> in space. <a href=http://blog.csdn.net/linhuanmars/article/details/21314059>Discuss about this solution</a>, where it make use of the idea of global maximum and local maximum.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Why can not compare to <code>f[i - 1]</code> to find the maximum. If comparing to the <code>f[i - 1]</code>, it will skip elements, the sum will not from a subarray, but sequence of numbers in the array. This is very similar to problems Longest Common Substring and Longest Common Subsequence. The DP "Choices" here is <strong>NOT</strong> to choose or not choose <code>A[i]</code>, but "Add <code>A[i]</code> to the result of the subproblem or we have to start a subarray from <code>i</code>" because we cannot skip <code>A[i]</code>.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The idea of <strong>global maximum</strong> and <strong>local maximum</strong> is very useful to solve DP problems. The local maximum is the maximum sum of a continuous subarray, the global maximum is to keep the maximum of the from the local and global maximum.</p> </div> <p>Prefix sum solution</p> <p>The ideas is we have array sums, <code>sums[i] = A[0] +, ... + A[i]</code>, called prefix sum. With one for loop we can find the maxSum so far and the minSum before it. The difference is the possible results, we collect the maximum of those differences.</p> <p>related to <a href=#jump-game>Jump Game</a></p> <div class=tabbed-set data-tabs=1:4><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>C++ DP</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSubArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>f</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span> <span class=c1>// f[i] = maxSubArray of first i elements</span>
        <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>           <span class=c1>// initial value</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
</span>            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>res</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>C++ Kadane's solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSubArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>curr</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>            <span class=n>curr</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>curr</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span>            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>curr</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_1_3 name=__tabbed_1 type=radio><label for=__tabbed_1_3>Java prefix sum solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Solution</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>maxSubArray</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span> <span class=n>A</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>A</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>A</span><span class=p>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>0</span><span class=p>){</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>max</span> <span class=o>=</span> <span class=n>Integer</span><span class=p>.</span><span class=na>MIN_VALUE</span><span class=p>,</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>minSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>A</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>;</span>
            <span class=n>max</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=na>max</span><span class=p>(</span><span class=n>max</span><span class=p>,</span> <span class=n>sum</span> <span class=o>-</span> <span class=n>minSum</span><span class=p>);</span>
            <span class=n>minSum</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=na>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sum</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>max</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_1_4 name=__tabbed_1 type=radio><label for=__tabbed_1_4>C++ Greedy solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=c1>// why this greedy solution works?</span>
<span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSubArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>max</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>max</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>max</span> <span class=o>=</span> <span class=n>sum</span> <span class=o>&gt;</span> <span class=n>max</span> <span class=o>?</span> <span class=nl>sum</span> <span class=p>:</span> <span class=n>max</span><span class=p>;</span>
            <span class=n>sum</span> <span class=o>=</span> <span class=n>sum</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>?</span> <span class=nl>sum</span> <span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>max</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=maximum-subarray-ii>Maximum Subarray II*<a class=headerlink href=#maximum-subarray-ii title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>Given an array of integers, find two non-overlapping subarrays which have the
largest sum. The number in each subarray should be contiguous. Return the largest
sum.

Notice
The subarray should contain at least one number

Example
For given [1, 3, -1, 2, -1, 2], the two subarrays are [1, 3] and [2, -1, 2] or
[1, 3, -1, 2] and [2], they both have the largest sum 7.
</code></pre></div> <p>Prefix sum solution</p> <div class=tabbed-set data-tabs=2:1><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><label for=__tabbed_2_1>C++ Prefix sum solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/*</span>
<span class=cm>    * @param nums: A list of integers</span>
<span class=cm>    * @return: An integer denotes the sum of max two non-overlapping subarrays</span>
<span class=cm>    */</span>
    <span class=kt>int</span> <span class=n>maxTwoSubArrays</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>minSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>maxSum</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>left</span> <span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>right</span> <span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

        <span class=cm>/* calculate the prefix sum */</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=hll>            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>sums</span> <span class=o>-</span> <span class=n>minSum</span><span class=p>);</span> <span class=c1>// minSum is previous calculated</span>
</span><span class=hll>            <span class=n>minSum</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sums</span><span class=p>);</span>
</span>            <span class=n>left</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>maxSum</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=cm>/* calculate the postfix sum */</span>
        <span class=n>minSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>maxSum</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=hll>            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>sums</span> <span class=o>-</span> <span class=n>minSum</span><span class=p>);</span>
</span><span class=hll>            <span class=n>minSum</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sums</span><span class=p>);</span>
</span>            <span class=n>right</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>maxSum</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=cm>/* iterate the divider line, left[i] stored the maxSubArraySum</span>
<span class=cm>        * from nums[0] to nums[i], similar for right[i] */</span>
        <span class=n>maxSum</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>left</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>right</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>maxSum</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Cannot swap the highlighted lines. Because the maximum sum is calculated from current sum minus the previous minSum.</p> </div> <h3 id=maximum-subarray-iii>Maximum Subarray III*<a class=headerlink href=#maximum-subarray-iii title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>Given an array of integers and a number k, find k non-overlapping subarrays which
have the largest sum. The number in each subarray should be contiguous.

Return the largest sum.

Notice
The subarray should contain at least one number

Example
Input:
List = [-1,4,-2,3,-2,3]
k = 2
Output: 8
Explanation: 4 + (3 + -2 + 3) = 8
</code></pre></div> <p>DP solution</p> <p>Use the idea of global maximum and local maximum from <a href=./#maximum-subarray>Maximum Subarray</a>. See <a href=https://zhengyang2015.gitbooks.io/lintcode/maximum_subarray_iii_43.html>this artical</a> for detailed explaination of the solution.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/**</span>
<span class=cm>     * My initial try: O(n^2 k)</span>
<span class=cm>     * Partitioning DP: f[n][k], maximum K subarrays of first n elements.</span>
<span class=cm>     * Last partition: A[j] ,... A[n - 1]</span>
<span class=cm>     * f[i][k] = max_{0 &lt;= j &lt; i}(f[j][k - 1] + MS(A[j] ,... A[i - 1]))</span>
<span class=cm>     * f[0][0] =</span>
<span class=cm>     *</span>
<span class=cm>     * Solution 2, O(nk)</span>
<span class=cm>     * local[i][k]: Max k subarray sum from &quot;first i elements&quot; that include nums[i]</span>
<span class=cm>     * global[i][k]: Max k subarray sum from &quot;first i elements&quot; that may not include nums[i]</span>
<span class=cm>     *</span>
<span class=cm>     * 2 cases:     nums[i - 1] is kth subarray, nums[i - 1] belongs to kth subarray</span>
<span class=cm>     * local[i][k] = max(global[i - 1][k - 1], local[i - 1][k]) + nums[i - 1]</span>
<span class=cm>     *</span>
<span class=cm>     * 2 cases:     not include nums[i - 1], include nums[i - 1]</span>
<span class=cm>     * global[i][k] = max(global[i - 1][k], local[i][k])</span>
<span class=cm>     */</span>
    <span class=kt>int</span> <span class=n>maxSubArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>

        <span class=kt>int</span> <span class=n>local</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>global</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>k</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>// first j - 1 elements cannot form j groups, set to INT_MIN.</span>
            <span class=n>local</span><span class=p>[</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>j</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// must: i &gt;= k.</span>
                <span class=n>local</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>global</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>local</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                <span class=c1>// the case when we divide k elements into k groups.</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>global</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>local</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                    <span class=n>global</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>global</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>local</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>global</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=n>k</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=maximum-subarray-difference>Maximum Subarray Difference*<a class=headerlink href=#maximum-subarray-difference title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>Given an array with integers.
Find two non-overlapping subarrays A and B, which |SUM(A) - SUM(B)| is the largest.

Return the largest difference.

Notice
The subarray should contain at least one number

Example
For [1, 2, -3, 1], return 6.
</code></pre></div> <p>Prefix sum solution</p> <p>We use the similar idea for problem <a href=./#maximum-subarray-ii>Maximum Subarray II</a>. We have to maintain four arrays. from forward maximum and minimum subarray sum and backward maximum and minimum subarray sum.</p> <div class=tabbed-set data-tabs=3:1><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><label for=__tabbed_3_1>C++ Prefix sum solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/*</span>
<span class=cm>    * @param nums: A list of integers</span>
<span class=cm>    * @return: value of maximum difference between two subarrays</span>
<span class=cm>    */</span>
    <span class=kt>int</span> <span class=n>maxDiffSubArrays</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>minSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>maxSum</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>left_max</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>left_min</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>right_max</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>right_min</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>sums</span> <span class=o>-</span> <span class=n>minSum</span><span class=p>);</span>
            <span class=n>minSum</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sums</span><span class=p>);</span>
            <span class=n>left_max</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>maxSum</span><span class=p>;</span>
            <span class=c1>//left_min[i] = minSum;</span>
        <span class=p>}</span>

        <span class=n>minSum</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>maxSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>minSum</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sums</span> <span class=o>-</span> <span class=n>maxSum</span><span class=p>);</span>
            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>sums</span><span class=p>);</span>
            <span class=c1>//left_max[i] = maxSum;</span>
            <span class=n>left_min</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>minSum</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>minSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>maxSum</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>sums</span> <span class=o>-</span> <span class=n>minSum</span><span class=p>);</span>
            <span class=n>minSum</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sums</span><span class=p>);</span>
            <span class=n>right_max</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>maxSum</span><span class=p>;</span>
            <span class=c1>//right_min[i] = minSum;</span>
        <span class=p>}</span>

        <span class=n>minSum</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>maxSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>minSum</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>minSum</span><span class=p>,</span> <span class=n>sums</span> <span class=o>-</span> <span class=n>maxSum</span><span class=p>);</span>
            <span class=n>maxSum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>maxSum</span><span class=p>,</span> <span class=n>sums</span><span class=p>);</span>
            <span class=c1>//right_max[i] = maxSum;</span>
            <span class=n>right_min</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>minSum</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>diff</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>diff</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>left_max</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>right_min</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>diff</span><span class=p>);</span>
            <span class=n>diff</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>right_max</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>left_min</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>diff</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>diff</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=maximum-product-subarray>Maximum Product Subarray<a class=headerlink href=#maximum-product-subarray title="Permanent link">&para;</a></h3> <p>DP solution</p> <ul> <li>It is similar to the problem <a href=./#maximum-subarray>Maximum Subarray</a>. Notice the negative number, min multiply a minus number could become the largest product.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxProduct</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>max_pro</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>min_pro</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>result</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>

        <span class=n>max_pro</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=n>min_pro</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>max_pro</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>max_pro</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
                <span class=n>min_pro</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>min_pro</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>max_pro</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>min_pro</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
                <span class=n>min_pro</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>max_pro</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
            <span class=p>}</span>

            <span class=n>result</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>max_pro</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>Constant space solution</p> <p>Without need to check whether <code>nums[i]</code> is positive is negative, we can just find the maximum or minium of three cases.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/*</span>
<span class=cm>     * @param nums: An array of integers</span>
<span class=cm>     * @return: An integer</span>
<span class=cm>     */</span>
    <span class=kt>int</span> <span class=n>maxProduct</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=kt>int</span> <span class=n>cur_max</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=kt>int</span> <span class=n>cur_min</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>cur_max</span><span class=p>;</span>
            <span class=n>cur_max</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>max</span><span class=p>(</span><span class=n>cur_max</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>cur_min</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
            <span class=n>cur_min</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>min</span><span class=p>(</span><span class=n>cur_min</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>tmp</span> <span class=o>*</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>cur_max</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=subarray-product-less-than-k>Subarray Product Less Than K<a class=headerlink href=#subarray-product-less-than-k title="Permanent link">&para;</a></h3> <h3 id=subarray-sum>Subarray Sum*<a class=headerlink href=#subarray-sum title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>Given an integer array, find a subarray where the sum of numbers is zero.
Your code should return the index of the first number and the index of the last
number.

Notice
There is at least one subarray that it&#39;s sum equals to zero.

Example
Given [-3, 1, 2, -3, 4], return [0, 2] or [1, 3].
</code></pre></div> <p>Hash solution</p> <p>use a hash table to keep the prefix sum. Once we see another prefix sum that exists in the hash table, we discovered the subarray that sums to zero. However, pay attention to the indexing, because it requires to return the original array's index.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/**</span>
<span class=cm>     * @param nums: A list of integers</span>
<span class=cm>     * @return: A list of integers includes the index of the first number</span>
<span class=cm>     *          and the index of the last number</span>
<span class=cm>     */</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>subarraySum</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>){</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>map</span><span class=p>;</span>

        <span class=n>map</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>-1</span><span class=p>;</span> <span class=c1>//important</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>sum</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>map</span><span class=p>[</span><span class=n>sum</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
                <span class=n>res</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
                <span class=k>break</span><span class=p>;</span>  
            <span class=p>}</span>

            <span class=n>map</span><span class=p>[</span><span class=n>sum</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
<span class=c1>// test cases</span>
<span class=c1>//    [-1, 2, 3, -3] A</span>
<span class=c1>//  [0,-1, 1, 4,  1] sum</span>
<span class=c1>//         i      j</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Pay attention to the initial value and initializethe <code>map[0] = -1</code>; This can be validated with an edge case. The time complexity is O(n)</p> </div> <p>Prefix sum solution</p> <p>Calculate the prefix sum first and then use the prefix sum to find the subarray. This solution is <span><span class=MathJax_Preview>O(n^2)</span><script type=math/tex>O(n^2)</script></span></p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>subarraySum</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>){</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>sum</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>sum</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>sum</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
                    <span class=n>res</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
                    <span class=k>break</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=minimum-size-subarray-sum>Minimum Size Subarray Sum<a class=headerlink href=#minimum-size-subarray-sum title="Permanent link">&para;</a></h3> <p>Accumulative sum solution</p> <p>Using accumulative sum and another moving pointer to check both the sum and the length of the subarray.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>minSubArrayLen</span><span class=p>(</span><span class=kt>int</span> <span class=n>s</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>left</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>sum</span> <span class=o>&gt;=</span> <span class=n>s</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>i</span> <span class=o>-</span> <span class=n>left</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
                <span class=n>sum</span> <span class=o>-=</span> <span class=n>nums</span><span class=p>[</span><span class=n>left</span><span class=o>++</span><span class=p>];</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span> <span class=o>!=</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=nl>res</span> <span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=maximum-size-subarray-sum-equals-k>Maximum Size Subarray Sum Equals k<a class=headerlink href=#maximum-size-subarray-sum-equals-k title="Permanent link">&para;</a></h3> <p>Similar to <a href=./continuous-subarray-sum>Continuous Subarray Sum</a></p> <p>Hash solution</p> <p>Use a hash table to keep <code>&lt;sums, i&gt;</code> entries. Look up using <code>sum - k</code>. We only add to the hash table for the first time a value is appeared. It ensures the length of the found subarray is the largest. Notice you also have to initialize the hash with value <code>&lt;0, -1&gt;</code> to handle the edge case.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSubArrayLen</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>map</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>left</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=n>map</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>-1</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>sum</span> <span class=o>-</span> <span class=n>k</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>left</span> <span class=o>=</span> <span class=n>map</span><span class=p>[</span><span class=n>sum</span> <span class=o>-</span> <span class=n>k</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>left</span> <span class=o>+</span> <span class=mi>1</span><span class=p>));</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>sum</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>map</span><span class=p>[</span><span class=n>sum</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span> <span class=o>!=</span> <span class=n>INT_MIN</span> <span class=o>?</span> <span class=nl>res</span> <span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
<span class=cm>/* test cases:</span>
<span class=cm>1. [-1, 1], -1 hashcase</span>
<span class=cm>   [-1, 0] sums</span>
<span class=cm>2. [-1], 0</span>
<span class=cm>3. [-1], -1</span>
<span class=cm>4. if return the result will be 1 if there is no res variable</span>
<span class=cm>   [1, 1, 0], 1</span>
<span class=cm>   [1, 2, 2], 1</span>
<span class=cm>*/</span>
</code></pre></div> <h3 id=subarray-sum-equals-k>Subarray Sum Equals K<a class=headerlink href=#subarray-sum-equals-k title="Permanent link">&para;</a></h3> <p>Prefix sum solution</p> <p>Use prefix sum to find the subarray sum. Two pointer to check all the possible subarray sum.</p> <div class=tabbed-set data-tabs=4:1><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><label for=__tabbed_4_1>C++ prefix sum solution</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code><span class=k>public</span> <span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
    <span class=k>public</span> <span class=kt>int</span> <span class=n>subarraySum</span><span class=p>(</span><span class=kt>int</span><span class=p>[]</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span><span class=p>[]</span> <span class=n>sum</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=p>[</span><span class=n>nums</span><span class=p>.</span><span class=n>length</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
        <span class=n>sum</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>nums</span><span class=p>.</span><span class=n>length</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
            <span class=n>sum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>start</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>start</span> <span class=o>&lt;</span> <span class=n>nums</span><span class=p>.</span><span class=n>length</span><span class=p>;</span> <span class=n>start</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>end</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>end</span> <span class=o>&lt;=</span> <span class=n>nums</span><span class=p>.</span><span class=n>length</span><span class=p>;</span> <span class=n>end</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>sum</span><span class=p>[</span><span class=n>end</span><span class=p>]</span> <span class=o>-</span> <span class=n>sum</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>==</span> <span class=n>k</span><span class=p>)</span>
                    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>Hash solution</p> <p>Use a map to store the prefix sum and a counter. The idea is while calculating prefix sums, if we find an <code>sums - k</code> exist in the map, we found one of target subarray. The subtilty is for a particular prefix sum, there might be multiple earlier prefix sums differ from it by k. We should take this into account. Compare to the hash solution for problem <a href=./subarray-sum>Subarray Sum</a>.</p> <div class=highlight><pre><span></span><code>/*
  k =  2
  i =  1,  2,  3
sum =  1,  2,  3
cnt =  0,  1,  2
key =  1,  2,  3
val =  1,  1,  1
the reason that the cnt += map[sum - k], not cnt += 1 is that
the prefix sum &quot;sum - k&quot; has been shown up for total of map[sum - k] times.
All those prefix sum could be result of distinct subarrays between current
prefix sum and previous prefix sum &quot;sum - k&quot;
*/
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>subarraySum</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=c1>// key=prefix sum, val=appearance</span>
        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>map</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>map</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>sum</span> <span class=o>-</span> <span class=n>k</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>cnt</span> <span class=o>+=</span> <span class=n>map</span><span class=p>[</span><span class=n>sum</span> <span class=o>-</span> <span class=n>k</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=n>map</span><span class=p>[</span><span class=n>sum</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>cnt</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Notice you have to initialize the <code>map[0] = 1</code>; this is because for cases such as <code>[1, 1, 1]</code>, when <code>i = 1</code>, <code>sum = 2</code>, <code>[1,1]</code> should be counted as one subarray. Without setting <code>map[0] = 1</code> at first hand, it will give incorrect results.</p> </div> <h3 id=subarray-sums-divisible-by-k>Subarray Sums Divisible by K<a class=headerlink href=#subarray-sums-divisible-by-k title="Permanent link">&para;</a></h3> <ul> <li>preSum is the basis of continuous subarray profblem.</li> <li>One pass solution should explore a property of modulo <code>(preSum[j] - preSum[i]) % K == 0</code> indicate the when removing <code>K</code> from the larger value <code>preSum[j]</code> <code>n</code> times, we get the smaller value, then <code>preSum[j] % K == preSum[i] % K</code>. This property makes the one pass solution possible.</li> <li>Once the modulo property is found, we can use Hash map to assist our counting. The ideas is to keep counting the remainder, once we have seen the same remainder in the map, the new index and all the found indexes can be used to retrive one solution. The count keep in the map show how many of those can be.</li> </ul> <div class=tabbed-set data-tabs=5:1><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><label for=__tabbed_5_1>One pass solution</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>subarraysDivByK</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>A</span><span class=p>,</span> <span class=kt>int</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>K</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>preSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>mp</span><span class=p>;</span>
        <span class=n>mp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>preSum</span> <span class=o>+=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>

            <span class=kt>int</span> <span class=n>reminder</span> <span class=o>=</span> <span class=n>preSum</span> <span class=o>%</span> <span class=n>K</span><span class=p>;</span>
            <span class=c1>// deal with negative values</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>reminder</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
                <span class=n>reminder</span> <span class=o>+=</span> <span class=n>K</span><span class=p>;</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>mp</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>reminder</span><span class=p>)</span> <span class=o>!=</span> <span class=n>mp</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span>
                <span class=n>count</span> <span class=o>+=</span> <span class=n>mp</span><span class=p>[</span><span class=n>reminder</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=n>mp</span><span class=p>[</span><span class=n>reminder</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>==="Naive solution O(n^2)"</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>subarraysDivByK</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>A</span><span class=p>,</span> <span class=kt>int</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>K</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span><span class=o>&gt;</span> <span class=n>preSum</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>preSum</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>
        <span class=kt>int</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>((</span><span class=n>preSum</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>%</span> <span class=n>K</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>cnt</span><span class=o>++</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>cnt</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=max-sum-of-subarry-no-larger-than-k>Max Sum of Subarry No Larger Than K*<a class=headerlink href=#max-sum-of-subarry-no-larger-than-k title="Permanent link">&para;</a></h3> <ol> <li>This problem in geeksforgeeks as "Maximum sum subarray having sum less than or equal to given sum".</li> <li>It has been discussed here.</li> <li>This problem is the basis to solve the problem 363. Max Sum of Rectangle No Larger Than K.</li> </ol> <p>Solution 1 using prefix sum and set</p> <ol> <li>calculate prefix and using a set to store individual prefix sum, (<code>vector</code> also works). In each iteration, we lookup the value <code>preSum - k</code> in the set.</li> <li>Notice we can use binary search to find the smallest element that <code>&gt;= preSum - k</code>. We can use <code>lower_bound</code> to achieve that. Notice if it is asking the sum less than k we have to use <code>upper_bound</code></li> </ol> <div class=highlight><pre><span></span><code><span class=kt>int</span> <span class=nf>maxSumSubarryNoLargerThanK</span> <span class=p>(</span><span class=kt>int</span> <span class=n>A</span><span class=p>[],</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>set</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>preSumSet</span><span class=p>;</span>
    <span class=n>preSumSet</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>

    <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>preSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>preSum</span> <span class=o>+=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=n>set</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;::</span><span class=n>iterator</span> <span class=n>siter</span> <span class=o>=</span> <span class=n>preSumSet</span><span class=p>.</span><span class=n>lower_bound</span><span class=p>(</span><span class=n>preSum</span> <span class=o>-</span> <span class=n>k</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>siter</span> <span class=o>!=</span> <span class=n>preSumSet</span><span class=p>.</span><span class=n>end</span><span class=p>()</span> <span class=p>{</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>preSum</span> <span class=o>-</span> <span class=o>*</span><span class=n>siter</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=n>preSumSet</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>preSum</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <h3 id=max-sum-of-rectangle-no-larger-than-k>Max Sum of Rectangle No Larger Than K<a class=headerlink href=#max-sum-of-rectangle-no-larger-than-k title="Permanent link">&para;</a></h3> <p>Solution 1 iterate the wide of the matrix and using prefix sum and set <code>lower_bound</code>.</p> <ol> <li>To optimize it with the brute force solution, you will find this problem is a combination of the problem Maximum Sum Rectangular Submatrix in Matrix and problem Max Sum of Subarry No Larger Than K.</li> <li>From the problem Max Sum of Subarry No Larger Than K, we have to enumerate the width of the sub-matrix and sum up all row elements and get an array of length <code>m</code>, <code>m</code> is the number of rows of the matrix. Then apply the method.</li> </ol> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSumSubmatrix</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>l</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>sums</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span> <span class=n>r</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>r</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>r</span><span class=p>];</span>
                <span class=p>}</span>

                <span class=n>set</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>preSumSet</span><span class=p>;</span>
                <span class=n>preSumSet</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
                <span class=kt>int</span> <span class=n>preSum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>curMax</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=nl>sum</span> <span class=p>:</span> <span class=n>sums</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>preSum</span> <span class=o>+=</span> <span class=n>sum</span><span class=p>;</span>
                    <span class=n>set</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;::</span><span class=n>iterator</span> <span class=n>it</span> <span class=o>=</span> <span class=n>preSumSet</span><span class=p>.</span><span class=n>lower_bound</span><span class=p>(</span><span class=n>preSum</span> <span class=o>-</span> <span class=n>k</span><span class=p>);</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>it</span> <span class=o>!=</span> <span class=n>preSumSet</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span>
                        <span class=n>curMax</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>curMax</span><span class=p>,</span> <span class=n>preSum</span> <span class=o>-</span> <span class=o>*</span><span class=n>it</span><span class=p>);</span>
                    <span class=p>}</span>
                    <span class=n>preSumSet</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>preSum</span><span class=p>);</span>
                <span class=p>}</span>

                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>curMax</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <ol> <li>The complexity is <span><span class=MathJax_Preview>nn(m+m\log m)=O(nnm\log m)</span><script type=math/tex>nn(m+m\log m)=O(nnm\log m)</script></span></li> <li>Notice the use of lower_bound, this function return iterator point to element greater than or equal to the value curSum - k, if use upper_bound, it will return iterator points to element greater than curSum - k, which would miss the equal to K case.</li> </ol> </div> <p>Solution 2 using merge sort</p> <ol> <li>The idea is similar that solution 1. Instead of calculate <code>preSum</code> on the fly, we finish calculation and pass it to a <code>mergeSort</code> routine.</li> <li>The use <code>mergeSort</code> here is to find the <code>A[j] - A[i] &lt;= k</code> efficiently, <code>O(nlogn)</code>.</li> <li>The complexity is nn(m+m\log m)=O(nnm\log m)</li> </ol> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSumSubmatrix</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span> <span class=kt>long</span><span class=o>&gt;</span> <span class=n>sums</span><span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>l</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span> <span class=kt>long</span><span class=o>&gt;</span><span class=n>sumInRow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span> <span class=n>r</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>r</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>sumInRow</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>r</span><span class=p>];</span>
                    <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>sumInRow</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
                <span class=p>}</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>k</span><span class=p>));</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>res</span> <span class=o>==</span> <span class=n>k</span><span class=p>)</span> <span class=k>return</span> <span class=n>k</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span> <span class=kt>long</span><span class=o>&gt;&amp;</span> <span class=n>sums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span> <span class=kt>int</span> <span class=n>end</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>end</span> <span class=o>==</span> <span class=n>start</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>k</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>res</span> <span class=o>==</span> <span class=n>k</span><span class=p>)</span> <span class=k>return</span> <span class=n>k</span><span class=p>;</span>

        <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>,</span> <span class=n>k</span><span class=p>));</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>res</span> <span class=o>==</span> <span class=n>k</span><span class=p>)</span> <span class=k>return</span> <span class=n>k</span><span class=p>;</span>

        <span class=kt>long</span> <span class=kt>long</span> <span class=n>cache</span><span class=p>[</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>

        <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>t</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=cm>/* search first time sums[j] - sums[i] &gt; k */</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>k</span><span class=p>)</span> <span class=o>++</span><span class=n>j</span><span class=p>;</span>
            <span class=cm>/* sums[j - 1] - sums[i] &lt;= k, make sure j - 1 is in right side */</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&gt;=</span> <span class=n>mid</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=p>(</span><span class=kt>int</span><span class=p>)(</span><span class=n>sums</span><span class=p>[</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]));</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>res</span> <span class=o>==</span> <span class=n>k</span><span class=p>)</span> <span class=k>return</span> <span class=n>k</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=cm>/* parallel merge */</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>t</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>cache</span><span class=p>[</span><span class=n>c</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>t</span><span class=o>++</span><span class=p>];</span>
            <span class=p>}</span>
            <span class=n>cache</span><span class=p>[</span><span class=n>c</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=cm>/* parallel merge */</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>t</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=maximum-sum-rectangular-submatrix-in-matrix>Maximum Sum Rectangular Submatrix in Matrix*<a class=headerlink href=#maximum-sum-rectangular-submatrix-in-matrix title="Permanent link">&para;</a></h3> <h3 id=subarray-sum-closest>Subarray Sum Closest*<a class=headerlink href=#subarray-sum-closest title="Permanent link">&para;</a></h3> <h3 id=shortest-unsorted-continuous-subarray-count-inversions>Shortest Unsorted Continuous Subarray (Count inversions)<a class=headerlink href=#shortest-unsorted-continuous-subarray-count-inversions title="Permanent link">&para;</a></h3> <p>Solution 1 using merge sort</p> <ol> <li>This problem is the basic of using merge sort to solve lots of hard problems.</li> </ol> <div class=highlight><pre><span></span><code><span class=kt>long</span> <span class=kt>long</span> <span class=n>merge_and_count</span><span class=p>(</span><span class=kt>int</span> <span class=n>A</span><span class=p>[],</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span> <span class=kt>int</span> <span class=n>end</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

    <span class=kt>long</span> <span class=kt>long</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
    <span class=n>count</span> <span class=o>=</span> <span class=n>merge_and_count</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
            <span class=o>+</span> <span class=n>merge_and_count</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>);</span>

    <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>cache</span><span class=p>[</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>A</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
            <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=n>j</span><span class=o>++</span><span class=p>];</span>
            <span class=n>count</span> <span class=o>+=</span> <span class=n>mid</span> <span class=o>-</span> <span class=n>i</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
    <span class=p>}</span>
    <span class=c1>// copy cache[0, j - start) to A[start, j)</span>
    <span class=c1>// if j &lt; end, then A[j, end) in final place.</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <h3 id=count-inversion-course-assignment>Count Inversion (course assignment)<a class=headerlink href=#count-inversion-course-assignment title="Permanent link">&para;</a></h3> <p>Solution 1 using merge sort</p> <ol> <li>This problem is the basic of using merge sort to solve lots of hard problems.</li> </ol> <div class=highlight><pre><span></span><code><span class=kt>long</span> <span class=kt>long</span> <span class=n>merge_and_count</span><span class=p>(</span><span class=kt>int</span> <span class=n>A</span><span class=p>[],</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span> <span class=kt>int</span> <span class=n>end</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

    <span class=kt>long</span> <span class=kt>long</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
    <span class=n>count</span> <span class=o>=</span> <span class=n>merge_and_count</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
            <span class=o>+</span> <span class=n>merge_and_count</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>);</span>

    <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>cache</span><span class=p>[</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>A</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
            <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=n>j</span><span class=o>++</span><span class=p>];</span>
            <span class=n>count</span> <span class=o>+=</span> <span class=n>mid</span> <span class=o>-</span> <span class=n>i</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
    <span class=p>}</span>
    <span class=c1>// copy cache[0, j - start) to A[start, j)</span>
    <span class=c1>// if j &lt; end, then A[j, end) in final place.</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <h3 id=count-of-smaller-numbers-after-self>Count of Smaller Numbers After Self<a class=headerlink href=#count-of-smaller-numbers-after-self title="Permanent link">&para;</a></h3> <p>Solution 1 Merge sort</p> <ol> <li>One important point to remember is you have to create pairs out of the array element and its index, because during merge sort, when we count each value, we don't know where to put those count values in the result vector.</li> <li>The second merge solutions run much faster than the first one.</li> </ol> <div class=tabbed-set data-tabs=6:3><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><label for=__tabbed_6_1>C++ Merge sort</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>countSmaller</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>vp</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>vp</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=n>merge_sort_count</span><span class=p>(</span><span class=n>vp</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

<span class=k>private</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>merge_sort_count</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span> <span class=kt>int</span> <span class=n>end</span><span class=p>,</span>
                        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>res</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span>
            <span class=k>return</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>

        <span class=n>merge_sort_count</span><span class=p>(</span><span class=n>nums</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
        <span class=n>merge_sort_count</span><span class=p>(</span><span class=n>nums</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>cache</span><span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>,</span> <span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>t</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span> <span class=o>&gt;</span> <span class=n>nums</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>first</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// found smaller elements</span>
                <span class=n>res</span><span class=p>[</span><span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span><span class=p>]</span><span class=o>++</span><span class=p>;</span>
                <span class=n>j</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=k>while</span> <span class=p>(</span><span class=n>t</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span> <span class=o>&gt;</span> <span class=n>nums</span><span class=p>[</span><span class=n>t</span><span class=p>].</span><span class=n>first</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=n>t</span><span class=o>++</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>return</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_6_2 name=__tabbed_6 type=radio><label for=__tabbed_6_2>C++ more efficient Merge sort</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>countSmaller</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>vp</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>vp</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=n>mergeSort</span><span class=p>(</span><span class=n>vp</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span>
                <span class=kt>int</span> <span class=n>end</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>res</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
        <span class=n>mergeSort</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
        <span class=n>mergeSort</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>cache</span><span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>,</span> <span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>,</span> <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span> <span class=o>&amp;&amp;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span> <span class=o>&lt;=</span> <span class=n>x</span><span class=p>[</span><span class=n>j</span><span class=p>].</span><span class=n>first</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
                <span class=n>res</span><span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span><span class=p>]</span> <span class=o>+=</span> <span class=n>j</span> <span class=o>-</span> <span class=n>mid</span><span class=p>;</span>
                <span class=o>++</span><span class=n>i</span><span class=p>;</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>j</span><span class=o>++</span><span class=p>];</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>res</span><span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span><span class=p>]</span> <span class=o>+=</span> <span class=n>end</span> <span class=o>-</span> <span class=n>mid</span><span class=p>;</span>
            <span class=o>++</span><span class=n>i</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>while</span><span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>)</span>
            <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>j</span><span class=o>++</span><span class=p>];</span>

        <span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>,</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cache</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_6_3 name=__tabbed_6 type=radio><label for=__tabbed_6_3>C++ BST</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=k>class</span> <span class=nc>TreeNode</span> <span class=p>{</span>
    <span class=k>public</span><span class=o>:</span>
        <span class=kt>int</span> <span class=n>val</span><span class=p>,</span> <span class=n>smallerCnt</span><span class=p>;</span>
        <span class=n>TreeNode</span><span class=o>*</span> <span class=n>left</span><span class=p>,</span> <span class=o>*</span><span class=n>right</span><span class=p>;</span>
        <span class=n>TreeNode</span><span class=p>(</span><span class=kt>int</span> <span class=n>v</span><span class=p>,</span> <span class=kt>int</span> <span class=n>s</span><span class=p>)</span> <span class=o>:</span> <span class=n>left</span><span class=p>(</span><span class=nb>NULL</span><span class=p>),</span> <span class=n>right</span><span class=p>(</span><span class=nb>NULL</span><span class=p>),</span> <span class=n>val</span><span class=p>(</span><span class=n>v</span><span class=p>),</span> <span class=n>smallerCnt</span><span class=p>(</span><span class=n>s</span><span class=p>){}</span>
    <span class=p>};</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>countSmaller</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span><span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=p>{};</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>TreeNode</span><span class=o>*</span> <span class=n>root</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>

        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span>
            <span class=n>root</span> <span class=o>=</span> <span class=n>insert</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

<span class=k>private</span><span class=o>:</span>
    <span class=n>TreeNode</span><span class=o>*</span> <span class=n>insert</span><span class=p>(</span> <span class=n>TreeNode</span><span class=o>*</span> <span class=n>node</span><span class=p>,</span> <span class=kt>int</span> <span class=n>val</span><span class=p>,</span> <span class=kt>int</span> <span class=n>idx</span><span class=p>,</span> <span class=kt>int</span> <span class=n>preSum</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>res</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span><span class=p>(</span><span class=n>node</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>node</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeNode</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
            <span class=n>res</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>;</span>
        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>node</span><span class=o>-&gt;</span><span class=n>val</span> <span class=o>&gt;</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>node</span><span class=o>-&gt;</span><span class=n>smallerCnt</span><span class=o>++</span><span class=p>;</span>
            <span class=n>node</span><span class=o>-&gt;</span><span class=n>left</span> <span class=o>=</span> <span class=n>insert</span><span class=p>(</span><span class=n>node</span><span class=o>-&gt;</span><span class=n>left</span><span class=p>,</span> <span class=n>val</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>preSum</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
            <span class=n>node</span><span class=o>-&gt;</span><span class=n>right</span> <span class=o>=</span> <span class=n>insert</span><span class=p>(</span><span class=n>node</span><span class=o>-&gt;</span><span class=n>right</span><span class=p>,</span> <span class=n>val</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span>
                                <span class=n>preSum</span> <span class=o>+</span> <span class=n>node</span><span class=o>-&gt;</span><span class=n>smallerCnt</span> <span class=o>+</span> <span class=p>((</span><span class=n>node</span><span class=o>-&gt;</span><span class=n>val</span> <span class=o>&lt;</span> <span class=n>val</span><span class=p>)</span><span class=o>?</span> <span class=mi>1</span><span class=o>:</span> <span class=mi>0</span><span class=p>),</span> <span class=n>res</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>node</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=continuous-subarray-sum>Continuous Subarray Sum<a class=headerlink href=#continuous-subarray-sum title="Permanent link">&para;</a></h3> <p>Hash solution</p> <p>Once see a multiple of K, you should consider the modulor operation <code>%</code></p> <p>The values put into to the hash only for the first time, this is similar to the case in the problem Maximum Size Subarray Sum Equals k.</p> <div class=tabbed-set data-tabs=7:1><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><label for=__tabbed_7_1>C++ Hash soution" hl_lines="11</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>bool</span> <span class=n>checkSubarraySum</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>

        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>map</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>map</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>-1</span><span class=p>;</span> <span class=c1>// test case [0, 0], 0</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>k</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span>
                <span class=n>sum</span> <span class=o>=</span> <span class=n>sum</span> <span class=o>%</span> <span class=n>k</span><span class=p>;</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>sum</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>map</span><span class=p>[</span><span class=n>sum</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>map</span><span class=p>[</span><span class=n>sum</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=contiguous-array>Contiguous Array<a class=headerlink href=#contiguous-array title="Permanent link">&para;</a></h3> <p>Similar problems:</p> <ul> <li><a href=./#continuous-subarray-sum>Continuous Subarray Sum</a></li> <li><a href=./#maximum-size-subarray-sum-equals-k>Maximum Size Subarray Sum Equals k</a></li> </ul> <p>Hash solution</p> <p>This problem is very similar to the problem <a href=./#continuous-subarray-sum>Continuous Subarray Sum</a>. However, there is a trick to calculate the cummulative sum, treat <code>0</code> as <code>-1</code>.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>findMaxLength</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>map</span><span class=p>;</span>

        <span class=n>map</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>-1</span><span class=p>;</span> <span class=c1>// test case: [0, 1]</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>cnt</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>?</span> <span class=mi>-1</span> <span class=o>:</span> <span class=mi>1</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>cnt</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>i</span> <span class=o>-</span> <span class=n>map</span><span class=p>[</span><span class=n>cnt</span><span class=p>]);</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>map</span><span class=p>[</span><span class=n>cnt</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=split-array-with-equal-sum>Split Array with Equal Sum<a class=headerlink href=#split-array-with-equal-sum title="Permanent link">&para;</a></h3> <p>Cummulative sum soluiton</p> <p>Because of the symetric property of the head subarray and trailing subarray, we can calculate cumulative sum from both direction. This can help to fix the index <code>i</code> and <code>k</code>. we can enumerate the index <code>j</code> in between.</p> <div class=tabbed-set data-tabs=8:1><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><label for=__tabbed_8_1>C++ cummulateive sum solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>bool</span> <span class=n>splitArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>sum1</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>sum2</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

        <span class=n>sum1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum1</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=n>sum2</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum2</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum2</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=c1>// notice the index bounds</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>5</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>;</span> <span class=n>k</span> <span class=o>&gt;</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>;</span> <span class=n>k</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>sum1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>sum2</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>-</span> <span class=n>nums</span><span class=p>[</span><span class=n>k</span><span class=p>])</span> <span class=p>{</span>
                    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>sumij</span> <span class=o>=</span> <span class=n>sum1</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>nums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sum1</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
                        <span class=kt>int</span> <span class=n>sumjk</span> <span class=o>=</span> <span class=n>sum2</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>nums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sum2</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                        <span class=k>if</span> <span class=p>(</span><span class=n>sumij</span> <span class=o>==</span> <span class=n>sumjk</span><span class=p>)</span> <span class=p>{</span>
                            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=410-split-array-largest-sum>410. Split Array Largest Sum<a class=headerlink href=#410-split-array-largest-sum title="Permanent link">&para;</a></h3> <p>Similar problems:</p> <ul> <li><a href=./#copy-books-lintcode>Copy Books (linktcode)</a>.</li> </ul> <p>DP solution</p> <ul> <li>Notice the edge case: <code>[1, INT_MAX]</code>, use <code>double</code> can avoid integer overflow.</li> </ul> <p>Binary Search solution</p> <ul> <li>This is a greedy search solution that use binary search to accelerate the search speed</li> <li>The goal is to "minimize the largest sub-array sum". It is different from <a href=./#divide-chocolate>Divide Chocolate</a>, which is maximize the smallest sum.</li> <li>The bisection condition is not <code>A[m] &lt; target</code> any more. It is a function to check whether the constrain can meet given a guess value <code>mid</code>.</li> </ul> <div class=tabbed-set data-tabs=9:4><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><label for=__tabbed_9_1>C++ DP</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=cm>/**</span>
<span class=cm>* equivalent to the lintcode copy books problem</span>
<span class=cm>*</span>
<span class=cm>* last step: mth subarray A[j], ..., A[i - 1].</span>
<span class=cm>* State: f[m][n]: minmax sum of m subarrays that include n elements</span>
<span class=cm>* Equation: f[m][n] = min_{0&lt;=j&lt;n}(max(f[m - 1][j], sum(A[j], ..., A[n - 1])))</span>
<span class=cm>* Init: f[0][n] = INT_MAX;</span>
<span class=cm>*       f[0][0] = 0;</span>
<span class=cm>* NB: notice a special case: [1, 2147483247], 2</span>
<span class=cm>*     the sum will overflow in the state update, You use a double type  </span>
<span class=cm>*/</span>
<span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>splitArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>m</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>

        <span class=kt>double</span> <span class=n>f</span><span class=p>[</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
        <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>double</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>m</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span> <span class=c1>//j = i, mean sum = 0.</span>
                    <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>sum</span><span class=p>));</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                        <span class=n>sum</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>f</span><span class=p>[</span><span class=n>m</span><span class=p>][</span><span class=n>n</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_9_2 name=__tabbed_9 type=radio><label for=__tabbed_9_2>C++ binary search</label><div class=tabbed-content></div> <input id=__tabbed_9_3 name=__tabbed_9 type=radio><label for=__tabbed_9_3>C++ binary search (count the # of cuts)</label><div class=tabbed-content></div> <input id=__tabbed_9_4 name=__tabbed_9 type=radio><label for=__tabbed_9_4>C++ binary search alternative</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>splitArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>m</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=o>*</span><span class=n>max_element</span><span class=p>(</span><span class=n>nums</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span> <span class=n>nums</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
        <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>accumulate</span><span class=p>(</span><span class=n>nums</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span> <span class=n>nums</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span> <span class=mi>0</span><span class=p>);</span>

        <span class=k>while</span> <span class=p>(</span><span class=n>l</span> <span class=o>&lt;</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>l</span> <span class=o>+</span> <span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=n>l</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>

            <span class=c1>// count the possible cuts</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=nl>n</span> <span class=p>:</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=n>n</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// voilate the constrains</span>
                    <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                    <span class=n>c</span><span class=o>++</span><span class=p>;</span>
                <span class=p>}</span>
                <span class=n>s</span> <span class=o>+=</span> <span class=n>n</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>&gt;</span> <span class=n>m</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>l</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=c1>// the &quot;&gt; mid&quot; above guarantee the &quot;no greater than&quot;</span>
                <span class=c1>// the guess value, if c == m, mid could be the result</span>
                <span class=n>r</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>l</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=copy-books-lintcode>Copy books (lintcode)<a class=headerlink href=#copy-books-lintcode title="Permanent link">&para;</a></h3> <p>Description</p> <p>Given n books and the ith book has <code>A[i]</code> pages. You are given <code>k</code> people to copy the <code>n</code> books. the <code>n</code> books list in a row and each person can claim a continuous range of the <code>n</code> books. For example, one copier can copy the books from ith to jth continuously, but he can not copy the 1st book, 2nd book and 4th book (without the 3rd book).</p> <p>They start copying books at the same time and they all cost 1 minute to copy 1 page of a book. What's the best strategy to assign books so that the slowest copier can finish at the earliest time?</p> <p>Example</p> <p>Given array A = [3,2,4], k = 2. Return 5 (First person spends 5 minutes to copy book 1 and book 2 and the second person spends 4 minutes to copy book 3.)</p> <p>Solution 1 Binary search</p> <p>See the solution for <a href=#410-split-array-largest-sum>410. Split Array Largest Sum</a></p> <p>Solution 2 DP solution</p> <p>There are <code>i</code> books, consider the last copier, he can copy <code>A[j], ..., A[i-1]</code>. The first <code>k-1</code> copier copy <code>A[0], ..., A[j - 1]</code>.</p> <ul> <li>Define state: <code>f[k][i]</code>, meaning the k-th copier copy <code>i</code> books.</li> <li>State transition equation: <span><span class=MathJax_Preview>f[k][i] = \min_{0 \le j \le i} \max(f[k - 1][j], A[j] + ... + A[i - 1])</span><script type=math/tex>f[k][i] = \min_{0 \le j \le i} \max(f[k - 1][j], A[j] + ... + A[i - 1])</script></span></li> </ul> <div class=tabbed-set data-tabs=10:1><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><label for=__tabbed_10_1>C++ DP solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/**</span>
<span class=cm>    * last step: last copier copy A[j], ... A[i-1]</span>
<span class=cm>    * first k-1 copier --&gt; A[0], ... A[j - 1].</span>
<span class=cm>    * f[k][i]: k copier copy i books.</span>
<span class=cm>    * f[k][i] = \min_{0 \le j \le i} \max(f[k - 1][j], A[j] + ... + A[i - 1])</span>
<span class=cm>    */</span>
    <span class=kt>int</span> <span class=n>copyBooks</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>pages</span><span class=p>,</span> <span class=kt>int</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// write your code here</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>pages</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>K</span> <span class=o>&gt;</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>K</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>f</span><span class=p>[</span><span class=n>K</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>

        <span class=cm>/* init */</span>
        <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>K</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
<span class=hll>                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                    <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>sum</span><span class=p>));</span>
</span><span class=hll>                    <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                        <span class=n>sum</span> <span class=o>+=</span> <span class=n>pages</span><span class=p>[</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span><span class=hll>                    <span class=p>}</span>
</span><span class=hll>                <span class=p>}</span>
</span>            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>f</span><span class=p>[</span><span class=n>K</span><span class=p>][</span><span class=n>n</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>We have to enumerate the index <code>j</code>, the highlighted code used a clever technique to optimize this task. It enumerate <code>j</code> backwards. While this seems impossible at the first glance, how can you calculate the states from right to left in DP? Notice the index <code>j</code> is in the upper row (row <code>k-1</code>). Once we are in the <code>k</code>-th row, the values in the <code>k-1</code>-th row are all given.</p> </div> <h3 id=maximum-average-subarray-i>Maximum Average Subarray I<a class=headerlink href=#maximum-average-subarray-i title="Permanent link">&para;</a></h3> <p>Prefix sum solution</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>double</span> <span class=n>findMaxAverage</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>double</span> <span class=n>sums</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
        <span class=kt>double</span> <span class=n>max_avg</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=n>sums</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>double</span> <span class=n>avg</span> <span class=o>=</span> <span class=p>(</span><span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=n>k</span><span class=p>;</span>
            <span class=n>max_avg</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>max_avg</span><span class=p>,</span> <span class=n>avg</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>max_avg</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=maximum-average-subarray-ii>Maximum Average Subarray II<a class=headerlink href=#maximum-average-subarray-ii title="Permanent link">&para;</a></h3> <p>Prefix sum solution</p> <p>This is still a brute force solution.</p> <ul> <li>time complexity: <span><span class=MathJax_Preview>O(n^2)</span><script type=math/tex>O(n^2)</script></span></li> <li>space complexity: <span><span class=MathJax_Preview>O(n)</span><script type=math/tex>O(n)</script></span></li> </ul> <p>Space optimized solution</p> <ul> <li>We could avoid using the prefix sum array and only use two variables to record the prefix sum at any particular instance. One for record prefix sum of exact <code>k</code> elements. Another for the inner loop to check whether removing an element from the beginning will make a new maximum value or not.</li> </ul> <p>Space optimized solution</p> <ul> <li>We could avoid using the prefix sum array and only use two variables to record the prefix sum at any particular instance. One for record prefix sum of exact <code>k</code> elements. Another for the inner loop to check whether removing an element from the beginning will make a new maximum value or not.</li> </ul> <p>Deque solution</p> <div class=tabbed-set data-tabs=11:4><input checked=checked id=__tabbed_11_1 name=__tabbed_11 type=radio><label for=__tabbed_11_1>C++ prefix sum solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>double</span> <span class=n>findMaxAverage</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>sums</span> <span class=o>=</span> <span class=n>nums</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=kt>double</span> <span class=n>res</span> <span class=o>=</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span> <span class=n>sums</span><span class=p>[</span><span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>k</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>k</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>double</span> <span class=n>t</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>t</span> <span class=o>&gt;</span> <span class=n>res</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span> <span class=n>res</span> <span class=o>=</span> <span class=n>t</span> <span class=o>/</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>i</span> <span class=o>-</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>t</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>t</span> <span class=o>&gt;</span> <span class=n>res</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>j</span><span class=p>))</span> <span class=n>res</span> <span class=o>=</span> <span class=n>t</span> <span class=o>/</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>j</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_11_2 name=__tabbed_11 type=radio><label for=__tabbed_11_2>C++ space optimized</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>double</span> <span class=n>findMaxAverage</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=cm>/* range is half open */</span>
        <span class=kt>double</span> <span class=n>sumsAll</span> <span class=o>=</span> <span class=n>accumulate</span><span class=p>(</span><span class=n>nums</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span> <span class=n>nums</span><span class=p>.</span><span class=n>begin</span><span class=p>()</span> <span class=o>+</span> <span class=n>k</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=kt>double</span> <span class=n>sums</span> <span class=o>=</span> <span class=n>sumsAll</span><span class=p>,</span> <span class=n>res</span> <span class=o>=</span> <span class=n>sumsAll</span> <span class=o>/</span> <span class=n>k</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>k</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sumsAll</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>sums</span> <span class=o>=</span> <span class=n>sumsAll</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>sums</span> <span class=o>&gt;</span> <span class=n>res</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span> <span class=n>res</span> <span class=o>=</span> <span class=n>sums</span> <span class=o>/</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>i</span> <span class=o>-</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>sums</span> <span class=o>-=</span> <span class=n>nums</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>sums</span> <span class=o>&gt;</span> <span class=n>res</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>j</span><span class=p>))</span> <span class=n>res</span> <span class=o>=</span> <span class=n>sums</span> <span class=o>/</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>j</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_11_3 name=__tabbed_11 type=radio><label for=__tabbed_11_3>C++ binary search soluiton</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>double</span> <span class=n>findMaxAverage</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>double</span> <span class=n>upper</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>,</span> <span class=n>lower</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>num</span> <span class=p>:</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>upper</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>upper</span><span class=p>,</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>num</span><span class=p>);</span>
            <span class=n>lower</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>lower</span><span class=p>,</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>num</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>while</span> <span class=p>(</span><span class=n>lower</span> <span class=o>+</span> <span class=mf>0.00001</span> <span class=o>&lt;</span> <span class=n>upper</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>double</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>lower</span> <span class=o>+</span> <span class=p>(</span><span class=n>upper</span> <span class=o>-</span> <span class=n>lower</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>isLarger</span><span class=p>(</span><span class=n>nums</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>k</span><span class=p>))</span> <span class=p>{</span> <span class=c1>// is average value &gt;= mid?</span>
                <span class=n>lower</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>upper</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>lower</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=cm>/* return true if a greater average value is possible */</span>
    <span class=kt>bool</span> <span class=n>isLarger</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>double</span> <span class=n>mid</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>double</span> <span class=n>sums</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>prev</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>prev_min</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>k</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>mid</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>sums</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=cm>/*</span>
<span class=cm>        * we keep looking for whether a subarray sum of length &gt;= k in array</span>
<span class=cm>        * &quot;sums&quot; is possible to be greater than zero. If such a subarray exist,</span>
<span class=cm>        * it means that the target average value is greater than the &quot;mid&quot;</span>
<span class=cm>        * value. We look at the front part of sums that at least k element</span>
<span class=cm>        * apart from i. If we can find the minimum of the sums[0, 1, ..., i - k]</span>
<span class=cm>        * and check if sums[i] - min(sum[0, 1, ..., i - k]) &gt;= 0. If this is the</span>
<span class=cm>        * case, it indicate there exist a subarray of length &gt;= k with sum</span>
<span class=cm>        * greater than 0 in sums, we can return ture, otherwise, false.</span>
<span class=cm>        */</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>k</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>mid</span><span class=p>;</span>
            <span class=n>prev</span> <span class=o>+=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>k</span><span class=p>]</span> <span class=o>-</span> <span class=n>mid</span><span class=p>;</span>
            <span class=n>prev_min</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>prev_min</span><span class=p>,</span> <span class=n>prev</span><span class=p>);</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>sums</span> <span class=o>&gt;=</span> <span class=n>prev_min</span><span class=p>)</span>
                <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_11_4 name=__tabbed_11 type=radio><label for=__tabbed_11_4>C++ deque solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>double</span> <span class=n>findMaxAverage</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span> <span class=n>sums</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>deque</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>

        <span class=n>sums</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>

        <span class=kt>double</span> <span class=n>res</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=k>while</span><span class=p>(</span><span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>2</span> <span class=o>&amp;&amp;</span>
                <span class=n>density</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>q</span><span class=p>[</span><span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>2</span><span class=p>],</span> <span class=n>q</span><span class=p>.</span><span class=n>back</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&gt;=</span>
                <span class=n>density</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>q</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span> <span class=n>j</span> <span class=o>-</span> <span class=n>k</span><span class=p>))</span> <span class=p>{</span>

                <span class=n>q</span><span class=p>.</span><span class=n>pop_back</span><span class=p>();</span>
            <span class=p>}</span>

            <span class=n>q</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>j</span> <span class=o>-</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>

            <span class=k>while</span><span class=p>(</span><span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>2</span> <span class=o>&amp;&amp;</span>
                <span class=n>density</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>j</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=n>density</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>j</span><span class=p>))</span> <span class=p>{</span>

                <span class=n>q</span><span class=p>.</span><span class=n>pop_front</span><span class=p>();</span>
            <span class=p>}</span>

            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>density</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>(),</span> <span class=n>j</span><span class=p>));</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

<span class=k>private</span><span class=o>:</span>
    <span class=kt>double</span> <span class=n>density</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&amp;</span> <span class=n>sums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>l</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>sums</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>/</span> <span class=p>(</span><span class=n>r</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>

        <span class=k>return</span> <span class=p>(</span><span class=n>sums</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>l</span> <span class=o>-</span> <span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Notice the initial value of prev_min is set to 0 not INT_MAX; Try to understand why set the initial value of prev_min to INT_MAX cannot pass the test case: <code>[8,9,3,1,8,3,0,6,9,2]</code>, 8.</p> </div> <h3 id=range-sum-query-immutable>Range Sum Query - Immutable<a class=headerlink href=#range-sum-query-immutable title="Permanent link">&para;</a></h3> <p>Prefix sum solution</p> <p>Use prefix sum to record the accumulative sum of the array in the constructor. The algorithm is <span><span class=MathJax_Preview>O(n)</span><script type=math/tex>O(n)</script></span> in space and <span><span class=MathJax_Preview>O(1)</span><script type=math/tex>O(1)</script></span> in time.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumArray</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>sums</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>NumArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>sums</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>

        <span class=n>sums</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRange</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>};</span>
<span class=cm>/**</span>
<span class=cm> * Your NumArray object will be instantiated and called as such:</span>
<span class=cm> * NumArray obj = new NumArray(nums);</span>
<span class=cm> * int param_1 = obj.sumRange(i,j);</span>
<span class=cm> */</span>
</code></pre></div> <h3 id=range-sum-query-mutable>Range Sum Query - Mutable<a class=headerlink href=#range-sum-query-mutable title="Permanent link">&para;</a></h3> <p>Segment tree solution</p> <p>Using segment tree, the solution is given at <a href=https://leetcode.com/problems/range-sum-query-mutable/solution/ >Leetcode Solution</a>.</p> <div class=tabbed-set data-tabs=12:1><input checked=checked id=__tabbed_12_1 name=__tabbed_12 type=radio><label for=__tabbed_12_1>C++ segment tree</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumArray</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>tree</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>NumArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>tree</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span><span class=p>,</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>,</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>tree</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>tree</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>tree</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>tree</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>update</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>pos</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>left</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>right</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>tree</span><span class=p>[</span><span class=n>pos</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>pos</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>left</span> <span class=o>=</span> <span class=n>pos</span><span class=p>;</span>
            <span class=n>right</span> <span class=o>=</span> <span class=n>pos</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>pos</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>right</span> <span class=o>=</span> <span class=n>pos</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>pos</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>left</span> <span class=o>=</span> <span class=n>pos</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=n>tree</span><span class=p>[</span><span class=n>pos</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>tree</span><span class=p>[</span><span class=n>left</span><span class=p>]</span> <span class=o>+</span> <span class=n>tree</span><span class=p>[</span><span class=n>right</span><span class=p>];</span>
            <span class=n>pos</span> <span class=o>/=</span> <span class=mi>2</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRange</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>left</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>n</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>right</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>n</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>while</span> <span class=p>(</span><span class=n>left</span> <span class=o>&lt;=</span> <span class=n>right</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>left</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>sum</span> <span class=o>+=</span> <span class=n>tree</span><span class=p>[</span><span class=n>left</span><span class=p>];</span>
                <span class=n>left</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>right</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>sum</span> <span class=o>+=</span> <span class=n>tree</span><span class=p>[</span><span class=n>right</span><span class=p>];</span>
                <span class=n>right</span><span class=o>--</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=n>left</span> <span class=o>/=</span> <span class=mi>2</span><span class=p>;</span>
            <span class=n>right</span> <span class=o>/=</span> <span class=mi>2</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>sum</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm>* Your NumArray object will be instantiated and called as such:</span>
<span class=cm>* NumArray obj = new NumArray(nums);</span>
<span class=cm>* obj.update(i,val);</span>
<span class=cm>* int param_2 = obj.sumRange(i,j);</span>
<span class=cm>*/</span>
</code></pre></div> </div> </div> <p>Binary Indexed Tree solution I</p> <p>Using Binary indexed tree, we are able to solve it optimally in <span><span class=MathJax_Preview>O(\log n)</span><script type=math/tex>O(\log n)</script></span> . The solution originally from <a href=https://leetcode.com/problems/range-sum-query-mutable/discuss/75753/java-using-binary-indexed-tree-with-clear-explanation>here</a></p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumArray</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>arr</span><span class=p>;</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>BIT</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>NumArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>arr</span> <span class=o>=</span> <span class=n>nums</span><span class=p>;</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>BIT</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>init</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>i</span><span class=o>++</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>BIT</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>val</span><span class=p>;</span> <span class=c1>// BIT[i]  = nums[0, i - 1];</span>
            <span class=n>i</span> <span class=o>+=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>update</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>diff</span> <span class=o>=</span> <span class=n>val</span> <span class=o>-</span> <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>;</span>
        <span class=n>init</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>diff</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRange</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=nf>getSum</span><span class=p>(</span><span class=n>j</span><span class=p>)</span> <span class=o>-</span> <span class=n>getSum</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>getSum</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>i</span><span class=o>++</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>BIT</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>i</span> <span class=o>-=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>sum</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm> * Your NumArray object will be instantiated and called as such:</span>
<span class=cm> * NumArray obj = new NumArray(nums);</span>
<span class=cm> * obj.update(i,val);</span>
<span class=cm> * int param_2 = obj.sumRange(i,j);</span>
<span class=cm> */</span>
</code></pre></div> <p>Binary Indexed Tree solution II</p> <p>Similar to the above solution, We have combined the <code>init</code> and <code>update</code>. To make it consistant with the solution with problem <a href=#range-sum-query-2d-mutable>Range Sum Query 2D - Mutable</a></p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumArray</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>arr</span><span class=p>;</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>BIT</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>NumArray</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>nums</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>BIT</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>arr</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>update</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=cm>/* We can combine the init and update like this */</span>
    <span class=kt>void</span> <span class=n>update</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>diff</span> <span class=o>=</span> <span class=n>val</span> <span class=o>-</span> <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>;</span> <span class=c1>// here we initialize arr[i]</span>

        <span class=n>i</span><span class=o>++</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>BIT</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>diff</span><span class=p>;</span> <span class=c1>// BIT[i]  = nums[0, i - 1];</span>
            <span class=n>i</span> <span class=o>+=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRange</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=nf>getSum</span><span class=p>(</span><span class=n>j</span><span class=p>)</span> <span class=o>-</span> <span class=n>getSum</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>getSum</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>i</span><span class=o>++</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>BIT</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=n>i</span> <span class=o>-=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>i</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>sum</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm> * Your NumArray object will be instantiated and called as such:</span>
<span class=cm> * NumArray obj = new NumArray(nums);</span>
<span class=cm> * obj.update(i,val);</span>
<span class=cm> * int param_2 = obj.sumRange(i,j);</span>
<span class=cm> */</span>
</code></pre></div> <h3 id=range-sum-query-2d-immutable_1>Range Sum Query 2D - Immutable<a class=headerlink href=#range-sum-query-2d-immutable_1 title="Permanent link">&para;</a></h3> <p>Prefix sum solution</p> <p>Extended from the 1d array, we can use the prefix sum of the 2d matrix. we use extra space to store the accumulative sum of the submatrix with upper left coordinate <code>(0, 0)</code> and lower right coordinate <code>(i, j)</code>.</p> <div class=tabbed-set data-tabs=13:1><input checked=checked id=__tabbed_13_1 name=__tabbed_13 type=radio><label for=__tabbed_13_1>C++ prefix sum solution</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumMatrix</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>dp</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>NumMatrix</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>

        <span class=c1>//dp = vector&lt;vector&lt;int&gt; (m + 1, vector&lt;int&gt;(n + 1, 0));</span>
        <span class=n>dp</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>dp</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRegion</span><span class=p>(</span><span class=kt>int</span> <span class=n>row1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>row2</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col2</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>dp</span><span class=p>[</span><span class=n>row2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>col2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>dp</span><span class=p>[</span><span class=n>row2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>col1</span><span class=p>]</span> <span class=o>-</span> <span class=n>dp</span><span class=p>[</span><span class=n>row1</span><span class=p>][</span><span class=n>col2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>dp</span><span class=p>[</span><span class=n>row1</span><span class=p>][</span><span class=n>col1</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm> * Your NumMatrix object will be instantiated and called as such:</span>
<span class=cm> * NumMatrix obj = new NumMatrix(matrix);</span>
<span class=cm> * int param_1 = obj.sumRegion(row1,col1,row2,col2);</span>
<span class=cm> */</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This version create the <code>m + 1</code> by <code>n + 1</code> dp array to record the prefix sum. The code is clean and elegant.</p> </div> <p>Alternative prefix sum solution</p> <p>The idea is the same, in the following solution, we have a <code>m</code> by <code>n</code> 2d array to record the accumulative sum. See how complex the code is.</p> <div class=tabbed-set data-tabs=14:1><input checked=checked id=__tabbed_14_1 name=__tabbed_14 type=radio><label for=__tabbed_14_1>C++ prefix sum solution</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumMatrix</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dp</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>m</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>NumMatrix</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span><span class=p>;</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
        <span class=n>dp</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
                <span class=p>}</span>

                <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                <span class=p>}</span>

                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>-=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRegion</span><span class=p>(</span><span class=kt>int</span> <span class=n>row1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>row2</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col2</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>res</span> <span class=o>=</span> <span class=n>dp</span><span class=p>[</span><span class=n>row2</span><span class=p>][</span><span class=n>col2</span><span class=p>];</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>row1</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>res</span> <span class=o>-=</span> <span class=n>dp</span><span class=p>[</span><span class=n>row1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>col2</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>col1</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>res</span> <span class=o>-=</span> <span class=n>dp</span><span class=p>[</span><span class=n>row2</span><span class=p>][</span><span class=n>col1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>row1</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>col1</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=p>)</span> <span class=p>{</span>
            <span class=n>res</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>row1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>col1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm> * Your NumMatrix object will be instantiated and called as such:</span>
<span class=cm> * NumMatrix obj = new NumMatrix(matrix);</span>
<span class=cm> * int param_1 = obj.sumRegion(row1,col1,row2,col2);</span>
<span class=cm> */</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This version is a little complex. However, the way it was written reflects a very important practice when operating on a 2d array, that is: to check the validation of the array.</p> </div> <h3 id=range-sum-query-2d-mutable_1>Range Sum Query 2D - Mutable<a class=headerlink href=#range-sum-query-2d-mutable_1 title="Permanent link">&para;</a></h3> <p>Binary Indexed Tree solution</p> <p>We use 2D version of Binary Index Tree. Some of the explaination can be found at <a href=https://www.topcoder.com/community/competitive-programming/tutorials/binary-indexed-trees/ >Topcoder tutorial</a></p> <div class=tabbed-set data-tabs=15:1><input checked=checked id=__tabbed_15_1 name=__tabbed_15 type=radio><label for=__tabbed_15_1>C++ BIT solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>NumMatrix</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>nums</span><span class=p>;</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&gt;</span> <span class=n>tree</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>m</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>

<span class=k>public</span><span class=o>:</span>
    <span class=n>NumMatrix</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span><span class=p>;</span>
        <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>n</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>

        <span class=n>tree</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>nums</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>update</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>update</span><span class=p>(</span><span class=kt>int</span> <span class=n>row</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col</span><span class=p>,</span> <span class=kt>int</span> <span class=n>val</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>diff</span> <span class=o>=</span> <span class=n>val</span> <span class=o>-</span> <span class=n>nums</span><span class=p>[</span><span class=n>row</span><span class=p>][</span><span class=n>col</span><span class=p>];</span>
        <span class=n>nums</span><span class=p>[</span><span class=n>row</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>row</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>i</span><span class=p>))</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>col</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span> <span class=o>+=</span> <span class=n>j</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>j</span><span class=p>))</span> <span class=p>{</span>
                <span class=n>tree</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>diff</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>sumRegion</span><span class=p>(</span><span class=kt>int</span> <span class=n>row1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col1</span><span class=p>,</span> <span class=kt>int</span> <span class=n>row2</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col2</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>return</span> <span class=nf>getSum</span><span class=p>(</span><span class=n>row2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>col2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=n>getSum</span><span class=p>(</span><span class=n>row1</span><span class=p>,</span> <span class=n>col2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=n>getSum</span><span class=p>(</span><span class=n>row2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>col1</span><span class=p>)</span> <span class=o>+</span> <span class=n>getSum</span><span class=p>(</span><span class=n>row1</span><span class=p>,</span> <span class=n>col1</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>getSum</span><span class=p>(</span><span class=kt>int</span> <span class=n>row</span><span class=p>,</span> <span class=kt>int</span> <span class=n>col</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>row</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>-=</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>i</span><span class=p>))</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>col</span><span class=p>;</span> <span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>-=</span> <span class=n>j</span> <span class=o>&amp;</span> <span class=p>(</span><span class=o>-</span><span class=n>j</span><span class=p>))</span> <span class=p>{</span>
                <span class=n>sum</span> <span class=o>+=</span> <span class=n>tree</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>sum</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm>* Your NumMatrix object will be instantiated and called as such:</span>
<span class=cm>* NumMatrix obj = new NumMatrix(matrix);</span>
<span class=cm>* obj.update(row,col,val);</span>
<span class=cm>* int param_2 = obj.sumRegion(row1,col1,row2,col2);</span>
<span class=cm>*/</span>
</code></pre></div> </div> </div> <h3 id=count-of-range-sum>Count of Range Sum<a class=headerlink href=#count-of-range-sum title="Permanent link">&para;</a></h3> <p>Solution 1 Merge sort using <code>inplace_merge()</code></p> <ol> <li>The core is to figure out how to calculate the result while merging. It is based on the fact that the left half and right half are all sorted. Using the ordering information we are able to locate two points in the right half <code>j</code> and <code>k</code>, between which will fulfill the requirement.</li> <li>Several important points need to be made. 1) calculation of prefix sum of the array. The length is <code>n + 1</code> not <code>n</code>? 2) the range passed to the merge subroutine are open-end <code>[start, end)</code>.</li> <li>The base case of the subrouine. It return zero becuase the case has been counted in the for loop, we don't need to count it again. Not because the base case is <code>0</code>.</li> </ol> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countRangeSum</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>lower</span><span class=p>,</span> <span class=kt>int</span> <span class=n>upper</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span><span class=o>&gt;</span> <span class=n>sums</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>

        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>

        <span class=k>return</span> <span class=nf>mergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span><span class=o>&gt;&amp;</span> <span class=n>sums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span> <span class=kt>int</span> <span class=n>end</span><span class=p>,</span> <span class=kt>int</span> <span class=n>lower</span><span class=p>,</span> <span class=kt>int</span> <span class=n>upper</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span><span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// note the meaning of this 0.</span>

        <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
        <span class=n>count</span> <span class=o>=</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=p>)</span>
                <span class=o>+</span> <span class=n>mergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>,</span> <span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=p>);</span>

        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>while</span><span class=p>(</span><span class=n>m</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>m</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>lower</span><span class=p>)</span> <span class=n>m</span><span class=o>++</span><span class=p>;</span>
            <span class=k>while</span><span class=p>(</span><span class=n>n</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>upper</span><span class=p>)</span> <span class=n>n</span><span class=o>++</span><span class=p>;</span>
            <span class=n>count</span> <span class=o>+=</span> <span class=n>n</span> <span class=o>-</span> <span class=n>m</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>inplace_merge</span><span class=p>(</span><span class=n>sums</span><span class=p>.</span><span class=n>begin</span><span class=p>()</span> <span class=o>+</span> <span class=n>start</span><span class=p>,</span> <span class=n>sums</span><span class=p>.</span><span class=n>begin</span><span class=p>()</span> <span class=o>+</span> <span class=n>mid</span><span class=p>,</span> <span class=n>sums</span><span class=p>.</span><span class=n>begin</span><span class=p>()</span> <span class=o>+</span> <span class=n>end</span><span class=p>);</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>Solution 2 Merge sort using tmp buffer cache</p> <ol> <li>Here is how the count is making sense.</li> </ol> <div class=highlight><pre><span></span><code>       |--------------|-------------------|
sums:  |start         |mid                |end
       |---|----------|------|------|-----|
           i                 j      k
Because sums[j] - sums[i] &gt;= lower, and sums[k] - sums[i] &gt; upper,
So for the subarray start with i, ending index in [j, k), the range
sum is in [lower, upper]. Notice k should not be included.
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countRangeSum</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>nums</span><span class=p>,</span> <span class=kt>int</span> <span class=n>lower</span><span class=p>,</span> <span class=kt>int</span> <span class=n>upper</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>long</span> <span class=n>sums</span><span class=p>[</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=cm>/* n + 1 is the one pass the last element of sums */</span>
        <span class=k>return</span> <span class=n>countByMergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=cm>/* This function will return sorted array sums[start], ... sums[end - 1] */</span>
    <span class=kt>int</span> <span class=n>countByMergeSort</span><span class=p>(</span><span class=kt>long</span> <span class=n>sums</span><span class=p>[],</span> <span class=kt>int</span> <span class=n>start</span><span class=p>,</span> <span class=kt>int</span> <span class=n>end</span><span class=p>,</span> <span class=kt>int</span> <span class=n>lower</span><span class=p>,</span> <span class=kt>int</span> <span class=n>upper</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=n>countByMergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=p>)</span>
                    <span class=o>+</span> <span class=n>countByMergeSort</span><span class=p>(</span><span class=n>sums</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>end</span><span class=p>,</span> <span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=p>);</span>

        <span class=kt>long</span> <span class=n>cache</span><span class=p>[</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

        <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=n>mid</span><span class=p>,</span> <span class=n>t</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mid</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>,</span> <span class=o>++</span><span class=n>r</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>k</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>lower</span><span class=p>)</span> <span class=n>k</span><span class=o>++</span><span class=p>;</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>-</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>upper</span><span class=p>)</span> <span class=n>j</span><span class=o>++</span><span class=p>;</span>

            <span class=n>count</span> <span class=o>+=</span> <span class=n>j</span> <span class=o>-</span> <span class=n>k</span><span class=p>;</span> <span class=cm>/* calculate the result */</span>

            <span class=cm>/* Merge left and right to get sorted array {sums[start], .. sums[end - 1]}.</span>
<span class=cm>             * Because left part of sums[start] to sums[mid] are already sorted,</span>
<span class=cm>             * use cache here to merge prefix of the right part: sum[mid] to sums[t]</span>
<span class=cm>             * with left part upto sums[i] for all i = {start, mid - 1}. */</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>t</span> <span class=o>&lt;</span> <span class=n>end</span> <span class=o>&amp;&amp;</span> <span class=n>sums</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                <span class=n>cache</span><span class=p>[</span><span class=n>r</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>t</span><span class=o>++</span><span class=p>];</span>

            <span class=n>cache</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>

        <span class=p>}</span> <span class=cm>/* after this for loop, cache will have partially sorted array</span>
<span class=cm>           * cache = sums_left = {sums[start], ... sums[t - 1]} element</span>
<span class=cm>           * of which will be in their final sorted positions.</span>
<span class=cm>           * array sums_right = {sums[t], sums[end - 1]} is also</span>
<span class=cm>           * in their final sorted positions. */</span>

        <span class=cm>/* Since the sums_left is sorted, it have size of t - start,</span>
<span class=cm>         * here we copy exactly t - start element from cache to sums.</span>
<span class=cm>         */</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>t</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
            <span class=n>sums</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>start</span><span class=p>];</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>Solution 3 BST</p> <p>Solution 4 BIT</p> <h3 id=maximum-sum-of-two-non-overlapping-subarrays>Maximum Sum of Two Non-Overlapping Subarrays<a class=headerlink href=#maximum-sum-of-two-non-overlapping-subarrays title="Permanent link">&para;</a></h3> <div class=tabbed-set data-tabs=16:3><input checked=checked id=__tabbed_16_1 name=__tabbed_16 type=radio><label for=__tabbed_16_1>Brute Force Iterate</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSumTwoNoOverlap</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>A</span><span class=p>,</span> <span class=kt>int</span> <span class=n>L</span><span class=p>,</span> <span class=kt>int</span> <span class=n>M</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>L</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>M</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>preSum</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>preSum</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>preSum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=c1>// iterate the L using index i</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=n>L</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>Lsum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>Lsum</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>Lsum</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=kt>int</span> <span class=n>Msum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=c1>// iterate the left M array using index j</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>i</span> <span class=o>-</span> <span class=n>M</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                <span class=p>}</span>
                <span class=n>Msum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>Msum</span><span class=p>,</span> <span class=n>tmp</span><span class=p>);</span>
            <span class=p>}</span>
            <span class=c1>// iterate the right M array using index j</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>L</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=n>M</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>Msum</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>Msum</span><span class=p>,</span> <span class=n>preSum</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
            <span class=p>}</span>

            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>Msum</span> <span class=o>+</span> <span class=n>Lsum</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_16_2 name=__tabbed_16 type=radio><label for=__tabbed_16_2>One pass</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxSumTwoNoOverlap</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>A</span><span class=p>,</span> <span class=kt>int</span> <span class=n>L</span><span class=p>,</span> <span class=kt>int</span> <span class=n>M</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>L</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>M</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>preSum</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>preSum</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>preSum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>Lmax</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>Mmax</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>
        <span class=c1>//</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>L</span> <span class=o>+</span> <span class=n>M</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>// L is front, M is back</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=n>L</span> <span class=o>+</span> <span class=n>M</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>Lmax</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>Lmax</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>Lmax</span><span class=p>,</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>L</span> <span class=o>-</span> <span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
            <span class=p>}</span>
            <span class=c1>// M is front, L is back</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=n>L</span> <span class=o>+</span> <span class=n>M</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>Mmax</span> <span class=o>=</span> <span class=n>preSum</span><span class=p>[</span><span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>Mmax</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>Mmax</span><span class=p>,</span> <span class=n>preSum</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>M</span> <span class=o>-</span> <span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
            <span class=p>}</span>

            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>({</span><span class=n>res</span><span class=p>,</span>
                    <span class=n>Lmax</span> <span class=o>+</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>M</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span>
                    <span class=n>Mmax</span> <span class=o>+</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>preSum</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]})</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_16_3 name=__tabbed_16 type=radio><label for=__tabbed_16_3>DP solution</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code><span class=c1>//TODO</span>
</code></pre></div> <h3 id=maximum-sum-of-3-non-overlapping-subarrays>Maximum Sum of 3 Non-Overlapping Subarrays<a class=headerlink href=#maximum-sum-of-3-non-overlapping-subarrays title="Permanent link">&para;</a></h3> <h3 id=longest-substring-without-repeating-characters><a href=../../string/notes/#longest-substring-without-repeating-characters>Longest Substring Without Repeating Characters</a><a class=headerlink href=#longest-substring-without-repeating-characters title="Permanent link">&para;</a></h3> <h3 id=longest-substring-with-at-most-two-distinct-characters><a href=../../string/notes/#longest-substring-with-at-most-two-distinct-characters>Longest Substring with At Most Two Distinct Characters</a><a class=headerlink href=#longest-substring-with-at-most-two-distinct-characters title="Permanent link">&para;</a></h3> <h3 id=longest-substring-with-at-most-k-distinct-characters><a href=../../string/notes/#longest-substring-with-at-most-k-distinct-characters>Longest Substring with At Most K Distinct Characters</a><a class=headerlink href=#longest-substring-with-at-most-k-distinct-characters title="Permanent link">&para;</a></h3> <h3 id=subarrays-with-k-different-integers>Subarrays with K Different Integers<a class=headerlink href=#subarrays-with-k-different-integers title="Permanent link">&para;</a></h3> <ul> <li>If you use sliding window to solve this problem, there are lots of corner cases.</li> <li>for example: <code>[1, 1, 2, 1, 2, 1, 3, 1], K = 2</code>, how can you ensure you count all the subarray?</li> <li>Remember this trick that you can use the <code>atMostKDistinct(A, K) - atMostKDistinct(A, K - 1)</code>.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>subarraysWithKDistinct</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>A</span><span class=p>,</span> <span class=kt>int</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=nf>subarrayWithAtMostKDistinct</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>K</span><span class=p>)</span>
                 <span class=o>-</span> <span class=n>subarrayWithAtMostKDistinct</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>K</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=n>subarrayWithAtMostKDistinct</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>A</span><span class=p>,</span> <span class=kt>int</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span> <span class=n>count</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>();</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>count</span><span class=p>[</span><span class=n>A</span><span class=p>[</span><span class=n>j</span><span class=p>]]</span><span class=o>++</span><span class=p>)</span> <span class=n>K</span><span class=o>--</span><span class=p>;</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>k</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=o>!--</span><span class=n>count</span><span class=p>[</span><span class=n>A</span><span class=p>[</span><span class=n>j</span><span class=p>]])</span> <span class=n>K</span><span class=o>++</span><span class=p>;</span>
                <span class=n>i</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=n>res</span> <span class=o>+=</span> <span class=n>j</span> <span class=o>-</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=number-of-substrings-containing-all-three-characters>Number of Substrings Containing All Three Characters<a class=headerlink href=#number-of-substrings-containing-all-three-characters title="Permanent link">&para;</a></h3> <h3 id=count-number-of-nice-subarrays>Count Number of Nice Subarrays<a class=headerlink href=#count-number-of-nice-subarrays title="Permanent link">&para;</a></h3> <h3 id=replace-the-substring-for-balanced-string>Replace the Substring for Balanced String<a class=headerlink href=#replace-the-substring-for-balanced-string title="Permanent link">&para;</a></h3> <h3 id=binary-subarrays-with-sum>Binary Subarrays With Sum<a class=headerlink href=#binary-subarrays-with-sum title="Permanent link">&para;</a></h3> <h3 id=fruit-into-baskets>Fruit Into Baskets<a class=headerlink href=#fruit-into-baskets title="Permanent link">&para;</a></h3> <h3 id=shortest-subarray-with-sum-at-least-k>Shortest Subarray with Sum at Least K<a class=headerlink href=#shortest-subarray-with-sum-at-least-k title="Permanent link">&para;</a></h3> <h3 id=minimum-size-subarray-sum_1><a href=#minimum-size-subarray-sum>Minimum Size Subarray Sum</a><a class=headerlink href=#minimum-size-subarray-sum_1 title="Permanent link">&para;</a></h3> <h3 id=substring-with-concatenation-of-all-words>Substring with Concatenation of All Words<a class=headerlink href=#substring-with-concatenation-of-all-words title="Permanent link">&para;</a></h3> <h3 id=max-consecutive-ones-ii>Max Consecutive Ones II<a class=headerlink href=#max-consecutive-ones-ii title="Permanent link">&para;</a></h3> <h3 id=max-consecutive-ones-iii>Max Consecutive Ones III<a class=headerlink href=#max-consecutive-ones-iii title="Permanent link">&para;</a></h3> <h2 id=category-4-k-sum-problems>Category 4 K Sum problems<a class=headerlink href=#category-4-k-sum-problems title="Permanent link">&para;</a></h2> <h3 id=two-sum>Two Sum<a class=headerlink href=#two-sum title="Permanent link">&para;</a></h3> <h3 id=two-sum-ii-input-array-is-sorted>Two Sum II - Input array is sorted<a class=headerlink href=#two-sum-ii-input-array-is-sorted title="Permanent link">&para;</a></h3> <h3 id=two-sum-iii-data-structure-design>Two Sum III - Data structure design<a class=headerlink href=#two-sum-iii-data-structure-design title="Permanent link">&para;</a></h3> <h3 id=two-sum-iv-input-is-a-bst>Two Sum IV - Input is a BST<a class=headerlink href=#two-sum-iv-input-is-a-bst title="Permanent link">&para;</a></h3> <h3 id=3sum>3Sum<a class=headerlink href=#3sum title="Permanent link">&para;</a></h3> <h3 id=3sum-closest>3Sum Closest<a class=headerlink href=#3sum-closest title="Permanent link">&para;</a></h3> <h3 id=3sum-smaller>3Sum Smaller<a class=headerlink href=#3sum-smaller title="Permanent link">&para;</a></h3> <h3 id=4sum>4Sum<a class=headerlink href=#4sum title="Permanent link">&para;</a></h3> <h3 id=4sum-ii>4Sum II<a class=headerlink href=#4sum-ii title="Permanent link">&para;</a></h3> <h3 id=k-sum>K Sum<a class=headerlink href=#k-sum title="Permanent link">&para;</a></h3> <h3 id=target-sum>Target Sum<a class=headerlink href=#target-sum title="Permanent link">&para;</a></h3> <h2 id=cagegory-5-2d-arry-matrix-grid-problems>Cagegory 5 2D arry (matrix, grid) problems<a class=headerlink href=#cagegory-5-2d-arry-matrix-grid-problems title="Permanent link">&para;</a></h2> <h3 id=perfect-rectangle>Perfect Rectangle<a class=headerlink href=#perfect-rectangle title="Permanent link">&para;</a></h3> <h3 id=trapping-rain-water>Trapping Rain Water<a class=headerlink href=#trapping-rain-water title="Permanent link">&para;</a></h3> <h3 id=trapping-rain-water-ii>Trapping Rain Water II<a class=headerlink href=#trapping-rain-water-ii title="Permanent link">&para;</a></h3> <h3 id=container-with-most-water>Container With Most Water<a class=headerlink href=#container-with-most-water title="Permanent link">&para;</a></h3> <h3 id=largest-rectangle-in-histogram>Largest Rectangle in Histogram<a class=headerlink href=#largest-rectangle-in-histogram title="Permanent link">&para;</a></h3> <h3 id=maximal-rectangle_1>Maximal Rectangle<a class=headerlink href=#maximal-rectangle_1 title="Permanent link">&para;</a></h3> <h3 id=maximal-square_1>Maximal Square<a class=headerlink href=#maximal-square_1 title="Permanent link">&para;</a></h3> <h3 id=the-skyline-problem>The Skyline Problem<a class=headerlink href=#the-skyline-problem title="Permanent link">&para;</a></h3> <h3 id=smallest-rectangle-enclosing-black-pixels>Smallest Rectangle Enclosing Black Pixels<a class=headerlink href=#smallest-rectangle-enclosing-black-pixels title="Permanent link">&para;</a></h3> <h3 id=rectangle-area>Rectangle Area<a class=headerlink href=#rectangle-area title="Permanent link">&para;</a></h3> <h3 id=max-sum-of-rectangle-no-larger-than-k_1><a href=#max-sum-of-rectangle-no-larger-than-k>Max Sum of Rectangle No Larger Than K</a><a class=headerlink href=#max-sum-of-rectangle-no-larger-than-k_1 title="Permanent link">&para;</a></h3> <h2 id=category-6-stock-buying-problems>Category 6 stock buying problems<a class=headerlink href=#category-6-stock-buying-problems title="Permanent link">&para;</a></h2> <p><a href=https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/discuss/108870/Most-consistent-ways-of-dealing-with-the-series-of-stock-problems>Most consistent ways of dealing with the series of stock problems</a></p> <h3 id=121-best-time-to-buy-and-sell-stock>121. Best Time to Buy and Sell Stock<a class=headerlink href=#121-best-time-to-buy-and-sell-stock title="Permanent link">&para;</a></h3> <p>Solution 1 O(n) one pass to find the minimum and in the meantime, find the max profit.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxProfit</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>prices</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>prices</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>low</span> <span class=o>=</span> <span class=n>prices</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>prices</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>low</span><span class=p>);</span>
            <span class=n>low</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>low</span><span class=p>,</span> <span class=n>prices</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=122-best-time-to-buy-and-sell-stock-ii>122. Best Time to Buy and Sell Stock II<a class=headerlink href=#122-best-time-to-buy-and-sell-stock-ii title="Permanent link">&para;</a></h3> <p>Solution 1 Greedy since you can buy as many times as you can</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxProfit</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>prices</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>prices</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>prices</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>prices</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>res</span> <span class=o>+=</span> <span class=n>prices</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>prices</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <h3 id=123-best-time-to-buy-and-sell-stock-iii>123. Best Time to Buy and Sell Stock III<a class=headerlink href=#123-best-time-to-buy-and-sell-stock-iii title="Permanent link">&para;</a></h3> <p>You can now buy at most twice. how to max the profit.</p> <p>Solution 1 Dynamic programming</p> <ul> <li>5 stages: 1. before buy the first &lt;-- optimal solution could be at this stage 2. hold the first 3. sell the first &lt;-- or at this stage, only bought once, 4. hold the second 5. sell the second &lt;-- or at this stage, bought twice.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>maxProfit</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>A</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>//1, 3, 5:</span>
        <span class=c1>// f[i][j] = max{f[i - 1][j], f[i - 1][j - 1] + A[i - 1] - A[i - 2]}</span>
        <span class=c1>// 2, 4:</span>
        <span class=c1>// f[i][j] = max{f[i - 1][j] + A[i - 1] - A[i - 2],</span>
        <span class=c1>//               f[i - 1][j - 1], f[i - 1][j - 2] + A[i - 1] - A[i - 2]}</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>f</span><span class=p>[</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>][</span><span class=mi>6</span><span class=p>];</span>

        <span class=cm>/* init */</span>
        <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=n>INT_MIN</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=mi>5</span><span class=p>;</span> <span class=n>j</span> <span class=o>+=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>j</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]);</span>
                <span class=p>}</span>

            <span class=p>}</span>

            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=n>j</span> <span class=o>+=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]);</span>
                <span class=p>}</span>

                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>j</span> <span class=o>&gt;</span> <span class=mi>2</span> <span class=o>&amp;&amp;</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=mi>1</span><span class=p>],</span> <span class=n>max</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=mi>3</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=mi>5</span><span class=p>]));</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>Solution 2</p> <p>Use <code>T[i][k][j]</code> to represent the maximum profit of first i days if we allow at most k transactions and the current number of stocks at hand is <code>j</code> (<code>j == 0, 1</code> because hold two stocks at the same time is not allowed). So we have:</p> <div class=highlight><pre><span></span><code>T[i][2][0] = max(T[i - 1][2][0], T[i - 1][2][1] + prices[i - 1]);
T[i][2][1] = max(T[i - 1][2][1], T[i - 1][1][0] - prices[i - 1]);
T[i][1][0] = max(T[i - 1][1][0], T[i - 1][1][1] + prices[i - 1]);
T[i][1][1] = max(T[i - 1][1][1], T[i - 1][0][0] - prices[i - 1]);
</code></pre></div> <p>Think: How to ensure you fourmular to cover all the possible values?</p> <h3 id=188-best-time-to-buy-and-sell-stock-iv>188. Best Time to Buy and Sell Stock IV<a class=headerlink href=#188-best-time-to-buy-and-sell-stock-iv title="Permanent link">&para;</a></h3> <h3 id=309-best-time-to-buy-and-sell-stock-with-cooldown>309. Best Time to Buy and Sell Stock with Cooldown<a class=headerlink href=#309-best-time-to-buy-and-sell-stock-with-cooldown title="Permanent link">&para;</a></h3> <h3 id=714-best-time-to-buy-and-sell-stock-with-transaction-fee>714. Best Time to Buy and Sell Stock with Transaction Fee<a class=headerlink href=#714-best-time-to-buy-and-sell-stock-with-transaction-fee title="Permanent link">&para;</a></h3> <h3 id=determine-the-buy-data-and-sell-data-of-maximum-profit-dd-139>Determine the buy data and sell data of maximum profit (DD 139)<a class=headerlink href=#determine-the-buy-data-and-sell-data-of-maximum-profit-dd-139 title="Permanent link">&para;</a></h3> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../../ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Index </div> </div> </a> <a href=../../backtracking/notes/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Backtracking </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Rui Han </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/vendor.93c04032.min.js></script> <script src=../../../assets/javascripts/bundle.83e5331e.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>