<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://ruihan.org/leetcode/breadth-first-search/notes/ rel=canonical><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.0.2"><title>Breadth-First Search (BFS) - RUIHAN.ORG</title><link rel=stylesheet href=../../../assets/stylesheets/main.38780c08.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.3f72e892.min.css><meta name=theme-color content=#000000><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=black> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#breadth-first-search class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://ruihan.org title=RUIHAN.ORG class="md-header-nav__button md-logo" aria-label=RUIHAN.ORG> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> RUIHAN.ORG </span> <span class="md-header-nav__topic md-ellipsis"> Breadth-First Search (BFS) </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../books/ class=md-tabs__link> Books </a> </li> <li class=md-tabs__item> <a href=../../../courses/ class=md-tabs__link> Courses </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Leetcode </a> </li> <li class=md-tabs__item> <a href=../../../research/ class=md-tabs__link> Research </a> </li> <li class=md-tabs__item> <a href=../../../seedlabs/ class=md-tabs__link> SEED Labs </a> </li> <li class=md-tabs__item> <a href=../../../system-design/ class=md-tabs__link> System Design </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://ruihan.org title=RUIHAN.ORG class="md-nav__button md-logo" aria-label=RUIHAN.ORG> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> RUIHAN.ORG </label> <div class=md-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Books <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Books data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"></span> Books </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../books/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../books/accelerated-cpp/notes/ class=md-nav__link> Accelerated C++ </a> </li> <li class=md-nav__item> <a href=../../../books/mining-massive-datasets/notes/ class=md-nav__link> Mining Massive Datasets </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Courses <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Courses data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"></span> Courses </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../courses/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../courses/machine-learning-coursera/notes/ class=md-nav__link> Machine Learning (Coursera) </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/lec-notes/ class=md-nav__link> CS224N Lecture Notes </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/write-up/ class=md-nav__link> CS224N Write-up </a> </li> <li class=md-nav__item> <a href=../../../courses/coursera-dl4-cnn/notes/ class=md-nav__link> Convolutional Neural Networks </a> </li> <li class=md-nav__item> <a href=../../../courses/mining-massive-datasets/notes/ class=md-nav__link> Mining Massive Data Sets </a> </li> <li class=md-nav__item> <a href=../../../courses/6.431-probability/notes/ class=md-nav__link> 6.431 Probability </a> </li> <li class=md-nav__item> <a href=../../../courses/learning-from-data/notes.md class=md-nav__link> Learning From Data </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-algorithms/notes/ class=md-nav__link> Nine Chapter Algorithms </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-system-design/notes/ class=md-nav__link> Nine Chapter System Design </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-dynamic-prog/notes/ class=md-nav__link> Nine Chapter Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../../courses/func-prog-in-scala/notes/ class=md-nav__link> Functional Programming Principles in Scala </a> </li> <li class=md-nav__item> <a href=../../../courses/applied-scrum-for-agile/notes/ class=md-nav__link> Applied Scrum for Agile Project Management </a> </li> <li class=md-nav__item> <a href=../../../courses/concurrent-prog-java/notes/ class=md-nav__link> Concurrent Programming in Java </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4 checked> <label class=md-nav__link for=nav-4> Leetcode <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Leetcode data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"></span> Leetcode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../favorite/notes/ class=md-nav__link> Favorite </a> </li> <li class=md-nav__item> <a href=../../array/notes/ class=md-nav__link> Array </a> </li> <li class=md-nav__item> <a href=../../backtracking/notes/ class=md-nav__link> Backtracking </a> </li> <li class=md-nav__item> <a href=../../binary-search/notes/ class=md-nav__link> Binary Search </a> </li> <li class=md-nav__item> <a href=../../binary-indexed-tree/notes/ class=md-nav__link> Binary Indexed Tree </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Breadth-First Search (BFS) <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Breadth-First Search (BFS) </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#algorithm class=md-nav__link> Algorithm </a> </li> <li class=md-nav__item> <a href=#bfs-properties class=md-nav__link> BFS properties </a> </li> <li class=md-nav__item> <a href=#search class=md-nav__link> Search </a> <nav class=md-nav aria-label=Search> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze class=md-nav__link> The Maze </a> </li> <li class=md-nav__item> <a href=#the-maze-ii class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#the-maze-iii class=md-nav__link> The Maze III </a> </li> <li class=md-nav__item> <a href=#pacific-atlantic-water-flow class=md-nav__link> Pacific Atlantic Water Flow </a> </li> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#walls-and-gates class=md-nav__link> Walls and Gates </a> </li> <li class=md-nav__item> <a href=#01-matrix class=md-nav__link> 01 Matrix </a> </li> <li class=md-nav__item> <a href=#surrounded-regions class=md-nav__link> Surrounded Regions </a> </li> <li class=md-nav__item> <a href=#best-meeting-point class=md-nav__link> Best Meeting Point </a> </li> <li class=md-nav__item> <a href=#number-of-islands class=md-nav__link> Number of Islands </a> </li> <li class=md-nav__item> <a href=#battleships-in-a-board class=md-nav__link> Battleships in a Board </a> </li> <li class=md-nav__item> <a href=#bus-routes class=md-nav__link> Bus Routes </a> </li> <li class=md-nav__item> <a href=#word-ladder class=md-nav__link> Word Ladder </a> </li> <li class=md-nav__item> <a href=#minimum-genetic-mutation class=md-nav__link> Minimum Genetic Mutation </a> </li> <li class=md-nav__item> <a href=#word-ladder-ii class=md-nav__link> Word Ladder II </a> </li> <li class=md-nav__item> <a href=#open-the-lock class=md-nav__link> Open the Lock </a> </li> <li class=md-nav__item> <a href=#evaluate-devision class=md-nav__link> Evaluate Devision </a> </li> <li class=md-nav__item> <a href=#399-evaluate-division class=md-nav__link> 399. Evaluate Division </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-shortest-path-for-undirected-graphs class=md-nav__link> Compute shortest path for undirected graphs </a> <nav class=md-nav aria-label="Compute shortest path for undirected graphs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze-ii_1 class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#shortest-distance-from-all-buildings class=md-nav__link> Shortest Distance from All Buildings </a> </li> <li class=md-nav__item> <a href=#shortest-path-visiting-all-nodes class=md-nav__link> Shortest Path Visiting All Nodes </a> </li> <li class=md-nav__item> <a href=#shortest-path-to-get-all-keys class=md-nav__link> Shortest Path to Get All Keys </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-connected-components-for-undirected-graphs class=md-nav__link> Compute connected components for undirected graphs </a> <nav class=md-nav aria-label="Compute connected components for undirected graphs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix_1 class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#number-of-connected-components-in-an-undirected-graph class=md-nav__link> Number of Connected Components in an Undirected Graph </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bfs-topological-sorting class=md-nav__link> BFS Topological sorting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../depth-first-search/notes/ class=md-nav__link> Depth-First Search (DFS) </a> </li> <li class=md-nav__item> <a href=../../dynamic-programming/notes/ class=md-nav__link> Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../graph/notes/ class=md-nav__link> Graph </a> </li> <li class=md-nav__item> <a href=../../heap/notes/ class=md-nav__link> Heap </a> </li> <li class=md-nav__item> <a href=../../interval/notes/ class=md-nav__link> Interval </a> </li> <li class=md-nav__item> <a href=../../linked-list/notes/ class=md-nav__link> Linked List </a> </li> <li class=md-nav__item> <a href=../../math/notes/ class=md-nav__link> Math </a> </li> <li class=md-nav__item> <a href=../../reservoir-sampling/notes/ class=md-nav__link> Reservoir Sampling </a> </li> <li class=md-nav__item> <a href=../../stack/notes/ class=md-nav__link> Stack </a> </li> <li class=md-nav__item> <a href=../../string/notes/ class=md-nav__link> String </a> </li> <li class=md-nav__item> <a href=../../tree/notes/ class=md-nav__link> Tree </a> </li> <li class=md-nav__item> <a href=../../trie/notes/ class=md-nav__link> Trie </a> </li> <li class=md-nav__item> <a href=../../union-find/notes/ class=md-nav__link> Union Find </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Research <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Research data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"></span> Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../research/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../research/paper-reading/notes/ class=md-nav__link> Paper Reading </a> </li> <li class=md-nav__item> <a href=../../../research/coalition-game/notes/ class=md-nav__link> Coalition Game </a> </li> <li class=md-nav__item> <a href=../../../research/contextual-bandit/notes/ class=md-nav__link> Contextual Multi-Armed Bandit </a> </li> <li class=md-nav__item> <a href=../../../research/tfidf-score/notes/ class=md-nav__link> TF-IDF for Information Retrieval </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> SEED Labs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SEED Labs" data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"></span> SEED Labs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../seedlabs/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/applied-crypto/notes/ class=md-nav__link> Applied Cryptograph Notes </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/public-key-cryptography-and-pki/notes/ class=md-nav__link> Public Key Cryptography and PKI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> System Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="System Design" data-md-level=1> <label class=md-nav__title for=nav-7> <span class="md-nav__icon md-icon"></span> System Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../system-design/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../system-design/browser/notes.md class=md-nav__link> How Browser Works </a> </li> <li class=md-nav__item> <a href=../../../system-design/concurrency/notes/ class=md-nav__link> Concurrency and Synchronization </a> </li> <li class=md-nav__item> <a href=../../../system-design/concepts/notes/ class=md-nav__link> Distributed System Concepts </a> </li> <li class=md-nav__item> <a href=../../../system-design/patterns/notes/ class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/crawler/notes/ class=md-nav__link> How to Design Crawler </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/tinyurl/notes/ class=md-nav__link> How to Design TinyUrl </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/twitter/notes/ class=md-nav__link> How to Design Twitter </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/scheduler/notes/ class=md-nav__link> How to Deisgn Scheduler </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/ticketmaster/notes/ class=md-nav__link> How to Design Ticketmaster </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#algorithm class=md-nav__link> Algorithm </a> </li> <li class=md-nav__item> <a href=#bfs-properties class=md-nav__link> BFS properties </a> </li> <li class=md-nav__item> <a href=#search class=md-nav__link> Search </a> <nav class=md-nav aria-label=Search> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze class=md-nav__link> The Maze </a> </li> <li class=md-nav__item> <a href=#the-maze-ii class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#the-maze-iii class=md-nav__link> The Maze III </a> </li> <li class=md-nav__item> <a href=#pacific-atlantic-water-flow class=md-nav__link> Pacific Atlantic Water Flow </a> </li> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#walls-and-gates class=md-nav__link> Walls and Gates </a> </li> <li class=md-nav__item> <a href=#01-matrix class=md-nav__link> 01 Matrix </a> </li> <li class=md-nav__item> <a href=#surrounded-regions class=md-nav__link> Surrounded Regions </a> </li> <li class=md-nav__item> <a href=#best-meeting-point class=md-nav__link> Best Meeting Point </a> </li> <li class=md-nav__item> <a href=#number-of-islands class=md-nav__link> Number of Islands </a> </li> <li class=md-nav__item> <a href=#battleships-in-a-board class=md-nav__link> Battleships in a Board </a> </li> <li class=md-nav__item> <a href=#bus-routes class=md-nav__link> Bus Routes </a> </li> <li class=md-nav__item> <a href=#word-ladder class=md-nav__link> Word Ladder </a> </li> <li class=md-nav__item> <a href=#minimum-genetic-mutation class=md-nav__link> Minimum Genetic Mutation </a> </li> <li class=md-nav__item> <a href=#word-ladder-ii class=md-nav__link> Word Ladder II </a> </li> <li class=md-nav__item> <a href=#open-the-lock class=md-nav__link> Open the Lock </a> </li> <li class=md-nav__item> <a href=#evaluate-devision class=md-nav__link> Evaluate Devision </a> </li> <li class=md-nav__item> <a href=#399-evaluate-division class=md-nav__link> 399. Evaluate Division </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-shortest-path-for-undirected-graphs class=md-nav__link> Compute shortest path for undirected graphs </a> <nav class=md-nav aria-label="Compute shortest path for undirected graphs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze-ii_1 class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#shortest-distance-from-all-buildings class=md-nav__link> Shortest Distance from All Buildings </a> </li> <li class=md-nav__item> <a href=#shortest-path-visiting-all-nodes class=md-nav__link> Shortest Path Visiting All Nodes </a> </li> <li class=md-nav__item> <a href=#shortest-path-to-get-all-keys class=md-nav__link> Shortest Path to Get All Keys </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-connected-components-for-undirected-graphs class=md-nav__link> Compute connected components for undirected graphs </a> <nav class=md-nav aria-label="Compute connected components for undirected graphs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix_1 class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#number-of-connected-components-in-an-undirected-graph class=md-nav__link> Number of Connected Components in an Undirected Graph </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bfs-topological-sorting class=md-nav__link> BFS Topological sorting </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=breadth-first-search>Breadth-First Search<a class=headerlink href=#breadth-first-search title="Permanent link">&para;</a></h1> <h2 id=algorithm>Algorithm<a class=headerlink href=#algorithm title="Permanent link">&para;</a></h2> <p>BFS search a graph by first explore all the vertices that are adjacent to the source vertex <code>s</code>, then explore the adjacent vertices of those already examined in layer-by-layer fashion until all the vertices are visited.</p> <div class=tabbed-set data-tabs=1:1><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>The psudo code</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code>BFS (graph G, start vertex s)
[ all nodes initially unexplored ]
-- mark s as explored
-- let Q = queue data structure, initialized with s
-- while Q not empty:
    -- remove the first node of Q, call it v
    -- for each edge(v,w) :
        -- if w unexplored
            -- mark w as explored
            -- add w to Q (at the end)
</code></pre></div> <h2 id=bfs-properties>BFS properties<a class=headerlink href=#bfs-properties title="Permanent link">&para;</a></h2> <ol> <li>Runtime complexity <span><span class=MathJax_Preview>\Theta(|V| + |E|)</span><script type=math/tex>\Theta(|V| + |E|)</script></span>.</li> <li>It calculate <strong>shortest path</strong> from the source <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to the vertex <span><span class=MathJax_Preview>v</span><script type=math/tex>v</script></span>.</li> <li>It build a breadth-first tree, CLRS called predecessor subgraph.</li> <li>If edge <span><span class=MathJax_Preview>(u, v)</span><script type=math/tex>(u, v)</script></span> in the BFS tree, the simple path from source vertext <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to <span><span class=MathJax_Preview>u</span><script type=math/tex>u</script></span> is equal to the simple path from <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to <span><span class=MathJax_Preview>v</span><script type=math/tex>v</script></span>, or differ by 1.</li> <li>Simple path from a source vertex <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to a destination vertex <span><span class=MathJax_Preview>v</span><script type=math/tex>v</script></span> is equal to the laterâ€™s <strong>level label</strong>.</li> <li>If <span><span class=MathJax_Preview>v_1, v_2, \cdots, v_n</span><script type=math/tex>v_1, v_2, \cdots, v_n</script></span> is the vertex enqueued in a certain point, <span><span class=MathJax_Preview>v_1</span><script type=math/tex>v_1</script></span> is the head and <span><span class=MathJax_Preview>v_n</span><script type=math/tex>v_n</script></span> is the back, then the level label of <span><span class=MathJax_Preview>v_1</span><script type=math/tex>v_1</script></span> is either equal to level label of <span><span class=MathJax_Preview>v_n</span><script type=math/tex>v_n</script></span> or less by 1. Also the level label of all the vertices in the queue is non-decreasing from head to tail. <strong>In other words, at a certain time the enqueued vertices at most comes from two different levels.</strong></li> </ol> <h2 id=search>Search<a class=headerlink href=#search title="Permanent link">&para;</a></h2> <ol> <li>unweighted edges</li> <li>Bi-directional search, (Speed up Dijkastra of 6.006)</li> <li>At all time, the level of nodes in queue at most differ by 1</li> <li>The relationship between BFS and DFS (The Maze II)</li> </ol> <div class="admonition note"> <p class=admonition-title>BFS tips for board and grid problems</p> <ol> <li>When push a pair of coordinate to a BFS queue, one way of doing it is using <code>pair&lt;int, int&gt;</code>. Another way is to convert to a number by <code>p = i * n + j</code>, and retrieve the coordinate by <code>i = p / n</code> and <code>j = p % n</code>.</li> <li>The BFS starting point and "target" are important, give a second thought about where should the search start and how it terminate.</li> <li><code>visitted[m][n]</code> is not necessary sometimes. See whether you can modify the original borad/matrix/grid/maze to reflect whether the element has already been accessed or not.</li> <li>In a borad or maze like input, searching neighbor cells requires you to manipulate indexes for accessing its neighbors. We do this by defining two "offset" coordinates arrays. <code>int x[4] = {-1, 0, 1, 0}; int y[4] = {0, 1, 0, -1};</code></li> <li>The BFS queue doesn't necessarily start with one element pushed. It could be <strong>"multi-end" BFS</strong>. Like in problme <a href=#pacific-atlantic-water-flow>Pacific Atlantic Water Flow</a> and <a href=#longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix</a>, one could init the queue with all possible starting node then in use a while to visit all the node towards finding the optimal path.</li> <li>The "multi-end" BFS not only can make the BFS level by level (each round of for loop visited one level of nodes), but also can make use some optimal feature of BFS, like the BFS solution of Walls and Gates.</li> <li>The BFS while loop could include another while loop to interate throught total <code>q.size()</code> nodes. This is different from the "oracle" BFS solution from CRLS, but sometime could be useful. For example: <a href=#longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix</a>.</li> </ol> </div> <h3 id=the-maze>The Maze<a class=headerlink href=#the-maze title="Permanent link">&para;</a></h3> <div class=tabbed-set data-tabs=2:1><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><label for=__tabbed_2_1>DFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>bool</span> <span class=n>hasPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>

        <span class=k>return</span> <span class=nf>dfs_helper</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>destination</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span>
                    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;&amp;</span> <span class=n>visited</span><span class=p>)</span> <span class=p>{</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=kt>bool</span> <span class=n>res</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>

            <span class=c1>// walk untill hit the wall</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size90</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>new_start</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]});</span>
                <span class=n>res</span> <span class=o>!=</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>new_start</span><span class=p>,</span> <span class=n>destination</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <p>=== "BFS"</p> <div class=highlight><pre><span></span><code>```c++
class Solution {
public:
    bool hasPath(vector&lt;vector&lt;int&gt;&gt;&amp;maze, vector&lt;int&gt;&amp; start, vector&lt;int&gt;&amp; destination) {
        int m = maze.size();
        int n = m ? maze[0].size() : 0;

        vector&lt;vector&lt;bool&gt;&gt; visited(m, vector&lt;bool&gt;(n, false));
        queue&lt;vector&lt;int&gt;&gt; q;
        q.push(start);

        int x[4] = {0, -1, 0, 1};
        int y[4] = {-1, 0, 1, 0};

        while (!q.empty()) {
            vector&lt;int&gt; s = q.front(); q.pop();

            if (s[0] == destination[0] &amp;&amp; s[1] == destination[1]) {
                return true;
            }

            for (int k = 0; k &lt; 4; k++) {
                int a = s[0] + x[k];
                int b = s[1] + y[k];

                while (a &gt;= 0 &amp;&amp; b &gt;= 0 &amp;&amp; a &lt; m &amp;&amp; b &lt; n &amp;&amp; maze[a][b] == 0) {
                    a += x[k];
                    b += y[k];
                }

                if (!visited[a - x[k]][b - y[k]]) {
                    q.push(vector&lt;int&gt;({a - x[k], b - y[k]}));
                    visited[a - x[k]][b - y[k]] = true;
                }
            }
        }

        return false;
    }
};
```
</code></pre></div> <h3 id=the-maze-ii>The Maze II<a class=headerlink href=#the-maze-ii title="Permanent link">&para;</a></h3> <ul> <li>BFS can computer shortest path, we need additional memory to keep the optimal values.</li> <li>we update the corresponding destination cell in <code>distance</code> vector when we found a smaller distane can reach it from any direction. the final result will be in <code>distance[destination[0]][destination[1]]</code>.</li> <li>If we don't want to use so much memory, we can use a flag to mark when the BFS switch levels.</li> <li>This solution is essentially to use BFS to solve the weighted graph problem as Victor mentioned in 6006 R15.</li> <li>Compare this solution to the Dijkastra solution. The update distance matrix is essentially the relaxiation step.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>shortestDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>distance</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>INT_MAX</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>start</span><span class=p>);</span>
        <span class=n>distance</span><span class=p>[</span><span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>

            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=c1>// notice here is a optimize</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>&lt;</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span> <span class=cm>/* could use emplace({a - x[k], b - y[k]}) */</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>distance</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=mi>-1</span> <span class=o>:</span> <span class=n>distance</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <ul> <li>Based on the BFS solution, we can use a priority queue. Then the problem is very similar to the Dijkastra algorithm.</li> <li>The discussion about the improvement in leetcode forum is very interesting.</li> </ul> </div> <h3 id=the-maze-iii>The Maze III<a class=headerlink href=#the-maze-iii title="Permanent link">&para;</a></h3> <ul> <li>This problem is aksing for output the shortest path to reach the destination.</li> <li>The idea is to use a <code>distance[i][i]</code> and <code>result[i][j]</code>. we should keep update the <code>distance[i][j]</code> and <code>result[i][j]</code> with smaller distance and lexicographical order. The hardest part is that there is two constrains. While using BFS, How could we ensure the two constrains are met, and also we are not missing any possible path. (i.e. missed to push a path to the BFS queue.)</li> <li>A trick we can make use of is we searching in the lexicographically order. such as <code>down</code>, <code>left</code>, <code>right</code>, <code>up</code>. However, we face a problem: the <strong>smallest lexicon order result may not be the shortest distance</strong>. Think this through.</li> <li>We need to used additional memory to record that piece of information beside the memory used to keep the minimum distance.</li> </ul> <div class=tabbed-set data-tabs=3:3><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><label for=__tabbed_3_1>BFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>string</span> <span class=n>findShortestWay</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>distance</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>INT_MAX</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;&gt;</span> <span class=n>result</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>start</span><span class=p>);</span>
        <span class=n>distance</span><span class=p>[</span><span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>char</span> <span class=n>path</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=sc>&#39;d&#39;</span><span class=p>,</span> <span class=sc>&#39;l&#39;</span><span class=p>,</span> <span class=sc>&#39;r&#39;</span><span class=p>,</span> <span class=sc>&#39;u&#39;</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>

            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=cm>/* continue if no wall */</span>
                <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=cm>/* run over the destination */</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>a</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]){</span>
                        <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>&lt;</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>])</span> <span class=p>{</span>
                            <span class=n>distance</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span><span class=p>;</span>
                            <span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>==</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>])</span> <span class=p>{</span>
                            <span class=n>string</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=cm>/* same distance, smaller lexicon */</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>compare</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>])</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                                <span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                    <span class=p>}</span>

                    <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=cm>/* hit a wall, have to retreat &quot;0&quot;, current a, b is in wall or off maze */</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>&lt;</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span><span class=p>;</span>
                    <span class=n>result</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span>
                <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>==</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>string</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
<span class=hll>                    <span class=cm>/* same distance, smaller lexicon */</span>
</span>                    <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>compare</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                        <span class=n>result</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
                        <span class=cm>/* possible path, need to search it again */</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>distance</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=s>&quot;impossible&quot;</span> <span class=o>:</span> <span class=n>result</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_3_2 name=__tabbed_3 type=radio><label for=__tabbed_3_2>DFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>string</span> <span class=n>findShortestWay</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>ball</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>hole</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=nf>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>ball</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ball</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>,</span> <span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>()</span> <span class=o>=</span> <span class=p>{</span><span class=s>&quot;impossible&quot;</span><span class=p>,</span> <span class=n>INT_MAX</span><span class=p>});</span>
    <span class=p>}</span>

    <span class=n>string</span> <span class=n>roll</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=kt>int</span> <span class=n>rowBall</span><span class=p>,</span> <span class=kt>int</span> <span class=n>colBall</span><span class=p>,</span> <span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>hole</span><span class=p>,</span>
                <span class=kt>int</span> <span class=n>distRow</span><span class=p>,</span> <span class=kt>int</span> <span class=n>distCol</span><span class=p>,</span> <span class=kt>int</span> <span class=n>steps</span><span class=p>,</span> <span class=k>const</span> <span class=n>string</span><span class=o>&amp;</span> <span class=n>path</span><span class=p>,</span> <span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>res</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>steps</span> <span class=o>&lt;</span> <span class=n>res</span><span class=p>.</span><span class=n>second</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>distRow</span> <span class=o>!=</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>distCol</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>while</span> <span class=p>((</span><span class=n>rowBall</span> <span class=o>+</span> <span class=n>distRow</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>rowBall</span> <span class=o>+</span> <span class=n>distRow</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&amp;&amp;</span>
                    <span class=p>(</span><span class=n>colBall</span> <span class=o>+</span> <span class=n>distCol</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>colBall</span> <span class=o>+</span> <span class=n>distCol</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>&amp;&amp;</span>
                    <span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span> <span class=o>+</span> <span class=n>distRow</span><span class=p>][</span><span class=n>colBall</span> <span class=o>+</span> <span class=n>distCol</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>

                    <span class=n>rowBall</span> <span class=o>+=</span> <span class=n>distRow</span><span class=p>;</span>
                    <span class=n>colBall</span> <span class=o>+=</span> <span class=n>distCol</span><span class=p>;</span>
                    <span class=o>++</span><span class=n>steps</span><span class=p>;</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>rowBall</span> <span class=o>==</span> <span class=n>hole</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>colBall</span> <span class=o>==</span> <span class=n>hole</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>steps</span> <span class=o>&lt;</span> <span class=n>res</span><span class=p>.</span><span class=n>second</span><span class=p>)</span> <span class=p>{</span>
                        <span class=n>res</span> <span class=o>=</span> <span class=p>{</span><span class=n>path</span><span class=p>,</span> <span class=n>steps</span><span class=p>};</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span><span class=p>][</span><span class=n>colBall</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>steps</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span><span class=p>][</span><span class=n>colBall</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span><span class=p>][</span><span class=n>colBall</span><span class=p>]</span> <span class=o>=</span> <span class=n>steps</span> <span class=o>+</span> <span class=mi>2</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distRow</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;d&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distCol</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;l&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distCol</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;r&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distRow</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;u&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>.</span><span class=n>first</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_3_3 name=__tabbed_3 type=radio><label for=__tabbed_3_3>Dijkstra algoirthm</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Vertex</span>
<span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>dist</span><span class=p>;</span>
    <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>path</span><span class=p>;</span>
    <span class=n>Vertex</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dist</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>path</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>dist</span> <span class=o>=</span> <span class=n>dist</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>path</span> <span class=o>=</span> <span class=n>path</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>Vertex</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>dist</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>path</span> <span class=o>=</span> <span class=s>&quot;&quot;</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>bool</span> <span class=n>equals</span><span class=p>(</span><span class=n>Vertex</span> <span class=n>v</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>==</span> <span class=n>v</span><span class=p>.</span><span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>==</span> <span class=n>v</span><span class=p>.</span><span class=n>y</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>bool</span> <span class=n>equals</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>==</span> <span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>==</span> <span class=n>y</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>

<span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=c1>// coordinates and path strings for the four directions.</span>
    <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>directions</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>
    <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>paths</span> <span class=o>=</span> <span class=p>{</span><span class=s>&quot;u&quot;</span><span class=p>,</span> <span class=s>&quot;r&quot;</span><span class=p>,</span> <span class=s>&quot;d&quot;</span><span class=p>,</span> <span class=s>&quot;l&quot;</span><span class=p>};</span>
    <span class=c1>// can&#39;t roll if it&#39;s boundry, wall or hole.</span>
    <span class=kt>bool</span> <span class=nf>canRoll</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=o>&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>Vertex</span> <span class=n>hole</span><span class=p>,</span> <span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>(),</span> <span class=n>n</span> <span class=o>=</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>y</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>maze</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>hole</span><span class=p>.</span><span class=n>equals</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>);</span>
        <span class=k>else</span>
            <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=n>Vertex</span> <span class=nf>roll</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=o>&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>Vertex</span> <span class=n>curr</span><span class=p>,</span> <span class=n>Vertex</span> <span class=n>hole</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dx</span><span class=p>,</span>
                <span class=kt>int</span> <span class=n>dy</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>path</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=n>curr</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>curr</span><span class=p>.</span><span class=n>y</span><span class=p>,</span> <span class=n>steps</span> <span class=o>=</span> <span class=n>curr</span><span class=p>.</span><span class=n>dist</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>canRoll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=n>x</span> <span class=o>+</span> <span class=n>dx</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>dy</span><span class=p>))</span>
        <span class=p>{</span>
            <span class=n>x</span> <span class=o>+=</span> <span class=n>dx</span><span class=p>;</span>
            <span class=n>y</span> <span class=o>+=</span> <span class=n>dy</span><span class=p>;</span>
            <span class=n>steps</span><span class=o>++</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=c1>// if couldn&#39;t roll due to hole, then return vertex corresponding to the hole.</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>hole</span><span class=p>.</span><span class=n>equals</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>dx</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>dy</span><span class=p>))</span>
        <span class=p>{</span>
            <span class=n>x</span> <span class=o>+=</span> <span class=n>dx</span><span class=p>;</span>
            <span class=n>y</span> <span class=o>+=</span> <span class=n>dy</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=n>Vertex</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>curr</span><span class=p>.</span><span class=n>path</span> <span class=o>+</span> <span class=n>path</span><span class=p>);</span>
    <span class=p>}</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/*</span>
<span class=cm>    * to form a pq based on the increasing order of distances, and if same</span>
<span class=cm>    * distance then sorting based on lexicographic order.</span>
<span class=cm>    */</span>
    <span class=k>struct</span> <span class=nc>Compare</span>
    <span class=p>{</span>
        <span class=kt>bool</span> <span class=nf>operator</span><span class=p>()(</span><span class=k>const</span> <span class=n>Vertex</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>Vertex</span> <span class=o>&amp;</span><span class=n>b</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=k>return</span> <span class=n>a</span><span class=p>.</span><span class=n>dist</span> <span class=o>&gt;</span> <span class=n>b</span><span class=p>.</span><span class=n>dist</span> <span class=o>||</span> <span class=n>a</span><span class=p>.</span><span class=n>dist</span> <span class=o>==</span> <span class=n>b</span><span class=p>.</span><span class=n>dist</span> <span class=o>&amp;&amp;</span> <span class=n>a</span><span class=p>.</span><span class=n>path</span> <span class=o>&gt;</span> <span class=n>b</span><span class=p>.</span><span class=n>path</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>};</span>
    <span class=cm>/*</span>
<span class=cm>    * Applying Dijkstra&#39;s algorithm here.</span>
<span class=cm>    * We treat hole as a gate here. The trick is look for holes while rolling</span>
<span class=cm>    * the back in a particular direction. So, the pq here contains the vertices</span>
<span class=cm>    * before gates as well as the holes. So, using dijkstra, when we pop a hole</span>
<span class=cm>    * from pq, we know its that.</span>
<span class=cm>    */</span>
    <span class=n>string</span> <span class=nf>findShortestWay</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>ball</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>hole</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>(),</span> <span class=n>n</span> <span class=o>=</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
        <span class=n>std</span><span class=o>::</span><span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=o>&gt;</span><span class=p>,</span> <span class=n>Compare</span><span class=o>&gt;</span> <span class=n>pq</span><span class=p>;</span>
        <span class=n>Vertex</span> <span class=n>startVertex</span><span class=p>(</span><span class=n>ball</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ball</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>),</span> <span class=n>holeVertex</span><span class=p>(</span><span class=n>hole</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>hole</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
        <span class=n>std</span><span class=o>::</span><span class=n>unordered_set</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>;</span>
        <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>startVertex</span><span class=p>);</span>
        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span>
        <span class=p>{</span>
            <span class=n>Vertex</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>();</span>
            <span class=n>visited</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>curr</span><span class=p>.</span><span class=n>x</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>curr</span><span class=p>.</span><span class=n>y</span><span class=p>);</span>
            <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>curr</span><span class=p>.</span><span class=n>equals</span><span class=p>(</span><span class=n>holeVertex</span><span class=p>))</span>
            <span class=p>{</span>
                <span class=k>return</span> <span class=n>curr</span><span class=p>.</span><span class=n>path</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>directions</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
            <span class=p>{</span>
                <span class=n>Vertex</span> <span class=n>newStart</span> <span class=o>=</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>curr</span><span class=p>,</span> <span class=n>holeVertex</span><span class=p>,</span> <span class=n>directions</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>directions</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>visited</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>newStart</span><span class=p>.</span><span class=n>x</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>newStart</span><span class=p>.</span><span class=n>y</span><span class=p>)</span> <span class=o>==</span> <span class=n>visited</span><span class=p>.</span><span class=n>end</span><span class=p>())</span>
                    <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>newStart</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=s>&quot;impossible&quot;</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=pacific-atlantic-water-flow>Pacific Atlantic Water Flow<a class=headerlink href=#pacific-atlantic-water-flow title="Permanent link">&para;</a></h3> <ul> <li>Using DFS and two matrices to record the states and then to loop through the result check for both possible flow cases.</li> <li>The key is how to start the DFS? should we initiate the DFS in each <code>(i, j)</code>? Here we can see it is more efficient if that we start from the edges. Notice we mark <code>visited[i][j] = true</code> immediately enter the helper function.</li> </ul> <div class=tabbed-set data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><label for=__tabbed_4_1>DFS solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>pacificAtlantic</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>p_visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>a_visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>res</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>p_visited</span><span class=p>);</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>a_visited</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>p_visited</span><span class=p>);</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>a_visited</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>p_visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>a_visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
                    <span class=c1>//res.push_back(pair&lt;int, int&gt;(i, j));</span>
                    <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>helper</span> <span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>mat</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>visited</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>mat</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>mat</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span> <span class=cm>/* visite mat[i][j] first */</span>
        <span class=cm>/* and then explore its neighbors */</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>p</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>q</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>mat</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>helper</span><span class=p>(</span><span class=n>mat</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_4_2 name=__tabbed_4 type=radio><label for=__tabbed_4_2>BFS solution</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>pacificAtlantic</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>vPacific</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>vAtlantic</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>qPacific</span><span class=p>;</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>qAtlantic</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>qPacific</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=mi>0</span><span class=p>});</span>
            <span class=n>vPacific</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
            <span class=n>qAtlantic</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>});</span>
            <span class=n>vAtlantic</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>qPacific</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=mi>0</span><span class=p>,</span> <span class=n>i</span><span class=p>});</span>
            <span class=n>vPacific</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
            <span class=n>qAtlantic</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>i</span><span class=p>});</span>
            <span class=n>vAtlantic</span><span class=p>[</span><span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>bfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>qPacific</span><span class=p>,</span> <span class=n>vPacific</span><span class=p>);</span>
        <span class=n>bfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>qAtlantic</span><span class=p>,</span> <span class=n>vAtlantic</span><span class=p>);</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>res</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>vPacific</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>vAtlantic</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
                    <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>bfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>q</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;&amp;</span> <span class=n>visited</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>

                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>||</span> <span class=n>matrix</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Notice your terminate condition <code>matrix[a][b] &gt; matrix[u][v]</code> in the DFS solution indicates your search direction cannot not go from high to low. The search direction is from low to high (or equal). This is to optimize the search since we don't have to revisite a node later.</p> </div> <h3 id=longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix<a class=headerlink href=#longest-increasing-path-in-a-matrix title="Permanent link">&para;</a></h3> <p>BFS solution</p> <ul> <li>Each cell should possibly be the starting cell of the longest increasing path. So we have to search starting from each one of the cells. It seems the running time is quadratic. How to optimize?</li> <li>use markers matrix to mark whether the <code>matrix[i][j]</code> have greater neighbors, <code>left</code>, <code>top</code>, <code>right</code>, <code>bottom</code> -&gt; 1, 2, 4, 8.</li> <li>The do BFS only looking for the directions that have greater neighbors. The idea is very similar to the "branch cutting" in DFS.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>longestIncreasingPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>markers</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>p</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&gt;=</span> <span class=n>m</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span>
                        <span class=n>markers</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>k</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>level</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>markers</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>level</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
                        <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>%</span> <span class=n>n</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                        <span class=kt>bool</span> <span class=n>flag</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>m</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>has_greater_neighbor</span><span class=p>(</span><span class=n>markers</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>],</span> <span class=n>k</span><span class=p>))</span> <span class=p>{</span>
                                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>v</span><span class=p>);</span>
                                <span class=k>if</span> <span class=p>(</span><span class=n>flag</span><span class=p>)</span> <span class=p>{</span>
                                    <span class=n>level</span><span class=o>++</span><span class=p>;</span>
                                    <span class=n>flag</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
                                <span class=p>}</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>level</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>bool</span> <span class=n>has_greater_neighbor</span><span class=p>(</span><span class=kt>int</span> <span class=n>flags</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=p>(</span><span class=n>flags</span> <span class=o>&gt;&gt;</span> <span class=n>k</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>BFS solution II</p> <ul> <li>BFS can find the shortest path. How can you use BFS to find the longest path? In this problem, we are not use BFS's shortest path properpy, we make use of BFS's property of finding the connected components. We can imagine each increasing path is a connected component, we need to find out the largest one. Notice how the solution construct the search structure (for loop inside the while loop).</li> <li>By construct the search structure in this way, the len is actually the level of nodes from all the peaks identified in the first nested for loops.</li> </ul> <div class=tabbed-set data-tabs=5:1><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><label for=__tabbed_5_1>Java BFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kd>class</span> <span class=nc>Solution</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>longestIncreasingPath</span><span class=p>(</span><span class=kt>int</span><span class=o>[][]</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>private</span> <span class=kd>final</span> <span class=kt>int</span><span class=o>[][]</span> <span class=n>dirs</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>},{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>}};</span>
        <span class=kd>private</span> <span class=kt>boolean</span> <span class=nf>ispeak</span><span class=p>(</span><span class=kt>int</span><span class=o>[][]</span> <span class=n>matrix</span><span class=p>,</span> <span class=kt>boolean</span><span class=o>[][]</span> <span class=n>marked</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=p>.</span><span class=na>length</span><span class=o>-</span><span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span><span class=o>-</span><span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=kd>public</span> <span class=kt>int</span> <span class=nf>longestIncreasingPath</span><span class=p>(</span><span class=kt>int</span><span class=o>[][]</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=p>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=n>LinkedList</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>[]&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
            <span class=kt>boolean</span><span class=o>[][]</span> <span class=n>marked</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>boolean</span><span class=o>[</span><span class=n>matrix</span><span class=p>.</span><span class=na>length</span><span class=o>][</span><span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span><span class=o>]</span><span class=p>;</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>ispeak</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>marked</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>))</span> <span class=n>queue</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=kt>int</span><span class=o>[]</span><span class=p>{</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>queue</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span> <span class=p>{</span>
                <span class=n>len</span><span class=o>++</span><span class=p>;</span>
                <span class=kt>int</span> <span class=n>size</span> <span class=o>=</span> <span class=n>queue</span><span class=p>.</span><span class=na>size</span><span class=p>();</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>size</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>int</span><span class=o>[]</span> <span class=n>p</span> <span class=o>=</span> <span class=n>queue</span><span class=p>.</span><span class=na>poll</span><span class=p>();</span>
                    <span class=n>marked</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=mi>0</span><span class=o>]][</span><span class=n>p</span><span class=o>[</span><span class=mi>1</span><span class=o>]]</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
                    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>p</span><span class=o>[</span><span class=mi>0</span><span class=o>]+</span><span class=n>dirs</span><span class=o>[</span><span class=n>j</span><span class=o>][</span><span class=mi>0</span><span class=o>]</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=n>p</span><span class=o>[</span><span class=mi>1</span><span class=o>]+</span><span class=n>dirs</span><span class=o>[</span><span class=n>j</span><span class=o>][</span><span class=mi>1</span><span class=o>]</span><span class=p>;</span>
                        <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>r</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=p>.</span><span class=na>length</span> <span class=o>&amp;&amp;</span> <span class=n>c</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>r</span><span class=o>][</span><span class=n>c</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>ispeak</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>marked</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>))</span> <span class=p>{</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=o>[</span><span class=n>r</span><span class=o>][</span><span class=n>c</span><span class=o>]</span> <span class=o>!=</span> <span class=n>matrix</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=mi>0</span><span class=o>]][</span><span class=n>p</span><span class=o>[</span><span class=mi>1</span><span class=o>]]</span><span class=p>)</span> <span class=n>queue</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=kt>int</span><span class=o>[]</span><span class=p>{</span><span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>return</span> <span class=n>len</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This BFS is not the same as the classic BFS routine from CLRS. It is a generalized BFS approach, which can be transformed to a problem to find the connected components.</p> </div> <p>DFS solution</p> <ul> <li>we can also use DFS for this problem, it turns out DFS is the simpliest solution.</li> </ul> <div class=tabbed-set data-tabs=6:1><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><label for=__tabbed_6_1>DFS solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>longestIncreasingPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>cache</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>cache</span><span class=p>);</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>len</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=kt>int</span> <span class=n>m</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>cache</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=k>return</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>p</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>matrix</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>cache</span><span class=p>);</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>len</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=n>cache</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>res</span><span class=p>;</span>
        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=walls-and-gates>Walls and Gates<a class=headerlink href=#walls-and-gates title="Permanent link">&para;</a></h3> <p>BFS solution</p> <ul> <li>We push all the gate to the queue at once, then BFS to update the room. This makes use of the optimal character of BFS and bring us some optimization.</li> <li>Proof correctness: If init the queue with all gates, BFS alternate between gates, once BFS explore one level of rooms for a particular gate, it switches to explore the same level or next level rooms for another gate. The level is the distance from room to gate. Suppose room R1 is visited at the first time from G1, then if R1 is visited again via G2, the distance from G2 to R1 is possible to be the same as G1 to R1, or greater than G1 to R1 by 1. <strong>The assigned nearest distance from room to gate never be able to reduce further in future.</strong> Then the first assigned distance value for a room will be the nearest one.</li> </ul> <p>DFS solution</p> <ul> <li>I initially start with each <code>INF</code> cell and search for 0. the issue is we have to pass the original <code>i</code>, <code>j</code>, in case we reach the base case to update the <code>INF</code> cell.</li> <li>Another trick is how to handle the repeated searching the same empty room. Extra space like <code>visited[m][n]</code> will work. but a better way to handle it is what we did in the below solution. We check if <code>d &gt; ma[i][j]</code>, if <code>d &gt; 0</code>, the <code>d &gt; mat[i][j]</code> also make sure we update <code>mat[i][j]</code> with a smaller value because the initial value of <code>INF</code> cell is <code>INT_MAX</code>. This is different from DFS because DFS can ensure the shortest path.</li> <li>The time complexity is <span><span class=MathJax_Preview>O(m^2n^2)</span><script type=math/tex>O(m^2n^2)</script></span>. The space complexity is from the stack. It is definitely not constant.</li> </ul> <div class=tabbed-set data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><label for=__tabbed_7_1>C++ BFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>wallsAndGates</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>rooms</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>rooms</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>rooms</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>rooms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// start from each gate </span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>rooms</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INT_MAX</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>continue</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=n>rooms</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>rooms</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_7_2 name=__tabbed_7 type=radio><label for=__tabbed_7_2>C++ DFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>wallsAndGates</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>rooms</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>rooms</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>rooms</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>rooms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// start from each gate, not room</span>
                    <span class=n>helper</span><span class=p>(</span><span class=n>rooms</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=cm>/* i, j are the starting point. */</span>
    <span class=kt>void</span> <span class=n>helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>mat</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=kt>int</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>mat</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>mat</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=c1>// have already made sure d &lt; mat[i][j]</span>
        <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>mat</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>d</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <div class="admonition note"> <p class=admonition-title>multi-end BFS</p> <p>Notice this implementation of BFS is different from triditional BFS. It start with a queue that have more than one element. Some people call this <a href=https://leetcode.com/problems/walls-and-gates/discuss/72748/benchmarks-of-dfs-and-bfs>multi-end BFS</a>. It is perform better than the original BFS, The time complexity is <span><span class=MathJax_Preview>O(mn)</span><script type=math/tex>O(mn)</script></span></p> </div> <h3 id=01-matrix>01 Matrix<a class=headerlink href=#01-matrix title="Permanent link">&para;</a></h3> <h3 id=surrounded-regions>Surrounded Regions<a class=headerlink href=#surrounded-regions title="Permanent link">&para;</a></h3> <ul> <li>We first mark the boundary <code>O</code>, then start BFS from each <code>O</code>. If it cannot reach the special marks, we capture the cell.</li> <li>This solution is starting from each of inner <code>O</code> and search the mark at the boundary. The solution is TLE due to more inner <code>O</code>'s than boundary <code>O</code>'s.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>solve</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;&gt;&amp;</span> <span class=n>board</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>board</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>board</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span> <span class=o>?</span> <span class=sc>&#39;-&#39;</span> <span class=o>:</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>bool</span> <span class=n>flag</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;X&#39;</span><span class=p>)</span> <span class=p>{</span>
                                <span class=k>continue</span><span class=p>;</span>
                            <span class=p>}</span>

                            <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
                            <span class=p>}</span>

                            <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span><span class=p>)</span> <span class=p>{</span>
                                <span class=n>flag</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
                                <span class=k>break</span><span class=p>;</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>flag</span><span class=p>)</span>
                            <span class=k>break</span><span class=p>;</span>
                    <span class=p>}</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>flag</span><span class=p>)</span>
                        <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span> <span class=o>?</span> <span class=sc>&#39;O&#39;</span> <span class=o>:</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <ul> <li>Instead searching whether a 'O' have an outlet. We can discover all 'O's that lead to edge 'O's and mark them, then all the rest 'O's are captured.</li> <li>Specifically, starting from every 'O' at the edge, using BFS to search all the 'O's outside the 'X's, all these 'O's that cannot be captured. Compare to solution 1, this ideas is thinking â€œout of the boxâ€, instead of thinking inside 'O's, we take care outside 'O's first.</li> <li>Similar problems: <a href=#walls-and-gates>Walls and Gates</a>, <a href=#shortest-distance-from-all-buildings>Shortest Distance from All Buildings</a>.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>solve</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;&gt;&amp;</span> <span class=n>board</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>board</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>board</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=c1>// bfs search from boundary &#39;O&#39;s</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span>
                        <span class=n>bfs_helper</span><span class=p>(</span><span class=n>board</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span> <span class=c1>// capture all inner &#39;O&#39;s</span>
                <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;O&#39;</span><span class=p>;</span> <span class=c1>// flip back the marks</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=c1>// helper function to mark &quot;outside&quot; &#39;O&#39; as &#39;-&#39;</span>
    <span class=kt>void</span> <span class=n>bfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;&gt;&amp;</span> <span class=n>board</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>board</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>board</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;-&#39;</span><span class=p>;</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;-&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Tips</p> <p>ä»¥ä¸Šä¸¤ä¸ª solution è¶³ä»¥è¯´æ˜ŽBFSçš„æœç´¢æ–¹å‘å’Œæœç´¢ç›®æ ‡éžå¸¸é‡è¦ã€‚å·§å¦™è½¬åŒ–æœç´¢ç›®æ ‡å¯ä»¥ä½¿å¾—codeå¾ˆå¥½å†™ï¼Œæ›´ç®€æ´ã€‚</p> </div> <h3 id=best-meeting-point>Best Meeting Point<a class=headerlink href=#best-meeting-point title="Permanent link">&para;</a></h3> <ul> <li>At the first attempt, I tried to use BFS to do search level by level, which can exhaust all the possible distances from 1 to 0. Unfortunately, it is TLE in the OJ.</li> <li>Following from the idea in problem Minimum Moves to <a href=#equal-array-elements-ii>Equal Array Elements II</a>, we can use math method to calculate the median of the x and y coordinates.</li> <li>The worst case time complexity is <span><span class=MathJax_Preview>O(mn\log mn)</span><script type=math/tex>O(mn\log mn)</script></span>, since there are at most <span><span class=MathJax_Preview>m\times n</span><script type=math/tex>m\times n</script></span> "1" in the grid.</li> </ul> <div class=tabbed-set data-tabs=8:3><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><label for=__tabbed_8_1>C++ Median solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>minTotalDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>rows</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
                    <span class=n>cols</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>minDistance</span><span class=p>(</span><span class=n>rows</span><span class=p>)</span> <span class=o>+</span> <span class=n>minDistance</span><span class=p>(</span><span class=n>cols</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>minDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>vec</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>vec</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>sort</span><span class=p>(</span><span class=n>vec</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span> <span class=n>vec</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
        <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>l</span> <span class=o>&lt;</span> <span class=n>r</span><span class=p>)</span> <span class=n>res</span> <span class=o>+=</span> <span class=n>vec</span><span class=p>[</span><span class=n>r</span><span class=o>--</span><span class=p>]</span> <span class=o>-</span> <span class=n>vec</span><span class=p>[</span><span class=n>l</span><span class=o>++</span><span class=p>];</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_8_2 name=__tabbed_8 type=radio><label for=__tabbed_8_2>C++ Median solution II</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>minTotalDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>rows</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
                    <span class=n>cols</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=n>sort</span><span class=p>(</span><span class=n>cols</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span> <span class=n>cols</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
        <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=n>rows</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>l</span> <span class=o>&lt;</span> <span class=n>r</span><span class=p>)</span>
            <span class=n>res</span> <span class=o>+=</span> <span class=n>rows</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>-</span> <span class=n>rows</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>+</span> <span class=n>cols</span><span class=p>[</span><span class=n>r</span><span class=o>--</span><span class=p>]</span> <span class=o>-</span> <span class=n>cols</span><span class=p>[</span><span class=n>l</span><span class=o>++</span><span class=p>];</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_8_3 name=__tabbed_8 type=radio><label for=__tabbed_8_3>BFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>minTotalDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dist</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>bfs_helper</span><span class=p>(</span><span class=n>grid</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>dist</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>res</span> <span class=o>&gt;</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
                    <span class=n>res</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>bfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=o>&amp;</span><span class=n>dist</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>level</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
        <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;</span> <span class=n>len</span><span class=p>;</span> <span class=n>l</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>;</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
                <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>])</span> <span class=p>{</span>
                        <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>+=</span> <span class=n>level</span><span class=p>;</span>
                        <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=n>level</span><span class=o>++</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=number-of-islands>Number of Islands<a class=headerlink href=#number-of-islands title="Permanent link">&para;</a></h3> <h3 id=battleships-in-a-board>Battleships in a Board<a class=headerlink href=#battleships-in-a-board title="Permanent link">&para;</a></h3> <h3 id=bus-routes>Bus Routes<a class=headerlink href=#bus-routes title="Permanent link">&para;</a></h3> <h3 id=word-ladder>Word Ladder<a class=headerlink href=#word-ladder title="Permanent link">&para;</a></h3> <h3 id=minimum-genetic-mutation>Minimum Genetic Mutation<a class=headerlink href=#minimum-genetic-mutation title="Permanent link">&para;</a></h3> <h3 id=word-ladder-ii>Word Ladder II<a class=headerlink href=#word-ladder-ii title="Permanent link">&para;</a></h3> <h3 id=open-the-lock>Open the Lock<a class=headerlink href=#open-the-lock title="Permanent link">&para;</a></h3> <h3 id=evaluate-devision>Evaluate Devision<a class=headerlink href=#evaluate-devision title="Permanent link">&para;</a></h3> <h3 id=399-evaluate-division>399. Evaluate Division<a class=headerlink href=#399-evaluate-division title="Permanent link">&para;</a></h3> <div class=tabbed-set data-tabs=9:3><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><label for=__tabbed_9_1>C++ BFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span> <span class=n>calcEquation</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;&gt;&amp;</span> <span class=n>equations</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&amp;</span> <span class=n>values</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;&gt;&amp;</span> <span class=n>queries</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>unordered_map</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>double</span><span class=o>&gt;&gt;&gt;</span> <span class=n>graph</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>equations</span><span class=p>.</span><span class=n>size</span><span class=p>();</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>

            <span class=n>graph</span><span class=p>[</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]].</span><span class=n>push_back</span><span class=p>({</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>],</span> <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>]});</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]].</span><span class=n>push_back</span><span class=p>({</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=mf>1.0</span><span class=p>});</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]].</span><span class=n>push_back</span><span class=p>({</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=mf>1.0</span> <span class=o>/</span> <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>]});</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]].</span><span class=n>push_back</span><span class=p>({</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>],</span> <span class=mf>1.0</span><span class=p>});</span>

        <span class=p>}</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span> <span class=nl>qr</span><span class=p>:</span> <span class=n>queries</span> <span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>graph</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>==</span> <span class=n>graph</span><span class=p>.</span><span class=n>end</span><span class=p>()</span> <span class=o>||</span> <span class=n>graph</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>==</span> <span class=n>graph</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span>
                <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=mi>-1</span><span class=p>);</span>
                <span class=k>continue</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>double</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
            <span class=n>unordered_set</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mf>1.0</span><span class=p>});</span>
            <span class=n>visited</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
            <span class=kt>bool</span> <span class=n>find</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
            <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>find</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>auto</span> <span class=n>t</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>t</span><span class=p>.</span><span class=n>first</span> <span class=o>==</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=p>{</span>
                    <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>t</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
                    <span class=n>find</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                    <span class=k>break</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>a</span><span class=p>:</span> <span class=n>graph</span><span class=p>[</span><span class=n>t</span><span class=p>.</span><span class=n>first</span><span class=p>])</span> <span class=p>{</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>visited</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>first</span><span class=p>)</span> <span class=o>==</span> <span class=n>visited</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span>
                        <span class=n>a</span><span class=p>.</span><span class=n>second</span> <span class=o>*=</span> <span class=n>t</span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
                        <span class=n>visited</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>find</span><span class=p>)</span> <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=mf>-1.0</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_9_2 name=__tabbed_9 type=radio><label for=__tabbed_9_2>C++ DFS</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span> <span class=n>calcEquation</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=o>&gt;&gt;</span> <span class=n>equations</span><span class=p>,</span>
                                <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&amp;</span> <span class=n>values</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=o>&gt;&gt;</span> <span class=n>queries</span><span class=p>)</span> <span class=p>{</span>

        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>equations</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>queries</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>-1</span><span class=p>);</span>
        <span class=n>set</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>s</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>equation</span> <span class=p>:</span> <span class=n>equations</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>s</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>equation</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
            <span class=n>s</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>equation</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>query</span><span class=p>({</span><span class=n>queries</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span><span class=p>,</span> <span class=n>queries</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span><span class=p>});</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>query</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=n>s</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>query</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span> <span class=p>{</span>
                <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
                <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>helper</span><span class=p>(</span><span class=n>equations</span><span class=p>,</span> <span class=n>values</span><span class=p>,</span> <span class=n>query</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=c1>// Parameter visited here is to help the search.</span>
    <span class=kt>double</span> <span class=n>helper</span> <span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=o>&gt;&gt;</span> <span class=n>equations</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&amp;</span> <span class=n>values</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>query</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=n>visited</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>equations</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>

        <span class=c1>//base case, writing in seperate loop is more efficient O(n)</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span> <span class=o>==</span> <span class=n>query</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span> <span class=o>==</span> <span class=n>query</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=p>{</span>
                <span class=k>return</span> <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span> <span class=o>==</span> <span class=n>query</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span> <span class=o>==</span> <span class=n>query</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=p>{</span>
                <span class=k>return</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=c1>// not found do DFS</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span> <span class=o>==</span> <span class=n>query</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=kt>double</span> <span class=n>t</span> <span class=o>=</span> <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>helper</span><span class=p>(</span><span class=n>equations</span><span class=p>,</span> <span class=n>values</span><span class=p>,</span> <span class=p>{</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span><span class=p>,</span> <span class=n>query</span><span class=p>[</span><span class=mi>1</span><span class=p>]},</span> <span class=n>visited</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>t</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=n>t</span><span class=p>;</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>second</span> <span class=o>==</span> <span class=n>query</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=kt>double</span> <span class=n>t</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>/</span> <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>*</span> <span class=n>helper</span><span class=p>(</span><span class=n>equations</span><span class=p>,</span> <span class=n>values</span><span class=p>,</span> <span class=p>{</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>first</span><span class=p>,</span> <span class=n>query</span><span class=p>[</span><span class=mi>1</span><span class=p>]},</span> <span class=n>visited</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>t</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=n>t</span><span class=p>;</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=mf>-1.0</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_9_3 name=__tabbed_9 type=radio><label for=__tabbed_9_3>C++ Floyd-Warshall</label><div class=tabbed-content></div> </div> <div class=highlight><pre><span></span><code>
</code></pre></div> <h2 id=compute-shortest-path-for-undirected-graphs>Compute shortest path for undirected graphs<a class=headerlink href=#compute-shortest-path-for-undirected-graphs title="Permanent link">&para;</a></h2> <h3 id=the-maze-ii_1><a href=#the-maze-ii>The Maze II</a><a class=headerlink href=#the-maze-ii_1 title="Permanent link">&para;</a></h3> <h3 id=shortest-distance-from-all-buildings>Shortest Distance from All Buildings<a class=headerlink href=#shortest-distance-from-all-buildings title="Permanent link">&para;</a></h3> <ul> <li>Similar to <a href=#walls-and-gates>Walls and Gates</a>, We should search from the "dst" (buildings) to "src" (empty land), while the problem is asking search from empty land to buildings.</li> <li>We need a 2D array to record the distance obtained by searching. The result is obtained at last after we finish the searching. Attention: we have also need to check whether the new building can reach all buildings. So use another 2D array and a counter num_buildings to check it can reach all.</li> </ul> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>shortestDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>num_buildings</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dist1</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>reach</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>num_buildings</span><span class=o>++</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>

                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
                    <span class=kt>int</span> <span class=n>level</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// grid[a][b] is level 0, grid[u][v] is level 1</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>s</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>s</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// BFS level by level</span>
                            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
                            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>%</span> <span class=n>n</span><span class=p>;</span>
                            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>grid</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>])</span> <span class=p>{</span>
                                    <span class=n>dist1</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>+=</span> <span class=n>level</span><span class=p>;</span>
                                    <span class=n>reach</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span><span class=o>++</span><span class=p>;</span> <span class=c1>// use to count num of 1s that reach this 0.</span>
                                    <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>v</span><span class=p>);</span>
                                <span class=p>}</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                        <span class=n>level</span><span class=o>++</span><span class=p>;</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>reach</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=n>num_buildings</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>res</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>dist1</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=mi>-1</span> <span class=o>:</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <ul> <li>We can modify the original 2D array to record which cell is visited and which isn't so as to optimize the space complexity. Each time we start BFS from a building <code>grid[i][j]=1</code>, the land will be decreased by <code>1</code>. So after the first BFS, all <code>grid[i][j]=0</code> becomes <code>grid[i][j]=-1</code>. The decreasing of <code>grid[i][j]</code> is equivalent to use the visited variables.</li> <li>similar to Solution 1, we use a 2D array <code>dist[i][j]</code> to record the distances. This distance is <code>dist[i][j]</code> used to record each BFS started from a building (<code>grid[i][j]=1</code>), not the global distances. To accumulate all the distance from 1s, we have to use another 2D array sum to record it.</li> </ul> <div class=tabbed-set data-tabs=10:1><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><label for=__tabbed_10_1>C++ Optimized BFS solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>shortestDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>counter</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>sum</span> <span class=o>=</span> <span class=n>grid</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>-1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dist</span> <span class=o>=</span> <span class=n>grid</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
                    <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
                        <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>%</span> <span class=n>n</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
                            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>grid</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=n>counter</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>                                <span class=n>grid</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span><span class=o>--</span><span class=p>;</span> <span class=c1>// Mark this potential building position is visited in prev round</span>
</span><span class=hll>                                <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span><span class=hll>                                <span class=n>sum</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
</span><span class=hll>                                <span class=n>res</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>sum</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]);</span>
</span>                                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>v</span><span class=p>);</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                    <span class=n>counter</span><span class=o>--</span><span class=p>;</span> <span class=c1>// mark as visited</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=mi>-1</span> <span class=o>:</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h3 id=shortest-path-visiting-all-nodes>Shortest Path Visiting All Nodes<a class=headerlink href=#shortest-path-visiting-all-nodes title="Permanent link">&para;</a></h3> <h3 id=shortest-path-to-get-all-keys>Shortest Path to Get All Keys<a class=headerlink href=#shortest-path-to-get-all-keys title="Permanent link">&para;</a></h3> <h2 id=compute-connected-components-for-undirected-graphs>Compute connected components for undirected graphs<a class=headerlink href=#compute-connected-components-for-undirected-graphs title="Permanent link">&para;</a></h2> <h3 id=longest-increasing-path-in-a-matrix_1><a href=#longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix</a><a class=headerlink href=#longest-increasing-path-in-a-matrix_1 title="Permanent link">&para;</a></h3> <h3 id=number-of-connected-components-in-an-undirected-graph>Number of Connected Components in an Undirected Graph<a class=headerlink href=#number-of-connected-components-in-an-undirected-graph title="Permanent link">&para;</a></h3> <ul> <li>Build the undirected graph using adjacency list from the edge list representation.</li> <li>Call BFS in a for loop and use a <code>visited</code> vector to mark the status of the vertex explorations.</li> <li>Direct transform the above BFS solution to a DFS solution.</li> </ul> <div class=tabbed-set data-tabs=11:3><input checked=checked id=__tabbed_11_1 name=__tabbed_11 type=radio><label for=__tabbed_11_1>C++ BFS solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countComponents</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>graph</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                    <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                    <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>a</span> <span class=p>:</span> <span class=n>graph</span><span class=p>[</span><span class=n>t</span><span class=p>])</span> <span class=p>{</span>
                        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span><span class=p>])</span> <span class=p>{</span>
                            <span class=n>visited</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                            <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>

                <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_11_2 name=__tabbed_11 type=radio><label for=__tabbed_11_2>C++ DFS solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countComponents</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>graph</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>dfs_helper</span><span class=p>(</span><span class=n>graph</span><span class=p>,</span> <span class=n>visited</span><span class=p>,</span> <span class=n>i</span><span class=p>);</span>
                <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>graph</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&amp;</span> <span class=n>visited</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>a</span> <span class=p>:</span> <span class=n>graph</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>dfs_helper</span><span class=p>(</span><span class=n>graph</span><span class=p>,</span> <span class=n>visited</span><span class=p>,</span> <span class=n>a</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> <input id=__tabbed_11_3 name=__tabbed_11 type=radio><label for=__tabbed_11_3>Union-Find solution</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>parent</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countComponents</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>parent</span> <span class=o>=</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>-1</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>root</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
            <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>root</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>!=</span> <span class=n>q</span><span class=p>)</span> <span class=n>parent</span><span class=p>[</span><span class=n>q</span><span class=p>]</span> <span class=o>=</span> <span class=n>p</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>root</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>i</span> <span class=o>!=</span> <span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=n>i</span> <span class=o>=</span> <span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=k>return</span> <span class=n>i</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> </div> </div> <h2 id=bfs-topological-sorting>BFS Topological sorting<a class=headerlink href=#bfs-topological-sorting title="Permanent link">&para;</a></h2> <p>Apply BFS in DAG topological sorting requires to start with the vertices that have <code>0</code> indegree, namely the source vertices. We need a <strong>queue</strong> and a <code>indegree</code> vector for solving topological sorting problems. The BFS queue may start with more than one source vertices because topological sorted graph may start with two or more vertices (indegree == 0). When BFS visit an adjacent vertex of the queue-front vertex, the indegree of this visited vertex should be decreased by 1, as we "visited" this arc. If the indegree of the visited vertex is reduced to 0, we push it to the queue. The idea of using BFS in topological sorting is to explore frontier of the vertices that currently have <code>0</code> non-visited arcs leading to the vertices (indegree is 0).</p> <ul> <li>What if the given graph have a single vertex?</li> <li>How to check whether the topological sorting is unique or not?</li> <li>How to output all the unique topological sorted sequence of vertices?</li> </ul> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../../binary-indexed-tree/notes/ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Binary Indexed Tree </div> </div> </a> <a href=../../depth-first-search/notes/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Depth-First Search (DFS) </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Rui Han </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/vendor.77e55a48.min.js></script> <script src=../../../assets/javascripts/bundle.9554a270.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>