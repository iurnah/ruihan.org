<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link href=https://ruihan.org/leetcode/breadth-first-search/notes/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-4.6.3"><title>Breadth-First Search (BFS) - RUIHAN.ORG</title><link rel=stylesheet href=../../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content><script src=../../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=black data-md-color-accent=black> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#breadth-first-search tabindex=0 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://ruihan.org title=RUIHAN.ORG aria-label=RUIHAN.ORG class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> RUIHAN.ORG </span> <span class=md-header-nav__topic> Breadth-First Search (BFS) </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../books/ class=md-tabs__link> Books </a> </li> <li class=md-tabs__item> <a href=../../../courses/ class=md-tabs__link> Courses </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Leetcode </a> </li> <li class=md-tabs__item> <a href=../../../research/ class=md-tabs__link> Research </a> </li> <li class=md-tabs__item> <a href=../../../seedlabs/ class=md-tabs__link> SEED Labs </a> </li> <li class=md-tabs__item> <a href=../../../system-design/ class=md-tabs__link> System Design </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://ruihan.org title=RUIHAN.ORG class="md-nav__button md-logo"> <i class=md-icon></i> </a> RUIHAN.ORG </label> <div class=md-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Books </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Books </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../books/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../books/accelerated-cpp/notes/ title="Accelerated C++" class=md-nav__link> Accelerated C++ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Courses </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Courses </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../courses/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../courses/stanford-machine-learning/notes.md title="Stanford Machine Learning" class=md-nav__link> Stanford Machine Learning </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/lec-notes/ title="CS224N Lecture Notes" class=md-nav__link> CS224N Lecture Notes </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/write-up/ title="CS224N Write-up" class=md-nav__link> CS224N Write-up </a> </li> <li class=md-nav__item> <a href=../../../courses/6.431-probability/notes/ title="6.431 Probability" class=md-nav__link> 6.431 Probability </a> </li> <li class=md-nav__item> <a href=../../../courses/learning-from-data/notes.md title="Learning From Data" class=md-nav__link> Learning From Data </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-system-design/notes/ title="Nine Chapter System Design" class=md-nav__link> Nine Chapter System Design </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-dynamic-prog/notes/ title="Nine Chapter Dynamic Programming" class=md-nav__link> Nine Chapter Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../../courses/func-prog-in-scala/notes/ title="Functional Programming Principles in Scala" class=md-nav__link> Functional Programming Principles in Scala </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Leetcode </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Leetcode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../array/notes/ title=Array class=md-nav__link> Array </a> </li> <li class=md-nav__item> <a href=../../backtracking/notes/ title=Backtracking class=md-nav__link> Backtracking </a> </li> <li class=md-nav__item> <a href=../../binary-search/notes/ title="Binary Search" class=md-nav__link> Binary Search </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Breadth-First Search (BFS) </label> <a href=./ title="Breadth-First Search (BFS)" class="md-nav__link md-nav__link--active"> Breadth-First Search (BFS) </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#algorithm class=md-nav__link> Algorithm </a> </li> <li class=md-nav__item> <a href=#bfs-properties class=md-nav__link> BFS properties </a> </li> <li class=md-nav__item> <a href=#search class=md-nav__link> Search </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze class=md-nav__link> The Maze </a> </li> <li class=md-nav__item> <a href=#the-maze-ii class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#the-maze-iii class=md-nav__link> The Maze III </a> </li> <li class=md-nav__item> <a href=#pacific-atlantic-water-flow class=md-nav__link> Pacific Atlantic Water Flow </a> </li> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#walls-and-gates class=md-nav__link> Walls and Gates </a> </li> <li class=md-nav__item> <a href=#01-matrix class=md-nav__link> 01 Matrix </a> </li> <li class=md-nav__item> <a href=#surrounded-regions class=md-nav__link> Surrounded Regions </a> </li> <li class=md-nav__item> <a href=#best-meeting-point class=md-nav__link> Best Meeting Point </a> </li> <li class=md-nav__item> <a href=#number-of-islands class=md-nav__link> Number of Islands </a> </li> <li class=md-nav__item> <a href=#battleships-in-a-board class=md-nav__link> Battleships in a Board </a> </li> <li class=md-nav__item> <a href=#bus-routes class=md-nav__link> Bus Routes </a> </li> <li class=md-nav__item> <a href=#word-ladder class=md-nav__link> Word Ladder </a> </li> <li class=md-nav__item> <a href=#minimum-genetic-mutation class=md-nav__link> Minimum Genetic Mutation </a> </li> <li class=md-nav__item> <a href=#word-ladder-ii class=md-nav__link> Word Ladder II </a> </li> <li class=md-nav__item> <a href=#open-the-lock class=md-nav__link> Open the Lock </a> </li> <li class=md-nav__item> <a href=#evaluate-devision class=md-nav__link> Evaluate Devision </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-shortest-path-for-undirected-graphs class=md-nav__link> Compute shortest path for undirected graphs </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze-ii_1 class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#shortest-distance-from-all-buildings class=md-nav__link> Shortest Distance from All Buildings </a> </li> <li class=md-nav__item> <a href=#shortest-path-visiting-all-nodes class=md-nav__link> Shortest Path Visiting All Nodes </a> </li> <li class=md-nav__item> <a href=#shortest-path-to-get-all-keys class=md-nav__link> Shortest Path to Get All Keys </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-connected-components-for-undirected-graphs class=md-nav__link> Compute connected components for undirected graphs </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix_1 class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#number-of-connected-components-in-an-undirected-graph class=md-nav__link> Number of Connected Components in an Undirected Graph </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bfs-topological-sorting class=md-nav__link> BFS Topological sorting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../depth-first-search/notes/ title="Depth-First Search (DFS)" class=md-nav__link> Depth-First Search (DFS) </a> </li> <li class=md-nav__item> <a href=../../dynamic-programming/notes/ title="Dynamic Programming" class=md-nav__link> Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../graph/notes/ title=Graph class=md-nav__link> Graph </a> </li> <li class=md-nav__item> <a href=../../heap/notes/ title=Heap class=md-nav__link> Heap </a> </li> <li class=md-nav__item> <a href=../../interval/notes/ title=Interval class=md-nav__link> Interval </a> </li> <li class=md-nav__item> <a href=../../linked-list/notes/ title="Linked List" class=md-nav__link> Linked List </a> </li> <li class=md-nav__item> <a href=../../string/notes/ title=String class=md-nav__link> String </a> </li> <li class=md-nav__item> <a href=../../trie/notes/ title=Trie class=md-nav__link> Trie </a> </li> <li class=md-nav__item> <a href=../../union-find/notes/ title="Union Find" class=md-nav__link> Union Find </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Research </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../research/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../research/coalition-game/notes/ title="Coalition Game" class=md-nav__link> Coalition Game </a> </li> <li class=md-nav__item> <a href=../../../research/contextual-bandit/notes/ title="Contextual Multi-Armed Bandit" class=md-nav__link> Contextual Multi-Armed Bandit </a> </li> <li class=md-nav__item> <a href=../../../research/tfidf-score/notes/ title="TF-IDF for Information Retrieval" class=md-nav__link> TF-IDF for Information Retrieval </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> SEED Labs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> SEED Labs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../seedlabs/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/applied-crypto/notes/ title="Applied Cryptograph Notes" class=md-nav__link> Applied Cryptograph Notes </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/public-key-cryptography-and-pki/notes/ title="Public Key Cryptography and PKI" class=md-nav__link> Public Key Cryptography and PKI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> System Design </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> System Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../system-design/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../system-design/concepts/notes/ title="Distributed System Concepts" class=md-nav__link> Distributed System Concepts </a> </li> <li class=md-nav__item> <a href=../../../system-design/patterns/notes/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/tinyurl/notes/ title="How to Design TinyUrl" class=md-nav__link> How to Design TinyUrl </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/twitter/notes/ title="How to Design Twitter" class=md-nav__link> How to Design Twitter </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/ticketmaster/notes/ title="How to Design Ticketmaster" class=md-nav__link> How to Design Ticketmaster </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#algorithm class=md-nav__link> Algorithm </a> </li> <li class=md-nav__item> <a href=#bfs-properties class=md-nav__link> BFS properties </a> </li> <li class=md-nav__item> <a href=#search class=md-nav__link> Search </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze class=md-nav__link> The Maze </a> </li> <li class=md-nav__item> <a href=#the-maze-ii class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#the-maze-iii class=md-nav__link> The Maze III </a> </li> <li class=md-nav__item> <a href=#pacific-atlantic-water-flow class=md-nav__link> Pacific Atlantic Water Flow </a> </li> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#walls-and-gates class=md-nav__link> Walls and Gates </a> </li> <li class=md-nav__item> <a href=#01-matrix class=md-nav__link> 01 Matrix </a> </li> <li class=md-nav__item> <a href=#surrounded-regions class=md-nav__link> Surrounded Regions </a> </li> <li class=md-nav__item> <a href=#best-meeting-point class=md-nav__link> Best Meeting Point </a> </li> <li class=md-nav__item> <a href=#number-of-islands class=md-nav__link> Number of Islands </a> </li> <li class=md-nav__item> <a href=#battleships-in-a-board class=md-nav__link> Battleships in a Board </a> </li> <li class=md-nav__item> <a href=#bus-routes class=md-nav__link> Bus Routes </a> </li> <li class=md-nav__item> <a href=#word-ladder class=md-nav__link> Word Ladder </a> </li> <li class=md-nav__item> <a href=#minimum-genetic-mutation class=md-nav__link> Minimum Genetic Mutation </a> </li> <li class=md-nav__item> <a href=#word-ladder-ii class=md-nav__link> Word Ladder II </a> </li> <li class=md-nav__item> <a href=#open-the-lock class=md-nav__link> Open the Lock </a> </li> <li class=md-nav__item> <a href=#evaluate-devision class=md-nav__link> Evaluate Devision </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-shortest-path-for-undirected-graphs class=md-nav__link> Compute shortest path for undirected graphs </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-maze-ii_1 class=md-nav__link> The Maze II </a> </li> <li class=md-nav__item> <a href=#shortest-distance-from-all-buildings class=md-nav__link> Shortest Distance from All Buildings </a> </li> <li class=md-nav__item> <a href=#shortest-path-visiting-all-nodes class=md-nav__link> Shortest Path Visiting All Nodes </a> </li> <li class=md-nav__item> <a href=#shortest-path-to-get-all-keys class=md-nav__link> Shortest Path to Get All Keys </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#compute-connected-components-for-undirected-graphs class=md-nav__link> Compute connected components for undirected graphs </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#longest-increasing-path-in-a-matrix_1 class=md-nav__link> Longest Increasing Path in a Matrix </a> </li> <li class=md-nav__item> <a href=#number-of-connected-components-in-an-undirected-graph class=md-nav__link> Number of Connected Components in an Undirected Graph </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bfs-topological-sorting class=md-nav__link> BFS Topological sorting </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=breadth-first-search>Breadth-First Search<a class=headerlink href=#breadth-first-search title="Permanent link">&para;</a></h1> <h2 id=algorithm>Algorithm<a class=headerlink href=#algorithm title="Permanent link">&para;</a></h2> <p>BFS search a graph by first explore all the vertices that are adjacent to the source vertex <code>s</code>, then explore the adjacent vertices of those already examined in layer-by-layer fashion until all the vertices are visited.</p> <div class=superfences-tabs> <input name=__tabs_1 type=radio id=__tab_1_0 checked=checked> <label for=__tab_1_0>The psudo code</label> <div class=superfences-content><div class=codehilite><pre><span></span><code>BFS (graph G, start vertex s)
[ all nodes initially unexplored ]
-- mark s as explored
-- let Q = queue data structure, initialized with s
-- while Q not empty:
    -- remove the first node of Q, call it v
    -- for each edge(v,w) :
        -- if w unexplored
            -- mark w as explored
            -- add w to Q (at the end)
</code></pre></div></div> </div> <h2 id=bfs-properties>BFS properties<a class=headerlink href=#bfs-properties title="Permanent link">&para;</a></h2> <ol> <li>Runtime complexity <span><span class=MathJax_Preview>\Theta(|V| + |E|)</span><script type=math/tex>\Theta(|V| + |E|)</script></span>.</li> <li>It calculate <strong>shortest path</strong> from the source <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to the vertex <span><span class=MathJax_Preview>v</span><script type=math/tex>v</script></span>.</li> <li>It build a breadth-first tree, CLRS called predecessor subgraph.</li> <li>If edge <span><span class=MathJax_Preview>(u, v)</span><script type=math/tex>(u, v)</script></span> in the BFS tree, the simple path from source vertext <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to <span><span class=MathJax_Preview>u</span><script type=math/tex>u</script></span> is equal to the simple path from <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to <span><span class=MathJax_Preview>v</span><script type=math/tex>v</script></span>, or differ by 1.</li> <li>Simple path from a source vertex <span><span class=MathJax_Preview>s</span><script type=math/tex>s</script></span> to a destination vertex <span><span class=MathJax_Preview>v</span><script type=math/tex>v</script></span> is equal to the later’s <strong>level label</strong>.</li> <li>If <span><span class=MathJax_Preview>v_1, v_2, \cdots, v_n</span><script type=math/tex>v_1, v_2, \cdots, v_n</script></span> is the vertex enqueued in a certain point, <span><span class=MathJax_Preview>v_1</span><script type=math/tex>v_1</script></span> is the head and <span><span class=MathJax_Preview>v_n</span><script type=math/tex>v_n</script></span> is the back, then the level label of <span><span class=MathJax_Preview>v_1</span><script type=math/tex>v_1</script></span> is either equal to level label of <span><span class=MathJax_Preview>v_n</span><script type=math/tex>v_n</script></span> or less by 1. Also the level label of all the vertices in the queue is non-decreasing from head to tail. <strong>In other words, at a certain time the enqueued vertices at most comes from two different levels.</strong></li> </ol> <h2 id=search>Search<a class=headerlink href=#search title="Permanent link">&para;</a></h2> <ol> <li>unweighted edges</li> <li>Bi-directional search, (Speed up Dijkastra of 6.006)</li> <li>At all time, the level of nodes in queue at most differ by 1</li> <li>The relationship between BFS and DFS (The Maze II)</li> </ol> <div class="admonition note"> <p class=admonition-title>BFS tips for board and grid problems</p> <ol> <li>When push a pair of coordinate to a BFS queue, one way of doing it is using <code>pair&lt;int, int&gt;</code>. Another way is to convert to a number by <code>p = i * n + j</code>, and retrieve the coordinate by <code>i = p / n</code> and <code>j = p % n</code>.</li> <li>The BFS starting point and "target" are important, give a second thought about where should the search start and how it terminate.</li> <li><code>visitted[m][n]</code> is not necessary sometimes. See whether you can modify the original borad/matrix/grid/maze to reflect whether the element has already been accessed or not.</li> <li>In a borad or maze like input, searching neighbor cells requires you to manipulate indexes for accessing its neighbors. We do this by defining two "offset" coordinates arrays. <code>int x[4] = {-1, 0, 1, 0}; int y[4] = {0, 1, 0, -1};</code></li> <li>The BFS queue doesn't necessarily start with one element pushed. It could be <strong>"multi-end" BFS</strong>. Like in problme <a href=#pacific-atlantic-water-flow>Pacific Atlantic Water Flow</a> and <a href=#longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix</a>, one could init the queue with all possible starting node then in use a while to visit all the node towards finding the optimal path.</li> <li>The "multi-end" BFS not only can make the BFS level by level (each round of for loop visited one level of nodes), but also can make use some optimal feature of BFS, like the BFS solution of Walls and Gates.</li> <li>The BFS while loop could include another while loop to interate throught total <code>q.size()</code> nodes. This is different from the "oracle" BFS solution from CRLS, but sometime could be useful. For example: <a href=#longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix</a>.</li> </ol> </div> <h3 id=the-maze>The Maze<a class=headerlink href=#the-maze title="Permanent link">&para;</a></h3> <div class=superfences-tabs> <input name=__tabs_2 type=radio id=__tab_2_0 checked=checked> <label for=__tab_2_0>DFS</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>bool</span> <span class=n>hasPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>

        <span class=k>return</span> <span class=nf>dfs_helper</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>destination</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span>
                    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;&amp;</span> <span class=n>visited</span><span class=p>)</span> <span class=p>{</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=kt>bool</span> <span class=n>res</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>

            <span class=c1>// walk untill hit the wall</span>
            <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size90</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>new_start</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]});</span>
                <span class=n>res</span> <span class=o>!=</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>new_start</span><span class=p>,</span> <span class=n>destination</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> <input name=__tabs_2 type=radio id=__tab_2_1> <label for=__tab_2_1>BFS</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>bool</span> <span class=n>hasPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>start</span><span class=p>);</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=p>{</span>
                <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
            <span class=p>}</span>

            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>

                <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=p>}</span>

                <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span>
                    <span class=n>visited</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <h3 id=the-maze-ii>The Maze II<a class=headerlink href=#the-maze-ii title="Permanent link">&para;</a></h3> <ul> <li>BFS can computer shortest path, we need additional memory to keep the optimal values.</li> <li>we update the corresponding destination cell in <code>distance</code> vector when we found a smaller distane can reach it from any direction. the final result will be in <code>distance[destination[0]][destination[1]]</code>.</li> <li>If we don't want to use so much memory, we can use a flag to mark when the BFS switch levels.</li> <li>This solution is essentially to use BFS to solve the weighted graph problem as Victor mentioned in 6006 R15.</li> <li>Compare this solution to the Dijkastra solution. The update distance matrix is essentially the relaxiation step.</li> </ul> <div class=superfences-tabs> <input name=__tabs_3 type=radio id=__tab_3_0 checked=checked> <label for=__tab_3_0>C++</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>shortestDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>distance</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>INT_MAX</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>start</span><span class=p>);</span>
        <span class=n>distance</span><span class=p>[</span><span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>

            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=c1>// notice here is a optimize</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>&lt;</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span> <span class=cm>/* could use emplace({a - x[k], b - y[k]}) */</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>distance</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=o>-</span><span class=mi>1</span> <span class=o>:</span> <span class=n>distance</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <ul> <li>Based on the BFS solution, we can use a priority queue. Then the problem is very similar to the Dijkastra algorithm.</li> <li>The discussion about the improvement in leetcode forum is very interesting.</li> </ul> </div> <h3 id=the-maze-iii>The Maze III<a class=headerlink href=#the-maze-iii title="Permanent link">&para;</a></h3> <ul> <li>This problem is aksing for output the shortest path to reach the destination.</li> <li>The idea is to use a <code>distance[i][i]</code> and <code>result[i][j]</code>. we should keep update the <code>distance[i][j]</code> and <code>result[i][j]</code> with smaller distance and lexicographical order. The hardest part is that there is two constrains. While using BFS, How could we ensure the two constrains are met, and also we are not missing any possible path. (i.e. missed to push a path to the BFS queue.)</li> <li>A trick we can make use of is we searching in the lexicographically order. such as <code>down</code>, <code>left</code>, <code>right</code>, <code>up</code>. However, we face a problem: the <strong>smallest lexicon order result may not be the shortest distance</strong>. Think this through.</li> <li>We need to used additional memory to record that piece of information beside the memory used to keep the minimum distance.</li> </ul> <div class=superfences-tabs> <input name=__tabs_4 type=radio id=__tab_4_0 checked=checked> <label for=__tab_4_0>BFS</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>string</span> <span class=n>findShortestWay</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>start</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>destination</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>distance</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>INT_MAX</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;&gt;</span> <span class=n>result</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>start</span><span class=p>);</span>
        <span class=n>distance</span><span class=p>[</span><span class=n>start</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>start</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>char</span> <span class=n>path</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=sc>&#39;d&#39;</span><span class=p>,</span> <span class=sc>&#39;l&#39;</span><span class=p>,</span> <span class=sc>&#39;r&#39;</span><span class=p>,</span> <span class=sc>&#39;u&#39;</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>

            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=cm>/* continue if no wall */</span>
                <span class=k>while</span> <span class=p>(</span><span class=n>a</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>a</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>maze</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=cm>/* run over the destination */</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>a</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>b</span> <span class=o>==</span> <span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]){</span>
                        <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>&lt;</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>])</span> <span class=p>{</span>
                            <span class=n>distance</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span><span class=p>;</span>
                            <span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>==</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>])</span> <span class=p>{</span>
                            <span class=n>string</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=cm>/* same distance, smaller lexicon */</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>compare</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>])</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                                <span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                    <span class=p>}</span>

                    <span class=n>a</span> <span class=o>+=</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>b</span> <span class=o>+=</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>count</span><span class=o>++</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=cm>/* hit a wall, have to retreat &quot;0&quot;, current a, b is in wall or off maze */</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>&lt;</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span><span class=p>;</span>
                    <span class=n>result</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span>
                <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>distance</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>count</span> <span class=o>==</span> <span class=n>distance</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=p>{</span>
                    <span class=n>string</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>+</span> <span class=n>path</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
<span class=hll>                    <span class=cm>/* same distance, smaller lexicon */</span>
</span>                    <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>compare</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]])</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                        <span class=n>result</span><span class=p>[</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
                        <span class=cm>/* possible path, need to search it again */</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>({</span><span class=n>a</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>b</span> <span class=o>-</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>]}));</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>distance</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=s>&quot;impossible&quot;</span> <span class=o>:</span> <span class=n>result</span><span class=p>[</span><span class=n>destination</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>destination</span><span class=p>[</span><span class=mi>1</span><span class=p>]];</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> <input name=__tabs_4 type=radio id=__tab_4_1> <label for=__tab_4_1>DFS</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>string</span> <span class=n>findShortestWay</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>ball</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>hole</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>ball</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ball</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>,</span> <span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>()</span> <span class=o>=</span> <span class=p>{</span><span class=s>&quot;impossible&quot;</span><span class=p>,</span> <span class=n>INT_MAX</span><span class=p>});</span>
    <span class=p>}</span>

    <span class=n>string</span> <span class=n>roll</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=kt>int</span> <span class=n>rowBall</span><span class=p>,</span> <span class=kt>int</span> <span class=n>colBall</span><span class=p>,</span> <span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>hole</span><span class=p>,</span>
                <span class=kt>int</span> <span class=n>distRow</span><span class=p>,</span> <span class=kt>int</span> <span class=n>distCol</span><span class=p>,</span> <span class=kt>int</span> <span class=n>steps</span><span class=p>,</span> <span class=k>const</span> <span class=n>string</span><span class=o>&amp;</span> <span class=n>path</span><span class=p>,</span> <span class=n>pair</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>res</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>steps</span> <span class=o>&lt;</span> <span class=n>res</span><span class=p>.</span><span class=n>second</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>distRow</span> <span class=o>!=</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>distCol</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>while</span> <span class=p>((</span><span class=n>rowBall</span> <span class=o>+</span> <span class=n>distRow</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>rowBall</span> <span class=o>+</span> <span class=n>distRow</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&amp;&amp;</span>
                       <span class=p>(</span><span class=n>colBall</span> <span class=o>+</span> <span class=n>distCol</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>colBall</span> <span class=o>+</span> <span class=n>distCol</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>&amp;&amp;</span>
                       <span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span> <span class=o>+</span> <span class=n>distRow</span><span class=p>][</span><span class=n>colBall</span> <span class=o>+</span> <span class=n>distCol</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>

                    <span class=n>rowBall</span> <span class=o>+=</span> <span class=n>distRow</span><span class=p>;</span>
                    <span class=n>colBall</span> <span class=o>+=</span> <span class=n>distCol</span><span class=p>;</span>
                    <span class=o>++</span><span class=n>steps</span><span class=p>;</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>rowBall</span> <span class=o>==</span> <span class=n>hole</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>colBall</span> <span class=o>==</span> <span class=n>hole</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>steps</span> <span class=o>&lt;</span> <span class=n>res</span><span class=p>.</span><span class=n>second</span><span class=p>)</span> <span class=p>{</span>
                        <span class=n>res</span> <span class=o>=</span> <span class=p>{</span><span class=n>path</span><span class=p>,</span> <span class=n>steps</span><span class=p>};</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>

            <span class=k>if</span> <span class=p>(</span><span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span><span class=p>][</span><span class=n>colBall</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>steps</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>&lt;</span> <span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span><span class=p>][</span><span class=n>colBall</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>maze</span><span class=p>[</span><span class=n>rowBall</span><span class=p>][</span><span class=n>colBall</span><span class=p>]</span> <span class=o>=</span> <span class=n>steps</span> <span class=o>+</span> <span class=mi>2</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distRow</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;d&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distCol</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;l&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distCol</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;r&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>distRow</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>rowBall</span><span class=p>,</span> <span class=n>colBall</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>path</span> <span class=o>+</span> <span class=s>&quot;u&quot;</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>.</span><span class=n>first</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> <input name=__tabs_4 type=radio id=__tab_4_2> <label for=__tab_4_2>Dijkstra algoirthm</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Vertex</span>
<span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>dist</span><span class=p>;</span>
    <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>path</span><span class=p>;</span>
    <span class=n>Vertex</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dist</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>path</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>dist</span> <span class=o>=</span> <span class=n>dist</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>path</span> <span class=o>=</span> <span class=n>path</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>Vertex</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>dist</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=k>this</span><span class=o>-&gt;</span><span class=n>path</span> <span class=o>=</span> <span class=s>&quot;&quot;</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>bool</span> <span class=n>equals</span><span class=p>(</span><span class=n>Vertex</span> <span class=n>v</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>==</span> <span class=n>v</span><span class=p>.</span><span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>==</span> <span class=n>v</span><span class=p>.</span><span class=n>y</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>bool</span> <span class=n>equals</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>x</span> <span class=o>==</span> <span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>y</span> <span class=o>==</span> <span class=n>y</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
<span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>private</span><span class=o>:</span>
    <span class=c1>// coordinates and path strings for the four directions.</span>
    <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>directions</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>
    <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>paths</span> <span class=o>=</span> <span class=p>{</span><span class=s>&quot;u&quot;</span><span class=p>,</span> <span class=s>&quot;r&quot;</span><span class=p>,</span> <span class=s>&quot;d&quot;</span><span class=p>,</span> <span class=s>&quot;l&quot;</span><span class=p>};</span>
    <span class=c1>// can&#39;t roll if it&#39;s boundry, wall or hole.</span>
    <span class=kt>bool</span> <span class=nf>canRoll</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=o>&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>Vertex</span> <span class=n>hole</span><span class=p>,</span> <span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>(),</span> <span class=n>n</span> <span class=o>=</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>y</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>maze</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>hole</span><span class=p>.</span><span class=n>equals</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>);</span>
        <span class=k>else</span>
            <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=n>Vertex</span> <span class=nf>roll</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=o>&amp;</span><span class=n>maze</span><span class=p>,</span> <span class=n>Vertex</span> <span class=n>curr</span><span class=p>,</span> <span class=n>Vertex</span> <span class=n>hole</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dx</span><span class=p>,</span>
                <span class=kt>int</span> <span class=n>dy</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>path</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=n>curr</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>curr</span><span class=p>.</span><span class=n>y</span><span class=p>,</span> <span class=n>steps</span> <span class=o>=</span> <span class=n>curr</span><span class=p>.</span><span class=n>dist</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>canRoll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>hole</span><span class=p>,</span> <span class=n>x</span> <span class=o>+</span> <span class=n>dx</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>dy</span><span class=p>))</span>
        <span class=p>{</span>
            <span class=n>x</span> <span class=o>+=</span> <span class=n>dx</span><span class=p>;</span>
            <span class=n>y</span> <span class=o>+=</span> <span class=n>dy</span><span class=p>;</span>
            <span class=n>steps</span><span class=o>++</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=c1>// if couldn&#39;t roll due to hole, then return vertex corresponding to the hole.</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>hole</span><span class=p>.</span><span class=n>equals</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>dx</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>dy</span><span class=p>))</span>
        <span class=p>{</span>
            <span class=n>x</span> <span class=o>+=</span> <span class=n>dx</span><span class=p>;</span>
            <span class=n>y</span> <span class=o>+=</span> <span class=n>dy</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=n>Vertex</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps</span><span class=p>,</span> <span class=n>curr</span><span class=p>.</span><span class=n>path</span> <span class=o>+</span> <span class=n>path</span><span class=p>);</span>
    <span class=p>}</span>
<span class=k>public</span><span class=o>:</span>
    <span class=cm>/*</span>
<span class=cm>     * to form a pq based on the increasing order of distances, and if same</span>
<span class=cm>     * distance then sorting based on lexicographic order.</span>
<span class=cm>     */</span>
    <span class=k>struct</span> <span class=n>Compare</span>
    <span class=p>{</span>
        <span class=kt>bool</span> <span class=k>operator</span><span class=p>()(</span><span class=k>const</span> <span class=n>Vertex</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>Vertex</span> <span class=o>&amp;</span><span class=n>b</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=k>return</span> <span class=n>a</span><span class=p>.</span><span class=n>dist</span> <span class=o>&gt;</span> <span class=n>b</span><span class=p>.</span><span class=n>dist</span> <span class=o>||</span> <span class=n>a</span><span class=p>.</span><span class=n>dist</span> <span class=o>==</span> <span class=n>b</span><span class=p>.</span><span class=n>dist</span> <span class=o>&amp;&amp;</span> <span class=n>a</span><span class=p>.</span><span class=n>path</span> <span class=o>&gt;</span> <span class=n>b</span><span class=p>.</span><span class=n>path</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>};</span>
    <span class=cm>/*</span>
<span class=cm>     * Applying Dijkstra&#39;s algorithm here.</span>
<span class=cm>     * We treat hole as a gate here. The trick is look for holes while rolling</span>
<span class=cm>     * the back in a particular direction. So, the pq here contains the vertices</span>
<span class=cm>     * before gates as well as the holes. So, using dijkstra, when we pop a hole</span>
<span class=cm>     * from pq, we know its that.</span>
<span class=cm>     */</span>
    <span class=n>string</span> <span class=nf>findShortestWay</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>maze</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>ball</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>hole</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>maze</span><span class=p>.</span><span class=n>size</span><span class=p>(),</span> <span class=n>n</span> <span class=o>=</span> <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
        <span class=n>std</span><span class=o>::</span><span class=n>priority_queue</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=o>&gt;</span><span class=p>,</span> <span class=n>Compare</span><span class=o>&gt;</span> <span class=n>pq</span><span class=p>;</span>
        <span class=n>Vertex</span> <span class=n>startVertex</span><span class=p>(</span><span class=n>ball</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ball</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>),</span> <span class=n>holeVertex</span><span class=p>(</span><span class=n>hole</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>hole</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
        <span class=n>std</span><span class=o>::</span><span class=n>unordered_set</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>;</span>
        <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>startVertex</span><span class=p>);</span>
        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>pq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span>
        <span class=p>{</span>
            <span class=n>Vertex</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pq</span><span class=p>.</span><span class=n>top</span><span class=p>();</span>
            <span class=n>visited</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>curr</span><span class=p>.</span><span class=n>x</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>curr</span><span class=p>.</span><span class=n>y</span><span class=p>);</span>
            <span class=n>pq</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>curr</span><span class=p>.</span><span class=n>equals</span><span class=p>(</span><span class=n>holeVertex</span><span class=p>))</span>
            <span class=p>{</span>
                <span class=k>return</span> <span class=n>curr</span><span class=p>.</span><span class=n>path</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>directions</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
            <span class=p>{</span>
                <span class=n>Vertex</span> <span class=n>newStart</span> <span class=o>=</span> <span class=n>roll</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>curr</span><span class=p>,</span> <span class=n>holeVertex</span><span class=p>,</span> <span class=n>directions</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>directions</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>paths</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>visited</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>newStart</span><span class=p>.</span><span class=n>x</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>newStart</span><span class=p>.</span><span class=n>y</span><span class=p>)</span> <span class=o>==</span> <span class=n>visited</span><span class=p>.</span><span class=n>end</span><span class=p>())</span>
                    <span class=n>pq</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>newStart</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=s>&quot;impossible&quot;</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <h3 id=pacific-atlantic-water-flow>Pacific Atlantic Water Flow<a class=headerlink href=#pacific-atlantic-water-flow title="Permanent link">&para;</a></h3> <ul> <li>Using DFS and two matrices to record the states and then to loop through the result check for both possible flow cases.</li> <li>The key is how to start the DFS? should we initiate the DFS in each <code>(i, j)</code>? Here we can see it is more efficient if that we start from the edges. Notice we mark <code>visited[i][j] = true</code> immediately enter the helper function.</li> </ul> <div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>pacificAtlantic</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>p_visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>a_visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>res</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>p_visited</span><span class=p>);</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>a_visited</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>p_visited</span><span class=p>);</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>a_visited</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>p_visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>a_visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
                    <span class=c1>//res.push_back(pair&lt;int, int&gt;(i, j));</span>
                    <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>helper</span> <span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>mat</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>visited</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>mat</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>mat</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span> <span class=cm>/* visite mat[i][j] first */</span>
        <span class=cm>/* and then explore its neighbors */</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>p</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>q</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>mat</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>helper</span><span class=p>(</span><span class=n>mat</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>visited</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class=superfences-tabs> <input name=__tabs_5 type=radio id=__tab_5_0 checked=checked> <label for=__tab_5_0>DFS solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>pacificAtlantic</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>vPacific</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>vAtlantic</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>qPacific</span><span class=p>;</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>qAtlantic</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>qPacific</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=mi>0</span><span class=p>});</span>
            <span class=n>vPacific</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
            <span class=n>qAtlantic</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>});</span>
            <span class=n>vAtlantic</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>qPacific</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=mi>0</span><span class=p>,</span> <span class=n>i</span><span class=p>});</span>
            <span class=n>vPacific</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
            <span class=n>qAtlantic</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>i</span><span class=p>});</span>
            <span class=n>vAtlantic</span><span class=p>[</span><span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>bfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>qPacific</span><span class=p>,</span> <span class=n>vPacific</span><span class=p>);</span>
        <span class=n>bfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>qAtlantic</span><span class=p>,</span> <span class=n>vAtlantic</span><span class=p>);</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>res</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>vPacific</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>vAtlantic</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
                    <span class=n>res</span><span class=p>.</span><span class=n>push_back</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>bfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>,</span> <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>q</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;&amp;</span> <span class=n>visited</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>

                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>||</span> <span class=n>matrix</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Notice your terminate condition <code>matrix[a][b] &gt; matrix[u][v]</code> in the DFS solution indicates your search direction cannot not go from high to low. The search direction is from low to high (or equal). This is to optimize the search since we don't have to revisite a node later.</p> </div> <h3 id=longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix<a class=headerlink href=#longest-increasing-path-in-a-matrix title="Permanent link">&para;</a></h3> <p>BFS solution</p> <ul> <li>Each cell should possibly be the starting cell of the longest increasing path. So we have to search starting from each one of the cells. It seems the running time is quadratic. How to optimize?</li> <li>use markers matrix to mark whether the <code>matrix[i][j]</code> have greater neighbors, <code>left</code>, <code>top</code>, <code>right</code>, <code>bottom</code> -&gt; 1, 2, 4, 8.</li> <li>The do BFS only looking for the directions that have greater neighbors. The idea is very similar to the "branch cutting" in DFS.</li> </ul> <div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>longestIncreasingPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>markers</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>p</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&gt;=</span> <span class=n>m</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span>
                        <span class=n>markers</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>k</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>level</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>markers</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>level</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
                        <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>%</span> <span class=n>n</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                        <span class=kt>bool</span> <span class=n>flag</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>m</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>has_greater_neighbor</span><span class=p>(</span><span class=n>markers</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>],</span> <span class=n>k</span><span class=p>))</span> <span class=p>{</span>
                                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>v</span><span class=p>);</span>
                                <span class=k>if</span> <span class=p>(</span><span class=n>flag</span><span class=p>)</span> <span class=p>{</span>
                                    <span class=n>level</span><span class=o>++</span><span class=p>;</span>
                                    <span class=n>flag</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
                                <span class=p>}</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>level</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>bool</span> <span class=n>has_greater_neighbor</span><span class=p>(</span><span class=kt>int</span> <span class=n>flags</span><span class=p>,</span> <span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=p>(</span><span class=n>flags</span> <span class=o>&gt;&gt;</span> <span class=n>k</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>BFS solution II</p> <ul> <li>BFS can find the shortest path. How can you use BFS to find the longest path? In this problem, we are not use BFS's shortest path properpy, we make use of BFS's property of finding the connected components. We can imagine each increasing path is a connected component, we need to find out the largest one. Notice how the solution construct the search structure (for loop inside the while loop).</li> <li>By construct the search structure in this way, the len is actually the level of nodes from all the peaks identified in the first nested for loops.</li> </ul> <div class=superfences-tabs> <input name=__tabs_6 type=radio id=__tab_6_0 checked=checked> <label for=__tab_6_0>Java solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=kd>class</span> <span class=nc>Solution</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>longestIncreasingPath</span><span class=p>(</span><span class=kt>int</span><span class=o>[][]</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>private</span> <span class=kd>final</span> <span class=kt>int</span><span class=o>[][]</span> <span class=n>dirs</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>},{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>}};</span>
        <span class=kd>private</span> <span class=kt>boolean</span> <span class=nf>ispeak</span><span class=p>(</span><span class=kt>int</span><span class=o>[][]</span> <span class=n>matrix</span><span class=p>,</span> <span class=kt>boolean</span><span class=o>[][]</span> <span class=n>marked</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=p>.</span><span class=na>length</span><span class=o>-</span><span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span><span class=o>-</span><span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>matrix</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=kd>public</span> <span class=kt>int</span> <span class=nf>longestIncreasingPath</span><span class=p>(</span><span class=kt>int</span><span class=o>[][]</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=p>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
            <span class=n>LinkedList</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>[]&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
            <span class=kt>boolean</span><span class=o>[][]</span> <span class=n>marked</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>boolean</span><span class=o>[</span><span class=n>matrix</span><span class=p>.</span><span class=na>length</span><span class=o>][</span><span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span><span class=o>]</span><span class=p>;</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>ispeak</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>marked</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>))</span> <span class=n>queue</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=kt>int</span><span class=o>[]</span><span class=p>{</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>queue</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span> <span class=p>{</span>
                <span class=n>len</span><span class=o>++</span><span class=p>;</span>
                <span class=kt>int</span> <span class=n>size</span> <span class=o>=</span> <span class=n>queue</span><span class=p>.</span><span class=na>size</span><span class=p>();</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>size</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>int</span><span class=o>[]</span> <span class=n>p</span> <span class=o>=</span> <span class=n>queue</span><span class=p>.</span><span class=na>poll</span><span class=p>();</span>
                    <span class=n>marked</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=mi>0</span><span class=o>]][</span><span class=n>p</span><span class=o>[</span><span class=mi>1</span><span class=o>]]</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
                    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>p</span><span class=o>[</span><span class=mi>0</span><span class=o>]+</span><span class=n>dirs</span><span class=o>[</span><span class=n>j</span><span class=o>][</span><span class=mi>0</span><span class=o>]</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=n>p</span><span class=o>[</span><span class=mi>1</span><span class=o>]+</span><span class=n>dirs</span><span class=o>[</span><span class=n>j</span><span class=o>][</span><span class=mi>1</span><span class=o>]</span><span class=p>;</span>
                        <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>r</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=p>.</span><span class=na>length</span> <span class=o>&amp;&amp;</span> <span class=n>c</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>matrix</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>.</span><span class=na>length</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>marked</span><span class=o>[</span><span class=n>r</span><span class=o>][</span><span class=n>c</span><span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=n>ispeak</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>marked</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>))</span> <span class=p>{</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>matrix</span><span class=o>[</span><span class=n>r</span><span class=o>][</span><span class=n>c</span><span class=o>]</span> <span class=o>!=</span> <span class=n>matrix</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=mi>0</span><span class=o>]][</span><span class=n>p</span><span class=o>[</span><span class=mi>1</span><span class=o>]]</span><span class=p>)</span> <span class=n>queue</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=kt>int</span><span class=o>[]</span><span class=p>{</span><span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>});</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>return</span> <span class=n>len</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This BFS is not the same as the classic BFS routine from CLRS. It is a generalized BFS approach, which can be transformed to a problem to find the connected components.</p> </div> <p>DFS solution</p> <ul> <li>we can also use DFS for this problem, it turns out DFS is the simpliest solution.</li> </ul> <div class=superfences-tabs> <input name=__tabs_7 type=radio id=__tab_7_0 checked=checked> <label for=__tab_7_0>DFS solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>longestIncreasingPath</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>cache</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>cache</span><span class=p>);</span>
                <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>len</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>matrix</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=kt>int</span> <span class=n>m</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>cache</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=k>return</span> <span class=n>cache</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>p</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>q</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>matrix</span><span class=p>[</span><span class=n>p</span><span class=p>][</span><span class=n>q</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>matrix</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>cache</span><span class=p>);</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>len</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=n>cache</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>res</span><span class=p>;</span>
        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <h3 id=walls-and-gates>Walls and Gates<a class=headerlink href=#walls-and-gates title="Permanent link">&para;</a></h3> <p>BFS solution</p> <ul> <li>We push all the gate to the queue at once, then BFS to update the room. This makes use of the optimal character of BFS and bring us some optimization.</li> <li>Proof correctness: If init the queue with all gates, BFS alternate between gates, once BFS explore one level of rooms for a particular gate, it switches to explore the same level or next level rooms for another gate. The level is the distance from room to gate. Suppose room R1 is visited at the first time from G1, then if R1 is visited again via G2, the distance from G2 to R1 is possible to be the same as G1 to R1, or greater than G1 to R1 by 1. <strong>The assigned nearest distance from room to gate never be able to reduce further in future.</strong> Then the first assigned distance value for a room will be the nearest one.</li> </ul> <div class=superfences-tabs> <input name=__tabs_8 type=radio id=__tab_8_0 checked=checked> <label for=__tab_8_0>C++</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>wallsAndGates</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>rooms</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>rooms</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>rooms</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>rooms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// start from each gate </span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>;</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>rooms</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>!=</span> <span class=n>INT_MAX</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>continue</span><span class=p>;</span>
                <span class=p>}</span>

                <span class=n>rooms</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>rooms</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <p>DFS solution</p> <ul> <li>I initially start with each <code>INF</code> cell and search for 0. the issue is we have to pass the original <code>i</code>, <code>j</code>, in case we reach the base case to update the <code>INF</code> cell.</li> <li>Another trick is how to handle the repeated searching the same empty room. Extra space like <code>visited[m][n]</code> will work. but a better way to handle it is what we did in the below solution. We check if <code>d &gt; ma[i][j]</code>, if <code>d &gt; 0</code>, the <code>d &gt; mat[i][j]</code> also make sure we update <code>mat[i][j]</code> with a smaller value because the initial value of <code>INF</code> cell is <code>INT_MAX</code>. This is different from DFS because DFS can ensure the shortest path.</li> <li>The time complexity is <span><span class=MathJax_Preview>O(m^2n^2)</span><script type=math/tex>O(m^2n^2)</script></span>. The space complexity is from the stack. It is definitely not constant.</li> </ul> <div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>wallsAndGates</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>rooms</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>rooms</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>rooms</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>rooms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// start from each gate, not room</span>
                    <span class=n>helper</span><span class=p>(</span><span class=n>rooms</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=cm>/* i, j are the starting point. */</span>
    <span class=kt>void</span> <span class=n>helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>mat</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=kt>int</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>mat</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>mat</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=c1>// have already made sure d &lt; mat[i][j]</span>
        <span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
            <span class=n>helper</span><span class=p>(</span><span class=n>mat</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>d</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>multi-end BFS</p> <p>Notice this implementation of BFS is different from triditional BFS. It start with a queue that have more than one element. Some people call this <a href=https://leetcode.com/problems/walls-and-gates/discuss/72748/benchmarks-of-dfs-and-bfs>multi-end BFS</a>. It is perform better than the original BFS, The time complexity is <span><span class=MathJax_Preview>O(mn)</span><script type=math/tex>O(mn)</script></span></p> </div> <h3 id=01-matrix>01 Matrix<a class=headerlink href=#01-matrix title="Permanent link">&para;</a></h3> <h3 id=surrounded-regions>Surrounded Regions<a class=headerlink href=#surrounded-regions title="Permanent link">&para;</a></h3> <ul> <li>We first mark the boundary 'O', then start BFS from each 'O'. If it cannot reach the special marks, we capture the cell.</li> <li>This solution is starting from each of inner 'O' and search the mark at the boundary. The solution is TLE due to more inner 'O's than boundary 'O's.</li> </ul> <div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>solve</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;&gt;&amp;</span> <span class=n>board</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>board</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>board</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span> <span class=o>?</span> <span class=sc>&#39;-&#39;</span> <span class=o>:</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>bool</span> <span class=n>flag</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=n>m</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>n</span> <span class=o>||</span> <span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;X&#39;</span><span class=p>)</span> <span class=p>{</span>
                                <span class=k>continue</span><span class=p>;</span>
                            <span class=p>}</span>

                            <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
                            <span class=p>}</span>

                            <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span><span class=p>)</span> <span class=p>{</span>
                                <span class=n>flag</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
                                <span class=k>break</span><span class=p>;</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>flag</span><span class=p>)</span>
                            <span class=k>break</span><span class=p>;</span>
                    <span class=p>}</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>flag</span><span class=p>)</span>
                        <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span> <span class=o>?</span> <span class=sc>&#39;O&#39;</span> <span class=o>:</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <ul> <li>Instead searching whether a 'O' have an outlet. We can discover all 'O's that lead to edge 'O's and mark them, then all the rest 'O's are captured.</li> <li>Specifically, starting from every 'O' at the edge, using BFS to search all the 'O's outside the 'X's, all these 'O's that cannot be captured. Compare to solution 1, this ideas is thinking “out of the box”, instead of thinking inside 'O's, we take care outside 'O's first.</li> <li>Similar problems: <a href=#walls-and-gates>Walls and Gates</a>, <a href=#shortest-distance-from-all-buildings>Shortest Distance from All Buildings</a>.</li> </ul> <div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>void</span> <span class=n>solve</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;&gt;&amp;</span> <span class=n>board</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>board</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>board</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=c1>// bfs search from boundary &#39;O&#39;s</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>i</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span>
                        <span class=n>bfs_helper</span><span class=p>(</span><span class=n>board</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;X&#39;</span><span class=p>;</span> <span class=c1>// capture all inner &#39;O&#39;s</span>
                <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;-&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;O&#39;</span><span class=p>;</span> <span class=c1>// flip back the marks</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=c1>// helper function to mark &quot;outside&quot; &#39;O&#39; as &#39;-&#39;</span>
    <span class=kt>void</span> <span class=n>bfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;&gt;&amp;</span> <span class=n>board</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>board</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>board</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=n>board</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;-&#39;</span><span class=p>;</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
                    <span class=n>board</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;-&#39;</span><span class=p>;</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div> <p>!!! Notes "Tips 以上两个 solution 足以说明BFS的搜索方向和搜索目标非常重要。巧妙转化搜索目标可以使得code很好写，更简洁。</p> <h3 id=best-meeting-point>Best Meeting Point<a class=headerlink href=#best-meeting-point title="Permanent link">&para;</a></h3> <ul> <li>At the first attempt, I tried to use BFS to do search level by level, which can exhaust all the possible distances from 1 to 0. Unfortunately, it is TLE in the OJ.</li> <li>Following from the idea in problem Minimum Moves to <a href=#equal-array-elements-ii>Equal Array Elements II</a>, we can use math method to calculate the median of the x and y coordinates.</li> <li>The worst case time complexity is <span><span class=MathJax_Preview>O(mn\log mn)</span><script type=math/tex>O(mn\log mn)</script></span>, since there are at most <span><span class=MathJax_Preview>m\times n</span><script type=math/tex>m\times n</script></span> "1" in the grid.</li> </ul> <p>```C++ "Median solution" class Solution { public: int minTotalDistance(vector<vector\&lt;int>>&amp; grid) { int m = grid.size(); int n = m ? grid[0].size() : 0;</p> <div class=codehilite><pre><span></span><code><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=nc>int</span><span class=o>&gt;</span><span class=w> </span><span class=k>rows</span><span class=p>,</span><span class=w> </span><span class=n>cols</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=nc>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>m</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=err>{</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=nc>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=err>{</span><span class=w></span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>grid</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=err>{</span><span class=w></span>
<span class=w>                </span><span class=k>rows</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>i</span><span class=p>);</span><span class=w></span>
<span class=w>                </span><span class=n>cols</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=err>}</span><span class=w></span>
<span class=w>        </span><span class=err>}</span><span class=w></span>
<span class=w>    </span><span class=err>}</span><span class=w></span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>minDistance</span><span class=p>(</span><span class=k>rows</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>minDistance</span><span class=p>(</span><span class=n>cols</span><span class=p>);</span><span class=w></span>
<span class=err>}</span><span class=w></span>

<span class=nc>int</span><span class=w> </span><span class=n>minDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=nc>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>vec</span><span class=p>)</span><span class=w> </span><span class=err>{</span><span class=w></span>
<span class=w>    </span><span class=nc>int</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vec</span><span class=p>.</span><span class=k>size</span><span class=p>();</span><span class=w></span>
<span class=w>    </span><span class=n>sort</span><span class=p>(</span><span class=n>vec</span><span class=p>.</span><span class=k>begin</span><span class=p>(),</span><span class=w> </span><span class=n>vec</span><span class=p>.</span><span class=k>end</span><span class=p>());</span><span class=w></span>
<span class=w>    </span><span class=nc>int</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=nc>int</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>l</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>vec</span><span class=o>[</span><span class=n>r--</span><span class=o>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>vec</span><span class=o>[</span><span class=n>l++</span><span class=o>]</span><span class=p>;</span><span class=w></span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span><span class=w></span>
<span class=err>}</span><span class=w></span>
</code></pre></div> <p>}; <code></code>C++ "Median solution II" class Solution { public: int minTotalDistance(vector<vector\&lt;int>>&amp; grid) { int m = grid.size(); int n = m ? grid[0].size() : 0; vector<int> rows, cols; for (int i = 0; i &lt; m; i++) { for (int j = 0; j &lt; n; j++) { if (grid[i][j] == 1) { rows.push_back(i); cols.push_back(j); } } } sort(cols.begin(), cols.end()); int l = 0, r = rows.size() - 1; int res = 0; while (l &lt; r) res += rows[r] - rows[l] + cols[r--] - cols[l++]; return res; } }; ```</p> <div class=superfences-tabs> <input name=__tabs_9 type=radio id=__tab_9_0 checked=checked> <label for=__tab_9_0>BFS</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>minTotalDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dist</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>bfs_helper</span><span class=p>(</span><span class=n>grid</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>dist</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>res</span> <span class=o>&gt;</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>
                    <span class=n>res</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>bfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=o>&amp;</span><span class=n>dist</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>level</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
        <span class=n>queue</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>});</span>
        <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;</span> <span class=n>len</span><span class=p>;</span> <span class=n>l</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>first</span><span class=p>;</span>
                <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>().</span><span class=n>second</span><span class=p>;</span>
                <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                    <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                    <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>])</span> <span class=p>{</span>
                        <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>+=</span> <span class=n>level</span><span class=p>;</span>
                        <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>({</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>});</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=n>level</span><span class=o>++</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <h3 id=number-of-islands>Number of Islands<a class=headerlink href=#number-of-islands title="Permanent link">&para;</a></h3> <h3 id=battleships-in-a-board>Battleships in a Board<a class=headerlink href=#battleships-in-a-board title="Permanent link">&para;</a></h3> <h3 id=bus-routes>Bus Routes<a class=headerlink href=#bus-routes title="Permanent link">&para;</a></h3> <h3 id=word-ladder>Word Ladder<a class=headerlink href=#word-ladder title="Permanent link">&para;</a></h3> <h3 id=minimum-genetic-mutation>Minimum Genetic Mutation<a class=headerlink href=#minimum-genetic-mutation title="Permanent link">&para;</a></h3> <h3 id=word-ladder-ii>Word Ladder II<a class=headerlink href=#word-ladder-ii title="Permanent link">&para;</a></h3> <h3 id=open-the-lock>Open the Lock<a class=headerlink href=#open-the-lock title="Permanent link">&para;</a></h3> <h3 id=evaluate-devision>Evaluate Devision<a class=headerlink href=#evaluate-devision title="Permanent link">&para;</a></h3> <h2 id=compute-shortest-path-for-undirected-graphs>Compute shortest path for undirected graphs<a class=headerlink href=#compute-shortest-path-for-undirected-graphs title="Permanent link">&para;</a></h2> <h3 id=the-maze-ii_1><a href=#the-maze-ii>The Maze II</a><a class=headerlink href=#the-maze-ii_1 title="Permanent link">&para;</a></h3> <h3 id=shortest-distance-from-all-buildings>Shortest Distance from All Buildings<a class=headerlink href=#shortest-distance-from-all-buildings title="Permanent link">&para;</a></h3> <ul> <li>Similar to <a href=#walls-and-gates>Walls and Gates</a>, We should search from the "dst" (buildings) to "src" (empty land), while the problem is asking search from empty land to buildings.</li> <li>We need a 2D array to record the distance obtained by searching. The result is obtained at last after we finish the searching. Attention: we have also need to check whether the new building can reach all buildings. So use another 2D array and a counter num_buildings to check it can reach all.</li> </ul> <div class=superfences-tabs> <input name=__tabs_10 type=radio id=__tab_10_0 checked=checked> <label for=__tab_10_0>C++</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>shortestDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>num_buildings</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dist1</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>reach</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>num_buildings</span><span class=o>++</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>));</span>

                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
                    <span class=kt>int</span> <span class=n>level</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// grid[a][b] is level 0, grid[u][v] is level 1</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>s</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>s</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// BFS level by level</span>
                            <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
                            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>%</span> <span class=n>n</span><span class=p>;</span>
                            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                                <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                                <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>grid</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>])</span> <span class=p>{</span>
                                    <span class=n>dist1</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>+=</span> <span class=n>level</span><span class=p>;</span>
                                    <span class=n>reach</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span><span class=o>++</span><span class=p>;</span> <span class=c1>// use to count num of 1s that reach this 0.</span>
                                    <span class=n>visited</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>v</span><span class=p>);</span>
                                <span class=p>}</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                        <span class=n>level</span><span class=o>++</span><span class=p>;</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>reach</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=n>num_buildings</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>res</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>dist1</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=o>-</span><span class=mi>1</span> <span class=o>:</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <ul> <li>We can modify the original 2D array to record which cell is visited and which isn't so as to optimize the space complexity. Each time we start BFS from a building <code>grid[i][j]=1</code>, the land will be decreased by <code>1</code>. So after the first BFS, all <code>grid[i][j]=0</code> becomes <code>grid[i][j]=-1</code>. The decreasing of <code>grid[i][j]</code> is equivalent to use the visited variables.</li> <li>similar to Solution 1, we use a 2D array <code>dist[i][j]</code> to record the distances. This distance is <code>dist[i][j]</code> used to record each BFS started from a building (<code>grid[i][j]=1</code>), not the global distances. To accumulate all the distance from 1s, we have to use another 2D array sum to record it.</li> </ul> <div class=superfences-tabs> <input name=__tabs_11 type=radio id=__tab_11_0 checked=checked> <label for=__tab_11_0>Optimized BFS solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>shortestDistance</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>grid</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>grid</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>m</span> <span class=o>?</span> <span class=n>grid</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>counter</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>sum</span> <span class=o>=</span> <span class=n>grid</span><span class=p>;</span>

        <span class=kt>int</span> <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
        <span class=kt>int</span> <span class=n>y</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>dist</span> <span class=o>=</span> <span class=n>grid</span><span class=p>;</span>
                    <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
                    <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
                    <span class=n>res</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>;</span>
                    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                        <span class=kt>int</span> <span class=n>a</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
                        <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>()</span> <span class=o>%</span> <span class=n>n</span><span class=p>;</span>
                        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
                            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>b</span> <span class=o>+</span> <span class=n>y</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
                            <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=o>&amp;&amp;</span> <span class=n>u</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>grid</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>==</span> <span class=n>counter</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>                                <span class=n>grid</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span><span class=o>--</span><span class=p>;</span> <span class=c1>// Mark this potential building position is visited in prev round</span>
</span>                                <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=n>b</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
                                <span class=n>sum</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dist</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
                                <span class=n>res</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>sum</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]);</span>
                                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>v</span><span class=p>);</span>
                            <span class=p>}</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                    <span class=n>counter</span><span class=o>--</span><span class=p>;</span> <span class=c1>// mark as visited</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>res</span> <span class=o>==</span> <span class=n>INT_MAX</span> <span class=o>?</span> <span class=o>-</span><span class=mi>1</span> <span class=o>:</span> <span class=n>res</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <h3 id=shortest-path-visiting-all-nodes>Shortest Path Visiting All Nodes<a class=headerlink href=#shortest-path-visiting-all-nodes title="Permanent link">&para;</a></h3> <h3 id=shortest-path-to-get-all-keys>Shortest Path to Get All Keys<a class=headerlink href=#shortest-path-to-get-all-keys title="Permanent link">&para;</a></h3> <h2 id=compute-connected-components-for-undirected-graphs>Compute connected components for undirected graphs<a class=headerlink href=#compute-connected-components-for-undirected-graphs title="Permanent link">&para;</a></h2> <h3 id=longest-increasing-path-in-a-matrix_1><a href=#longest-increasing-path-in-a-matrix>Longest Increasing Path in a Matrix</a><a class=headerlink href=#longest-increasing-path-in-a-matrix_1 title="Permanent link">&para;</a></h3> <h3 id=number-of-connected-components-in-an-undirected-graph>Number of Connected Components in an Undirected Graph<a class=headerlink href=#number-of-connected-components-in-an-undirected-graph title="Permanent link">&para;</a></h3> <ul> <li>Build the undirected graph using adjacency list from the edge list representation.</li> <li>Call BFS in a for loop and use a <code>visited</code> vector to mark the status of the vertex explorations.</li> <li>Direct transform the above BFS solution to a DFS solution.</li> </ul> <div class=superfences-tabs> <input name=__tabs_12 type=radio id=__tab_12_0 checked=checked> <label for=__tab_12_0>BFS solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countComponents</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>graph</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
                <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
                    <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span> <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
                    <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>a</span> <span class=p>:</span> <span class=n>graph</span><span class=p>[</span><span class=n>t</span><span class=p>])</span> <span class=p>{</span>
                        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span><span class=p>])</span> <span class=p>{</span>
                            <span class=n>visited</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
                            <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                <span class=p>}</span>

                <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> <input name=__tabs_12 type=radio id=__tab_12_1> <label for=__tab_12_1>DFS solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countComponents</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>graph</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>0</span><span class=p>));</span>
        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>visited</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>false</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
            <span class=n>graph</span><span class=p>[</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>].</span><span class=n>push_back</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>dfs_helper</span><span class=p>(</span><span class=n>graph</span><span class=p>,</span> <span class=n>visited</span><span class=p>,</span> <span class=n>i</span><span class=p>);</span>
                <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>void</span> <span class=n>dfs_helper</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>graph</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;&amp;</span> <span class=n>visited</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>visited</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>a</span> <span class=p>:</span> <span class=n>graph</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>a</span><span class=p>])</span> <span class=p>{</span>
                <span class=n>dfs_helper</span><span class=p>(</span><span class=n>graph</span><span class=p>,</span> <span class=n>visited</span><span class=p>,</span> <span class=n>a</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> <input name=__tabs_12 type=radio id=__tab_12_2> <label for=__tab_12_2>Union-Find solution</label> <div class=superfences-content><div class=codehilite><pre><span></span><code><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>parent</span><span class=p>;</span>
<span class=k>public</span><span class=o>:</span>
    <span class=kt>int</span> <span class=n>countComponents</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>parent</span> <span class=o>=</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>);</span>

        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>

        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>int</span> <span class=n>p</span> <span class=o>=</span> <span class=n>root</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>first</span><span class=p>);</span>
            <span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>root</span><span class=p>(</span><span class=n>edge</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>!=</span> <span class=n>q</span><span class=p>)</span> <span class=n>parent</span><span class=p>[</span><span class=n>q</span><span class=p>]</span> <span class=o>=</span> <span class=n>p</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>count</span><span class=o>++</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kt>int</span> <span class=n>root</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>i</span> <span class=o>!=</span> <span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=n>i</span> <span class=o>=</span> <span class=n>parent</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=k>return</span> <span class=n>i</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div></div> </div> <h2 id=bfs-topological-sorting>BFS Topological sorting<a class=headerlink href=#bfs-topological-sorting title="Permanent link">&para;</a></h2> <p>Apply BFS in DAG topological sorting requires to start with the vertices that have <code>0</code> indegree, namely the source vertices. We need a <strong>queue</strong> and a <code>indegree</code> vector for solving topological sorting problems. The BFS queue may start with more than one source vertices because topological sorted graph may start with two or more vertices (indegree == 0). When BFS visit an adjacent vertex of the queue-front vertex, the indegree of this visited vertex should be decreased by 1, as we "visited" this arc. If the indegree of the visited vertex is reduced to 0, we push it to the queue. The idea of using BFS in topological sorting is to explore frontier of the vertices that currently have <code>0</code> non-visited arcs leading to the vertices (indegree is 0).</p> <ul> <li>What if the given graph have a single vertex?</li> <li>How to check whether the topological sorting is unique or not?</li> <li>How to output all the unique topological sorted sequence of vertices?</li> </ul> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../../binary-search/notes/ title="Binary Search" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Binary Search </span> </div> </a> <a href=../../depth-first-search/notes/ title="Depth-First Search (DFS)" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Depth-First Search (DFS) </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Rui Han </div> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.c33a9706.js></script> <script>app.initialize({version:"1.1",url:{base:"../../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>